import{f as K,a as N,t as U,c as pe}from"../chunks/Dh1Z6ki8.js";import{p as ve,U as I,V as E,g as ge,k as e,W as he,a as _e,Z as o,f as Z,s as B,Y as D,t as R,c as w,r as M,_ as Ne}from"../chunks/DRD-yT8e.js";import{d as Me,s as V}from"../chunks/Chq1SuiK.js";import{e as ye,i as xe}from"../chunks/BYSw4R3u.js";import{i as z}from"../chunks/J_yv6X8T.js";import{i as Ce,r as be,s as Ie}from"../chunks/AgGyIM3c.js";import{b as we}from"../chunks/BoupOGuT.js";import{a as T,A as S,N as G,I as k,M as q}from"../chunks/CXrKfc7O.js";import{B as Te,c as F}from"../chunks/D_VG9ZNK.js";var Ee=K("<option> </option>"),Re=K('<div class="controls-area svelte-os8fbx"><div class="control-group svelte-os8fbx"><label for="intervalType">Interval Type</label> <select id="intervalType"></select></div> <div class="control-group svelte-os8fbx"><label><input type="checkbox"/> Right hand mode</label></div></div>'),Se=K("<!> <!>",1);function Ge(J,p){ve(p,!0);const Q="Play the interval shown on the staff using your MIDI keyboard. Listen and check your answer.";let y=p.randomMode,L=p.onComplete,X=p.intervalType,ee=p.rightHandMode,te=p.rootKey,i=I(E(X??(y?T[Math.floor(Math.random()*T.length)]:"major3rd"))),v=I(E(ee??(y?Math.random()>.5:!0))),r=I(E(te??(y?S[Math.floor(Math.random()*S.length)]:"C"))),d=I(E(new Set)),g=I(!1);function oe(){o(d,new Set,!0),o(g,!1)}ge(()=>{e(g)&&L&&L()});function re(){const n=S[Math.floor(Math.random()*S.length)],t=T[Math.floor(Math.random()*T.length)];o(r,n,!0),o(i,t,!0),o(d,new Set,!0),o(g,!1)}function O(n,t){const a=["G","A","B"].includes(n);return t?a?"2":"3":a?"1":"2"}function ae(n){try{const t=O(e(r),e(v)),a=F(e(r),e(i),t),s=G[e(r)+t],l=a;return console.debug(`Interval ${k[e(i)]} from ${e(r)}${t} to ${l}:`,`Root MIDI: ${s}, Expected MIDI: ${l}`),[s,l]}catch(t){console.error("Error generating expected note:",t);const a=G.C4,s=G.E4;return[a,s]}}function ne(n){try{const t=O(e(r),e(v)),a=F(e(r),e(i),t),s=e(r)+t,l=q[a];let h=[],u=[];return e(v)?u=[[s,l]]:h=[[s,l]],{selectedNote:e(r),leftHand:h,rightHand:u}}catch(t){return console.error("Error generating score props:",t),{selectedNote:e(r),leftHand:[],rightHand:[["C4","E4"]]}}}function se(n,t,a,s){const[l,h]=a,u=k[e(i)];return a.includes(t.noteNumber)?(o(d,new Set([...e(d),t.noteNumber]),!0),e(d).size===2?(setTimeout(()=>{re()},1500),{isCorrect:!0,message:`Perfect ${u}! ðŸŽµâœ¨`,collected:!0,resetCollected:!0,resetMistakes:!0}):{isCorrect:!0,message:`Good! ${t.noteNumber===l?"root":u} played (${e(d).size}/2)`,collected:!0,resetCollected:!1}):(o(d,new Set,!0),{isCorrect:!1,message:`Wrong! You played ${q[t.noteNumber]?.slice(0,-1)}. Play ${u} from ${e(r)}`,collected:!1,resetCollected:!0})}function le(n,t){return!1}function ie(n){const t=n.target;o(i,t.value,!0),o(d,new Set,!0)}function ce(n){const t=n.target;o(v,t.checked,!0),o(d,new Set,!0)}let de=D(()=>`${k[e(i)]} from ${e(r)}`);Te(J,{get randomMode(){return y},generateExpectedNotes:ae,generateScoreProps:ne,validateNoteEvent:se,isCompleted:le,onReset:oe,onComplete:()=>{},get initialNote(){return e(r)},description:Q,get prompt(){return e(de)},showTempoControl:!1,showTrainingControl:!1,children:(t,a=he)=>{const s=D(()=>e(g)),l=D(()=>a().completed);var h=Se(),u=Z(h);{var H=c=>{var f=U();R(()=>V(f,o(g,!0))),N(c,f)},W=c=>{var f=pe(),x=Z(f);{var m=_=>{var C=U();R(()=>V(C,o(g,!1))),N(_,C)};z(x,_=>{!e(l)&&e(s)&&_(m)},!0)}N(c,f)};z(u,c=>{e(l)&&!e(s)?c(H):c(W,!1)})}var ue=B(u,2);{var fe=c=>{var f=Re(),x=w(f),m=B(w(x),2);m.__change=ie,ye(m,21,()=>T,xe,(P,$)=>{var b=Ee(),me=w(b,!0);M(b);var j={};R(()=>{V(me,k[e($)]),j!==(j=e($))&&(b.value=(b.__value=e($))??"")}),N(P,b)}),M(m);var _;Ce(m),M(x);var C=B(x,2),Y=w(C),A=w(Y);be(A),A.__change=ce,Ne(),M(Y),M(C),M(f),R(()=>{_!==(_=e(i))&&(m.value=(m.__value=e(i))??"",Ie(m,e(i)))}),we(A,()=>e(v),P=>o(v,P)),N(c,f)};z(ue,c=>{y||c(fe)})}N(t,h)},$$slots:{default:!0}}),_e()}Me(["change"]);export{Ge as component};
