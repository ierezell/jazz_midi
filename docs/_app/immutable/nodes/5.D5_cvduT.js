import"../chunks/CWj6FrbW.js";import{d as Te,o as qe,s as y}from"../chunks/C9uxT11M.js";import{h as Fe,C as Oe,D as Ve,p as Be,o as K,q as Ge,f as b,s as l,d as o,t as M,k as e,b as u,c as We,v as c,r,w as _,x as ue,a as ae,y as Je}from"../chunks/D5zBHTIm.js";import{i as N}from"../chunks/yfkNQNHN.js";import{e as be,R as Le,i as pe,A as Qe,g as Ue,N as se,m as Xe}from"../chunks/CXyIVaVK.js";import{r as Ye}from"../chunks/CW3IzdN-.js";import{l as Ze,b as et,e as tt,o as at,D as st,S as lt,I as _e,c as rt,s as ot,a as nt}from"../chunks/Ckcloi-B.js";function ct(k,P,h=P){Ze(k,"change",$=>{var j=$?k.defaultChecked:k.checked;h(j)}),(Ve&&k.defaultChecked!==k.checked||Fe(P)==null)&&h(k.checked),Oe(()=>{var $=P();k.checked=!!$})}var it=b("Play all 7 notes of the major scale <strong>in order</strong> ",1),dt=b("Play all 7 notes of the major scale <strong>in any order</strong> ",1),vt=b('<button class="debug-toggle svelte-1e5b3uz">ðŸŽ¹ Enable Computer Keyboard</button> <p class="keyboard-hint svelte-1e5b3uz">Connect a MIDI keyboard or enable computer keyboard to play</p>',1),ut=b('<div class="keyboard-instructions svelte-1e5b3uz"><p class="svelte-1e5b3uz"><strong>ðŸŽ¹ Computer Keyboard Controls Active!</strong></p> <p class="svelte-1e5b3uz">Use your computer keyboard to play: <kbd class="svelte-1e5b3uz">Z</kbd><kbd class="svelte-1e5b3uz">X</kbd><kbd class="svelte-1e5b3uz">C</kbd><kbd class="svelte-1e5b3uz">V</kbd><kbd class="svelte-1e5b3uz">B</kbd><kbd class="svelte-1e5b3uz">N</kbd><kbd class="svelte-1e5b3uz">M</kbd> for white keys</p> <p class="svelte-1e5b3uz"><kbd class="svelte-1e5b3uz">S</kbd><kbd class="svelte-1e5b3uz">D</kbd><kbd class="svelte-1e5b3uz">G</kbd><kbd class="svelte-1e5b3uz">H</kbd><kbd class="svelte-1e5b3uz">J</kbd> for black keys â€¢ <kbd class="svelte-1e5b3uz">Q</kbd><kbd class="svelte-1e5b3uz">W</kbd><kbd class="svelte-1e5b3uz">E</kbd><kbd class="svelte-1e5b3uz">R</kbd><kbd class="svelte-1e5b3uz">T</kbd> for higher octave</p></div>'),bt=b("<option> </option>"),pt=b('<span class="note-name svelte-1e5b3uz"> </span>'),_t=b('<div class="hint-container note-names-hint svelte-1e5b3uz"><h3 class="svelte-1e5b3uz">ðŸ’¡ Hint: Note Names</h3> <div class="note-names svelte-1e5b3uz"></div></div>'),ft=b('<div class="hint-container keyboard-hint svelte-1e5b3uz"><h3 class="svelte-1e5b3uz">ðŸ’¡ Hint: Keyboard Reference</h3> <!></div>'),gt=b('<p class="error-count svelte-1e5b3uz"> </p>'),mt=b('<div><p class="feedback-message svelte-1e5b3uz"> </p> <!></div>'),kt=b('<div class="exercise-container svelte-1e5b3uz"><div class="scale-display svelte-1e5b3uz"><h2 class="scale-name svelte-1e5b3uz"> </h2></div> <div class="score-container svelte-1e5b3uz"><h3 class="svelte-1e5b3uz">Musical Score</h3> <!></div> <!> <!> <div class="input-container svelte-1e5b3uz"><h3 class="svelte-1e5b3uz">Your Input</h3> <!></div> <!></div>'),ht=b('<div class="placeholder-container svelte-1e5b3uz"><p class="svelte-1e5b3uz">Please select a root note to begin practicing scales.</p></div>'),zt=b('<main class="svelte-1e5b3uz"><!> <div class="page-header svelte-1e5b3uz"><h1 class="svelte-1e5b3uz">Scale Practice</h1> <h2 class="svelte-1e5b3uz">Major Scales</h2> <p class="subtitle svelte-1e5b3uz"><!></p> <!></div> <div class="controls-container svelte-1e5b3uz"><div class="control-group svelte-1e5b3uz"><label for="note-select" class="svelte-1e5b3uz">Root Note:</label> <select id="note-select" class="svelte-1e5b3uz"><option>--Choose a Note--</option><!></select></div> <div class="control-group svelte-1e5b3uz"><label for="mode-toggle" class="svelte-1e5b3uz">Playing Mode:</label> <div class="toggle-container svelte-1e5b3uz"><input id="mode-toggle" type="checkbox" class="svelte-1e5b3uz"/> <label for="mode-toggle" class="toggle-label svelte-1e5b3uz"> </label></div></div> <button class="reset-btn svelte-1e5b3uz">Reset Exercise</button></div> <!></main>');function Ct(k,P){Be(P,!0);let h=K(Ge([])),$=_(()=>e(h).map(t=>t.noteNumber)),j,x=K("C"),f=K(!1),w=K(!0),z,H=null,le=_(()=>e(x)+"4"),fe=_(()=>Xe[e(x)]),F=_(()=>Array.from(new Set(e(fe).map(t=>t.slice(0,-1))))),C=_(()=>e(F).map(t=>t+"4")),O=_(()=>e(C).map(t=>se[t])),n=[],p=K(""),g=K(0),ge=_(()=>e(g)>=3),me=_(()=>e(g)>=6),S=null,I=null;function re(){if(c(f,!e(f)),e(f)&&!z){const t=rt("Virtual Debug Keyboard");z=t.getVirtualInput(),H=ot(z);const a=Array.from(t.inputs.values())[0];a&&(a.onmidimessage=oe)}else!e(f)&&H&&(H(),H=null,z&&z.releaseAllKeys())}function oe(t){const a=Ue(t);if(a)if(a.type==="on")if(c(h,[a,...e(h)],!0),e(w)){const s=n.length,D=e(O)[s];if(a.noteNumber===D)n.push(a.noteNumber),n.length===7?(c(p,"Excellent! Perfect scale in order! ðŸŽµâœ¨"),c(g,0),I&&I.play(),n=[]):c(p,`Great! Note ${n.length}/7 correct. Next: ${e(F)[s+1]}`);else{ue(g);const E=e(F)[s];c(p,`Wrong note! Expected: ${E} (note ${s+1}/7). Attempt ${e(g)}`),S&&S.play(),n=[]}}else n.push(a.noteNumber),n=[...new Set(n)],n.every(s=>e(O).includes(s))?n.length===7?(c(p,"Excellent! Perfect scale! ðŸŽµ"),c(g,0),I&&I.play(),n=[]):c(p,`Good! ${7-n.length} more note${7-n.length>1?"s":""} to complete the scale`):(ue(g),c(p,`Incorrect note. Try again! (Attempt ${e(g)})`),S&&S.play(),n=[]);else c(h,e(h).filter(s=>s.noteFullName!==a.noteFullName),!0)}function V(){c(g,0),n=[],c(p,""),c(h,[],!0)}qe(async()=>{S=new Audio(tt),S.volume=.5,S.loop=!1,I=new Audio(at),I.volume=.5,I.loop=!1;try{j=await Le(),console.log("Scale MIDI Access obtained:",j),j.inputs.forEach(a=>{a.onmidimessage=oe})}catch(t){console.error("Failed to obtain MIDI Access:",t)}});var B=zt(),ne=o(B);{var ke=t=>{st(t,{get virtualMidi(){return z},get debugMode(){return e(f)},onToggleDebugMode:re})};N(ne,t=>{e(f)&&t(ke)})}var G=l(ne,2),W=l(o(G),4),he=o(W);{var ze=t=>{var a=it(),s=l(ae(a),2);M(()=>y(s,` (Do-Re-Mi-Fa-Sol-La-Ti) on
				your MIDI keyboard${e(f)?" or use computer keyboard controls":""}`)),u(t,a)},ye=t=>{var a=dt(),s=l(ae(a),2);M(()=>y(s,` on your MIDI keyboard${e(f)?" or use computer keyboard controls":""}`)),u(t,a)};N(he,t=>{e(w)?t(ze):t(ye,!1)})}r(W);var Me=l(W,2);{var Ne=t=>{var a=vt(),s=ae(a);s.__click=re,Je(2),u(t,a)},xe=t=>{var a=ut();u(t,a)};N(Me,t=>{e(f)?t(xe,!1):t(Ne)})}r(G);var J=l(G,2),L=o(J),T=l(o(L),2);T.__change=V;var Q=o(T);Q.value=Q.__value="";var Se=l(Q);be(Se,17,()=>Qe,pe,(t,a)=>{var s=bt(),D=o(s,!0);r(s);var E={};M(()=>{y(D,e(a)),E!==(E=e(a))&&(s.value=(s.__value=e(a))??"")}),u(t,s)}),r(T),r(L);var U=l(L,2),ce=l(o(U),2),q=o(ce);Ye(q),q.__change=V;var ie=l(q,2),Ie=o(ie,!0);r(ie),r(ce),r(U);var Ae=l(U,2);Ae.__click=V,r(J);var Ce=l(J,2);{var De=t=>{var a=kt(),s=o(a),D=o(s),E=o(D);r(D),r(s);var X=l(s,2),Ke=l(o(X),2);{let i=_(()=>[...e(C).map(d=>d.replace("4","3")),e(C)[0]].reduce((d,m)=>(d.push([m]),d),[])),v=_(()=>[...e(C),e(C)[0].replace("4","5")].reduce((d,m)=>(d.push([m]),d),[]));lt(Ke,{get selectedNote(){return e(x)},get leftHand(){return e(i)},get rightHand(){return e(v)}})}r(X);var de=l(X,2);{var Pe=i=>{var v=_t(),d=l(o(v),2);be(d,21,()=>e(C),pe,(m,Z)=>{var R=pt(),ee=o(R,!0);r(R),M(A=>y(ee,A),[()=>e(Z).slice(0,-1)]),u(m,R)}),r(d),r(v),u(i,v)};N(de,i=>{e(ge)&&i(Pe)})}var ve=l(de,2);{var $e=i=>{var v=ft(),d=l(o(v),2);{let m=_(()=>se[e(le)]+7);_e(d,{get midiNotes(){return e(O)},get middleC(){return e(m)},octaves:2,get virtualMidi(){return z},get debugMode(){return e(f)}})}r(v),u(i,v)};N(ve,i=>{e(me)&&i($e)})}var Y=l(ve,2),je=l(o(Y),2);{let i=_(()=>se[e(le)]+7);_e(je,{get midiNotes(){return e($)},get middleC(){return e(i)},octaves:2,get virtualMidi(){return z},get debugMode(){return e(f)}})}r(Y);var we=l(Y,2);{var Re=i=>{var v=mt();let d;var m=o(v),Z=o(m,!0);r(m);var R=l(m,2);{var ee=A=>{var te=gt(),He=o(te);r(te),M(()=>y(He,`Mistakes: ${e(g)??""}/6 (hints unlock at 3 and 6 mistakes)`)),u(A,te)};N(R,A=>{e(g)>0&&!e(p).includes("Excellent")&&A(ee)})}r(v),M(A=>{d=nt(v,1,"feedback-container svelte-1e5b3uz",null,d,A),y(Z,e(p))},[()=>({success:e(p).includes("Excellent"),error:e(p).includes("Incorrect")})]),u(i,v)};N(we,i=>{e(p)&&i(Re)})}r(a),M(()=>y(E,`${e(x)??""} Major Scale`)),u(t,a)},Ee=t=>{var a=ht();u(t,a)};N(Ce,t=>{e(x)?t(De):t(Ee,!1)})}r(B),M(()=>y(Ie,e(w)?"Sequential Order":"Any Order")),et(T,()=>e(x),t=>c(x,t)),ct(q,()=>e(w),t=>c(w,t)),u(k,B),We()}Te(["click","change"]);export{Ct as component};
