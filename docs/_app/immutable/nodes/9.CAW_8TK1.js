import"../chunks/NZTpNUN0.js";import{p as Re,ao as y,Q as le,g as xe,k as e,f as P,b as C,c as Me,d as m,ap as be,aq as A,a as W,s as n,t as V,R as w,aw as we,r as f,ar as ne,as as Ee}from"../chunks/u8fP_b2Q.js";import{d as Fe,s as D}from"../chunks/isL9873N.js";import{i as k}from"../chunks/Cj8lQ-n9.js";import{f as ie,e as Ie,M as B,N as M,D as b,i as Ne}from"../chunks/DmnNUe2y.js";import{i as ce,s as ve,c as Te}from"../chunks/CXakw2E1.js";import{p as Ve}from"../chunks/DPJez4lO.js";import{B as Pe,b as Le,a as J}from"../chunks/CZxLfcpG.js";function je(E,i,g){const s=E.target;w(i,parseInt(s.value),!0),g()}function ye(E,i,g){const s=E.target;w(i,s.value,!0),g()}var Ae=P('<div class="control-group svelte-1qz769a"><label for="inversion" class="svelte-1qz769a">Inversion:</label> <select id="inversion" class="svelte-1qz769a"><option class="svelte-1qz769a">Root</option><option class="svelte-1qz769a">1st</option><option class="svelte-1qz769a">2nd</option><option class="svelte-1qz769a">3rd</option></select></div> <div class="control-group svelte-1qz769a"><label for="voicing" class="svelte-1qz769a">Voicing:</label> <select id="voicing" class="svelte-1qz769a"><option class="svelte-1qz769a">Full Right Hand</option><option class="svelte-1qz769a">Full Left Hand</option><option class="svelte-1qz769a">1 & 7 Left / 3 & 5 Right</option><option class="svelte-1qz769a">1 & 5 Left / 3 & 7 Right</option></select></div>',1),De=P("<div> </div>"),ke=P('<div class="completion svelte-1qz769a">ðŸŽ‰ ii-V-I Completed!</div>'),Be=P('<!> <div class="progression-controls svelte-1qz769a"><!> <div class="chord-progress svelte-1qz769a"></div></div> <div class="exercise-status svelte-1qz769a"><div class="current-chord svelte-1qz769a"> </div> <!></div>',1),Ge=P('<div class="progression-exercise svelte-1qz769a"><!></div>');function Xe(E,i){Re(i,!0);let g=Ve(i,"randomMode",3,!1),s=y(0),q=y(le(i.inversion??(g()?Math.floor(Math.random()*4):0))),F=y(le(i.voicing??(g()?ie[Math.floor(Math.random()*ie.length)]:"full-right"))),I=y(!1);function de(){L(),w(I,!1)}xe(()=>{e(I)&&i.onComplete&&i.onComplete()});function L(){w(s,0)}function X(t){const o=M[t+b]+2,l=M[t+b]+7,_=M[t+b],c=J(o,"min7",e(q)),z=J(l,"7",e(q)),x=J(_,"maj7",e(q));return[c,z,x][e(s)]}function ue(t){const o=X(t);return[o.root,o.third,o.fifth,o.seventh].filter(l=>l!=null)}function fe(t,o,l,_){const c=j(t)[e(s)];if(l.includes(o.noteNumber)){const d=_.filter(H=>l.includes(H)).length,N=l.length;return d===N?e(s)<2?(setTimeout(()=>{we(s)},1e3),{isCorrect:!0,message:Y(),collected:!0,resetCollected:!1}):{isCorrect:!0,message:Y(),collected:!0,resetCollected:!1}:{isCorrect:!0,message:`Good! ${d}/${N} notes for ${c}`,collected:!0,resetCollected:!1}}const x=l.filter(d=>!_.includes(d)).map(d=>B[d].slice(0,-1)).join(", ");return{isCorrect:!1,message:`Wrong note. For ${c} expected: ${x}`,collected:!1,resetCollected:!0}}function _e(t,o){if(o.length===0)return!1;const c=t.filter(z=>o.includes(z)).length===o.length&&e(s)===2;return c&&setTimeout(()=>{L()},2e3),c}function j(t="C"){const o=M[t+b]+2,l=M[t+b]+7,_=M[t+b];return[`${B[o].slice(0,-1)}m7`,`${B[l].slice(0,-1)}7`,`${B[_].slice(0,-1)}maj7`]}function Y(){return e(s)<2?`Great! Now play ${j()[e(s)+1]}`:"Perfect! Complete ii-V-I progression! ðŸŽµâœ¨"}function me(t){const o=X(t);return{...Le(o,e(F)),selectedNote:t}}var G=Ge(),ge=m(G);{const t=(_,c=be)=>{var z=Be();const x=A(()=>e(I)),d=A(()=>c().completed);var N=W(z);{var H=r=>{var v=ne();V(()=>D(v,w(I,!0))),C(r,v)},pe=r=>{var v=Ee(),p=W(v);{var a=u=>{var h=ne();V(()=>D(h,w(I,!1))),C(u,h)};k(p,u=>{!e(d)&&e(x)&&u(a)},!0)}C(r,v)};k(N,r=>{e(d)&&!e(x)?r(H):r(pe,!1)})}var K=n(N,2),Z=m(K);{var he=r=>{var v=Ae(),p=W(v),a=n(m(p),2);a.__change=[je,q,L];var u=m(a);u.value=u.__value=0;var h=n(u);h.value=h.__value=1;var T=n(h);T.value=T.__value=2;var te=n(T);te.value=te.__value=3,f(a);var oe;ce(a),f(p);var re=n(p,2),R=n(m(re),2);R.__change=[ye,F,L];var Q=m(R);Q.value=Q.__value="full-right";var S=n(Q);S.value=S.__value="full-left";var U=n(S);U.value=U.__value="1735";var se=n(U);se.value=se.__value="1537",f(R);var ae;ce(R),f(re),V(()=>{oe!==(oe=e(q))&&(a.value=(a.__value=e(q))??"",ve(a,e(q))),ae!==(ae=e(F))&&(R.value=(R.__value=e(F))??"",ve(R,e(F)))}),C(r,v)};k(Z,r=>{g()||r(he)})}var $=n(Z,2);Ie($,21,()=>j(c().selectedNote),Ne,(r,v,p)=>{var a=De();let u;var h=m(a,!0);f(a),V(T=>{u=Te(a,1,"chord-indicator svelte-1qz769a",null,u,T),D(h,e(v))},[()=>({active:p===e(s),completed:p<e(s)})]),C(r,a)}),f($),f(K);var ee=n(K,2),O=m(ee),Ce=m(O);f(O);var qe=n(O,2);{var ze=r=>{var v=ke();C(r,v)};k(qe,r=>{c().completed&&r(ze)})}f(ee),V(r=>D(Ce,`Current: ${r??""} (${e(s)+1}/3)`),[()=>j(c().selectedNote)[e(s)]]),C(_,z)};let o=A(()=>i.onComplete||(()=>{})),l=A(()=>i.rootKey||"C");Pe(ge,{get randomMode(){return g()},generateExpectedNotes:ue,generateScoreProps:me,validateNoteEvent:fe,isCompleted:_e,onReset:de,get onComplete(){return e(o)},get initialNote(){return e(l)},children:t,$$slots:{default:!0}})}f(G),C(E,G),Me()}Fe(["change"]);export{Xe as component};
