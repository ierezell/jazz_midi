import{f as P,a as h,t as ae,c as Re}from"../chunks/CX1yysGK.js";import{p as Ie,J as F,K as ne,d as be,j as e,L as we,a as Ne,M as x,P as Pe,c as m,f as W,s as n,t as N,N as y,r as d}from"../chunks/Dpgs3mFS.js";import{d as Te,s as L}from"../chunks/dcQTQ1xv.js";import{e as Ve,s as Ee,i as Fe}from"../chunks/D0omyc6-.js";import{i as A}from"../chunks/FFlPY-wq.js";import{i as le,s as ie}from"../chunks/gBQeIBP2.js";import{p as ye}from"../chunks/E4K1_ROJ.js";import{B as Le,d as Ae,a as z}from"../chunks/CedzibQm.js";import{e as ce,M as D,N as M,D as R}from"../chunks/DgZpB3qr.js";var De=P('<div class="control-group svelte-1jk8q9u"><label for="inversion" class="svelte-1jk8q9u">Inversion:</label> <select id="inversion" class="svelte-1jk8q9u"><option class="svelte-1jk8q9u">Root</option><option class="svelte-1jk8q9u">1st</option><option class="svelte-1jk8q9u">2nd</option><option class="svelte-1jk8q9u">3rd</option></select></div> <div class="control-group svelte-1jk8q9u"><label for="voicing" class="svelte-1jk8q9u">Voicing:</label> <select id="voicing" class="svelte-1jk8q9u"><option class="svelte-1jk8q9u">Full Right Hand</option><option class="svelte-1jk8q9u">Full Left Hand</option><option class="svelte-1jk8q9u">1 & 7 Left / 3 & 5 Right</option><option class="svelte-1jk8q9u">1 & 5 Left / 3 & 7 Right</option></select></div>',1),Be=P("<div> </div>"),Ge=P('<div class="completion svelte-1jk8q9u">ðŸŽ‰ ii-V-I Completed!</div>'),He=P('<!> <div class="progression-controls svelte-1jk8q9u"><!> <div class="chord-progress svelte-1jk8q9u"></div></div> <div class="exercise-status svelte-1jk8q9u"><div class="current-chord svelte-1jk8q9u"> </div> <!></div>',1),Ke=P('<div class="progression-exercise svelte-1jk8q9u"><!></div>');function Ze(ve,_){Ie(_,!0);const ue="Play the II-V-I progression as shown. Use the correct chords and voicings for each step.";let T=ye(_,"randomMode",3,!1),l=F(0),C=F(ne(_.inversion??(T()?Math.floor(Math.random()*4):0))),I=F(ne(_.voicing??(T()?ce[Math.floor(Math.random()*ce.length)]:"full-right"))),b=F(!1);function de(){V(),x(b,!1)}be(()=>{e(b)&&_.onComplete&&_.onComplete()});function V(){x(l,0)}function Q(t){const o=M[t+R]+2,a=M[t+R]+7,f=M[t+R],i=z(o,"min7",e(C)),j=z(a,"7",e(C)),q=z(f,"maj7",e(C));return[i,j,q][e(l)]}function fe(t){const o=Q(t);return[o.root,o.third,o.fifth,o.seventh].filter(a=>a!=null)}function me(t,o,a,f){const i=E(t)[e(l)];if(a.includes(o.noteNumber)){const v=f.filter(G=>a.includes(G)).length,w=a.length;return v===w?e(l)<2?(setTimeout(()=>{Pe(l)},1e3),{isCorrect:!0,message:X(),collected:!0,resetCollected:!1}):{isCorrect:!0,message:X(),collected:!0,resetCollected:!1}:{isCorrect:!0,message:`Good! ${v}/${w} notes for ${i}`,collected:!0,resetCollected:!1}}const q=a.filter(v=>!f.includes(v)).map(v=>D[v].slice(0,-1)).join(", ");return{isCorrect:!1,message:`Wrong note. For ${i} expected: ${q}`,collected:!1,resetCollected:!0}}function _e(t,o){if(o.length===0)return!1;const i=t.filter(j=>o.includes(j)).length===o.length&&e(l)===2;return i&&setTimeout(()=>{V()},2e3),i}function E(t="C"){const o=M[t+R]+2,a=M[t+R]+7,f=M[t+R];return[`${D[o].slice(0,-1)}m7`,`${D[a].slice(0,-1)}7`,`${D[f].slice(0,-1)}maj7`]}function X(){return e(l)<2?`Great! Now play ${E()[e(l)+1]}`:"Perfect! Complete ii-V-I progression! ðŸŽµâœ¨"}function pe(t){const o=t.target;x(C,parseInt(o.value),!0),V()}function ge(t){const o=t.target;x(I,o.value,!0),V()}function he(t){const o=Q(t);return{...Ae(o,e(I)),selectedNote:t}}var B=Ke(),Ce=m(B);{const t=(f,i=we)=>{const j=y(()=>e(b)),q=y(()=>i().completed);var v=He(),w=W(v);{var G=r=>{var c=ae();N(()=>L(c,x(b,!0))),h(r,c)},je=r=>{var c=Re(),p=W(c);{var s=u=>{var g=ae();N(()=>L(g,x(b,!1))),h(u,g)};A(p,u=>{!e(q)&&e(j)&&u(s)},!0)}h(r,c)};A(w,r=>{e(q)&&!e(j)?r(G):r(je,!1)})}var H=n(w,2),Y=m(H);{var ke=r=>{var c=De(),p=W(c),s=n(m(p),2);s.__change=pe;var u=m(s);u.value=u.__value=0;var g=n(u);g.value=g.__value=1;var U=n(g);U.value=U.__value=2;var ee=n(U);ee.value=ee.__value=3,d(s);var te;le(s),d(p);var oe=n(p,2),k=n(m(oe),2);k.__change=ge;var J=m(k);J.value=J.__value="full-right";var O=n(J);O.value=O.__value="full-left";var S=n(O);S.value=S.__value="1735";var re=n(S);re.value=re.__value="1537",d(k);var se;le(k),d(oe),N(()=>{te!==(te=e(C))&&(s.value=(s.__value=e(C))??"",ie(s,e(C))),se!==(se=e(I))&&(k.value=(k.__value=e(I))??"",ie(k,e(I)))}),h(r,c)};A(Y,r=>{T()||r(ke)})}var Z=n(Y,2);Ve(Z,21,()=>E(i().selectedNote),Fe,(r,c,p)=>{var s=Be();let u;var g=m(s,!0);d(s),N(()=>{u=Ee(s,1,"chord-indicator svelte-1jk8q9u",null,u,{active:p===e(l),completed:p<e(l)}),L(g,e(c))}),h(r,s)}),d(Z),d(H);var $=n(H,2),K=m($),qe=m(K);d(K);var xe=n(K,2);{var Me=r=>{var c=Ge();h(r,c)};A(xe,r=>{i().completed&&r(Me)})}d($),N(r=>L(qe,`Current: ${r??""} (${e(l)+1}/3)`),[()=>E(i().selectedNote)[e(l)]]),h(f,v)};let o=y(()=>_.onComplete||(()=>{})),a=y(()=>_.rootKey||"C");Le(Ce,{get randomMode(){return T()},generateExpectedNotes:fe,generateScoreProps:he,validateNoteEvent:me,isCompleted:_e,onReset:de,get onComplete(){return e(o)},get initialNote(){return e(a)},description:ue,exerciseType:"progression",children:t,$$slots:{default:!0}})}d(B),h(ve,B),Ne()}Te(["change"]);export{Ze as component};
