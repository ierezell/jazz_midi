import{f as x,a as p,c as at}from"../chunks/CFIxE8eA.js";import{a as st}from"../chunks/DkZ4bG6r.js";import{p as nt,U as y,V as it,f as Se,W as rt,k as e,X as U,a as dt,Z as o,s as n,c as s,t as k,Y as Be,r as t,_ as ot}from"../chunks/jpeKWS-T.js";import{d as lt,s as S}from"../chunks/CMZx5vTi.js";import{e as V,i as X}from"../chunks/C5dV_Rsv.js";import{i as z}from"../chunks/etsv1dl2.js";import{b as ct,r as ut,c as P,d as oe}from"../chunks/DEwekSJk.js";import{t as vt,f as ht}from"../chunks/kRzxqWNV.js";import{a as mt}from"../chunks/BPsD12mz.js";import{B as bt}from"../chunks/Cka3GhAH.js";const Z=[{id:"pop",name:"Pop Groove",description:"LH: Whole-note octaves. RH: Syncopated quarter-note feel (1, 2, 2.5, 4).",suggestedBpm:100,timeSignature:"4/4",defaultChords:["F","Am","G","Dm"],isProgression:!0,measures:1,hits:[{beat:1,hand:"LH"},{beat:1,hand:"RH"},{beat:2,hand:"RH"},{beat:2.5,hand:"RH"},{beat:4,hand:"RH"}]},{id:"rock",name:"Rock Driving",description:"LH: Driving eighth-note octaves. RH: Steady chords.",suggestedBpm:120,timeSignature:"4/4",defaultChords:["C","F","Bb","Eb"],isProgression:!0,measures:1,hits:[{beat:1,hand:"LH"},{beat:1.5,hand:"LH"},{beat:2,hand:"LH"},{beat:2.5,hand:"LH"},{beat:3,hand:"LH"},{beat:3.5,hand:"LH"},{beat:4,hand:"LH"},{beat:4.5,hand:"LH"},{beat:1,hand:"RH"},{beat:2,hand:"RH"},{beat:3,hand:"RH"},{beat:4,hand:"RH"}]},{id:"jazz-charleston",name:"Jazz (Charleston)",description:'The classic Charleston rhythm. RH hits on 1 and the "and" of 2.',suggestedBpm:140,timeSignature:"4/4",defaultChords:["Dm7","G7","Cmaj7"],isProgression:!0,measures:1,hits:[{beat:1,hand:"LH"},{beat:1,hand:"RH"},{beat:2.5,hand:"RH"}]},{id:"funk-basic",name:"Funk Stabs",description:'Syncopated RH "chanks" on 16th-note off-beats.',suggestedBpm:95,timeSignature:"4/4",defaultChords:["Cm7","F9"],isProgression:!0,measures:1,hits:[{beat:1,hand:"LH"},{beat:1.25,hand:"RH"},{beat:2,hand:"LH"},{beat:2.75,hand:"RH"},{beat:3,hand:"LH"},{beat:4,hand:"RH"},{beat:4.5,hand:"RH"}]},{id:"herbie-funk",name:"Herbie Hancock Funk",description:'G minor funk blues. Syncopated LH bassline and RH hits on the "and" of 1.',suggestedBpm:105,timeSignature:"4/4",defaultChords:["Gm7","C7","D7"],isProgression:!0,measures:2,hits:[{beat:1,hand:"LH"},{beat:1.5,hand:"RH"},{beat:2,hand:"LH"},{beat:2.5,hand:"LH"},{beat:3,hand:"LH"},{beat:4.5,hand:"RH"},{beat:5,hand:"LH"},{beat:6,hand:"RH"},{beat:7.5,hand:"RH"},{beat:8,hand:"LH"}]},{id:"latin-montuno",name:"Latin (Montuno)",description:"Highly syncopated Montuno pattern focusing on off-beats.",suggestedBpm:120,timeSignature:"4/4",defaultChords:["Cm","Ebaug","Eb","Ebaug"],isProgression:!0,measures:2,hits:[{beat:1.5,hand:"RH"},{beat:2,hand:"RH"},{beat:2.5,hand:"RH"},{beat:3.5,hand:"RH"},{beat:4,hand:"RH"},{beat:4.5,hand:"RH"},{beat:5.5,hand:"RH"},{beat:6,hand:"RH"},{beat:6.5,hand:"RH"},{beat:7.5,hand:"RH"},{beat:8,hand:"RH"},{beat:8.5,hand:"RH"}]},{id:"blues-shuffle",name:"Blues Shuffle",description:"Loping triplet feel. LH plays a walking shuffle pattern.",suggestedBpm:90,timeSignature:"4/4",defaultChords:["G7","C7","D7"],isProgression:!0,measures:1,hits:[{beat:1,hand:"LH"},{beat:1.66,hand:"LH"},{beat:2,hand:"LH"},{beat:2.66,hand:"LH"},{beat:3,hand:"LH"},{beat:3.66,hand:"LH"},{beat:4,hand:"LH"},{beat:4.66,hand:"LH"},{beat:1,hand:"RH"},{beat:2.66,hand:"RH"},{beat:4,hand:"RH"}]},{id:"country-waltz",name:"Country Waltz",description:"Boom-chick-chick feel in 6/8. LH alternates Root and Fifth.",suggestedBpm:110,timeSignature:"6/8",defaultChords:["F","C/E","D7"],isProgression:!0,measures:1,hits:[{beat:1,hand:"LH"},{beat:2,hand:"RH"},{beat:3,hand:"RH"},{beat:4,hand:"LH"},{beat:5,hand:"RH"},{beat:6,hand:"RH"}]},{id:"blues-shells",name:"Blues Shells",description:"LH: Root-Fifth walking. RH: Root-3-7 Shell voicings on beats 2 and 4.",suggestedBpm:80,timeSignature:"4/4",defaultChords:["G7","C7","G7","D7"],isProgression:!0,measures:1,hits:[{beat:1,hand:"LH"},{beat:2,hand:"LH"},{beat:2,hand:"RH"},{beat:3,hand:"LH"},{beat:4,hand:"LH"},{beat:4,hand:"RH"}]},{id:"funk-root-chord",name:"Funk Root-Chord",description:'LH: Punchy roots on 1 and 3. RH: 16th-note chord stabs on the "e" and "a".',suggestedBpm:90,timeSignature:"4/4",defaultChords:["E9","A13"],isProgression:!0,measures:1,hits:[{beat:1,hand:"LH"},{beat:1.25,hand:"RH"},{beat:1.75,hand:"RH"},{beat:3,hand:"LH"},{beat:3.25,hand:"RH"},{beat:3.75,hand:"RH"}]}];var ft=x("<option> </option>"),pt=x("<div></div>"),Ht=x('<div><span class="hit-dot svelte-14dx2m1"></span> <span class="hit-label svelte-14dx2m1"> </span></div>'),_t=x('<div class="playhead svelte-14dx2m1"></div>'),gt=x('<div class="sync-meter-card card-premium svelte-14dx2m1"><span class="label svelte-14dx2m1">LH/RH Sync</span> <div class="sync-gauge svelte-14dx2m1"><div class="sync-axis svelte-14dx2m1"></div> <div class="sync-marker svelte-14dx2m1"></div></div> <span class="sync-val svelte-14dx2m1"> </span></div>'),xt=x('<div class="timing-feedback-container svelte-14dx2m1"><div><span class="feedback-msg svelte-14dx2m1"> </span> <span class="diff-val svelte-14dx2m1"> </span></div> <!></div>'),Rt=x(`<div class="completion-cta card-premium svelte-14dx2m1"><h3 class="svelte-14dx2m1">Target Reached!</h3> <p class="svelte-14dx2m1">You've completed 32 hits. Click below to save your stats.</p> <button class="finish-btn svelte-14dx2m1">Finish Exercise</button></div>`),Lt=x('<span class="chord-tag svelte-14dx2m1"> </span>'),yt=x('<div class="rhythm-exercise-content svelte-14dx2m1"><div class="rhythm-header card-premium svelte-14dx2m1"><div class="pattern-selector svelte-14dx2m1"><label for="pattern-select" class="svelte-14dx2m1">Musical Style</label> <select id="pattern-select" class="select-premium svelte-14dx2m1"></select></div> <div class="rhythm-controls"><div class="hand-isolation svelte-14dx2m1"><span class="label svelte-14dx2m1" id="solo-focus-label">Solo Focus</span> <div class="toggle-group svelte-14dx2m1" role="group" aria-labelledby="solo-focus-label"><button>Both</button> <button>LH Only</button> <button>RH Only</button></div></div> <button> </button> <div class="bpm-input svelte-14dx2m1"><label for="bpm" class="svelte-14dx2m1"> </label> <input id="bpm" type="range" min="40" max="200"/></div></div></div> <div class="timeline-container card-premium svelte-14dx2m1"><div class="timeline-labels svelte-14dx2m1"><span>1</span><span>&</span><span>2</span><span>&</span> <span>3</span><span>&</span><span>4</span><span>&</span></div> <div class="timeline-track svelte-14dx2m1"><!>  <!> <!></div></div> <div class="feedback-area svelte-14dx2m1"><!> <!> <div class="chord-display card-premium svelte-14dx2m1"><span class="label svelte-14dx2m1">Current Sequence:</span> <div class="chords svelte-14dx2m1"></div></div></div></div>'),Ct=x("<!> ```",1);function Ft(Pe,Me){nt(Me,!0);let T=y(100),R=y(!1),W=y(0),L=y(null),A=y(""),$=y(null),b=y("none"),K=0,ee=0,u=null,q=0,j=null,De=25,Te=.1,M=y(0),w=[],E=[],te=y(it(Z[0].id)),H=U(()=>Z.find(l=>l.id===e(te))||Z[0]);const $e=.15,we=60;function Ee(){const l=60/e(T)/4;q+=l,Be(M);const _=e(H).measures*4*4;e(M)>=_&&o(M,0)}function Fe(l,_){const J=l/4+1;if(E.push({beat:J,time:_}),!!u&&l%4===0){const f=u.createOscillator(),c=u.createGain();f.connect(c),c.connect(u.destination);const g=l/4%(parseInt(e(H).timeSignature[0])||4)===0;f.frequency.value=g?880:440,c.gain.value=.2,f.start(_),f.stop(_+.05)}}function le(){if(u){for(;q<u.currentTime+Te;)Fe(e(M),q),Ee();j=window.setTimeout(le,De)}}function Ne(){e(R)||(u||(u=new AudioContext),o(R,!0),o(M,0),q=u.currentTime+.1,le())}function Y(){o(R,!1),j&&(window.clearTimeout(j),j=null),E=[],o(L,null),o(A,"")}function Ge(){e(R)?Y():Ne()}function Ie(l){return[60]}function Oe(l){return{selectedNote:l,leftHand:[],rightHand:[]}}function ze(l,_,J){if(!e(R)||!u)return{isCorrect:!1,message:"Start the metronome first!",collected:!1,resetCollected:!1};const f=u.currentTime;E=E.filter(v=>v.time>f-1);let c=1/0;const g=_.noteNumber<we?"LH":"RH";if(e(b)!=="none"&&g!==e(b))return{isCorrect:!1,message:`Focus on ${e(b)}!`,collected:!1,resetCollected:!1};for(const v of E)for(const F of e(H).hits){if(F.hand!==g)continue;const N=F.beat-v.beat,D=v.time+N*(60/e(T))-f;Math.abs(D)<Math.abs(c)&&(c=D)}const B=Math.abs(c);if(o(L,c*1e3),B<=$e){let v="Perfect!";return B>.05&&(v=c>0?"Early":"Late"),o(A,v,!0),Be(W),w.push(B*1e3),g==="LH"?K=f:ee=f,Math.abs(K-ee)<.2&&o($,(ee-K)*1e3),{isCorrect:!0,message:`${g}: ${v} (${Math.round(c*1e3)}ms)`,collected:!0,resetCollected:!0}}else return o(A,"Miss"),{isCorrect:!1,message:"Off beat!",collected:!1,resetCollected:!1}}function We(l,_){return e(W)>=32}function Ae(){o(W,0),w=[],Y()}st(()=>{Y(),u&&u.close()});var ce=Ct(),qe=Se(ce);{const l=(J,f=rt)=>{var c=yt(),g=s(c),B=s(g),v=n(s(B),2);v.__change=Y,V(v,21,()=>Z,X,(a,r)=>{var i=ft(),m=s(i,!0);t(i);var d={};k(()=>{S(m,e(r).name),d!==(d=e(r).id)&&(i.value=(i.__value=e(r).id)??"")}),p(a,i)}),t(v),t(B);var F=n(B,2),N=s(F),ae=n(s(N),2),D=s(ae);D.__click=()=>o(b,"none");let ue;var se=n(D,2);se.__click=()=>o(b,"LH");let ve;var he=n(se,2);he.__click=()=>o(b,"RH");let me;t(ae),t(N);var G=n(N,2);let be;G.__click=Ge;var je=s(G,!0);t(G);var fe=n(G,2),ne=s(fe),Ye=s(ne);t(ne);var pe=n(ne,2);ut(pe),t(fe),t(F),t(g);var ie=n(g,2),He=n(s(ie),2),_e=s(He);V(_e,17,()=>Array(e(H).measures*16),X,(a,r,i)=>{const m=U(()=>i%4===0),d=U(()=>i%2===0);var h=pt();let C;k(()=>C=P(h,1,"subdivision-mark svelte-14dx2m1",null,C,{whole:e(m),half:e(d)})),p(a,h)});var ge=n(_e,2);{var Je=a=>{var r=at(),i=Se(r);V(i,17,()=>e(H).hits,X,(m,d)=>{var h=Ht();let C;var Q=n(s(h),2),re=s(Q,!0);t(Q),t(h),k(()=>{C=P(h,1,"hit-marker svelte-14dx2m1",null,C,{lh:e(d).hand==="LH",rh:e(d).hand==="RH",dimmed:e(b)!=="none"&&e(d).hand!==e(b)}),oe(h,`left: ${(e(d).beat-1)/(e(H).measures*4)*100}%`),S(re,e(d).hand)}),vt(3,h,()=>ht),p(m,h)}),p(a,r)};z(ge,a=>{e(R)&&a(Je)})}var Qe=n(ge,2);{var Ue=a=>{var r=_t();k(()=>oe(r,`left: ${e(M)/(e(H).measures*16)*100}%`)),p(a,r)};z(Qe,a=>{e(R)&&a(Ue)})}t(He),t(ie);var xe=n(ie,2),Re=s(xe);{var Ve=a=>{var r=xt(),i=s(r);let m;var d=s(i),h=s(d,!0);t(d);var C=n(d,2),Q=s(C);t(C),t(i);var re=n(i,2);{var Ze=I=>{var O=gt(),de=n(s(O),2),Ke=n(s(de),2);t(de);var ke=n(de,2),et=s(ke,!0);t(ke),t(O),k(tt=>{oe(Ke,`left: ${50+e($)/100*50}%`),S(et,tt)},[()=>Math.abs(e($))<10?"Locked":`${Math.round(e($))}ms`]),p(I,O)};z(re,I=>{e($)!==null&&I(Ze)})}t(r),k((I,O)=>{m=P(i,1,"timing-feedback svelte-14dx2m1",null,m,I),S(h,e(A)),S(Q,`${e(L)>0?"+":""}${O??""}ms`)},[()=>({perfect:Math.abs(e(L))<50,near:Math.abs(e(L))>=50&&Math.abs(e(L))<120,miss:Math.abs(e(L))>=120}),()=>Math.round(e(L))]),p(a,r)};z(Re,a=>{e(L)!==null&&a(Ve)})}var Le=n(Re,2);{var Xe=a=>{var r=Rt(),i=n(s(r),4);i.__click=()=>{const m=w.length>0?w.reduce((d,h)=>d+h,0)/w.length:void 0;f().completeExercise({avgDeviationMs:m})},t(r),p(a,r)};z(Le,a=>{e(W)>=32&&a(Xe)})}var ye=n(Le,2),Ce=n(s(ye),2);V(Ce,21,()=>e(H).defaultChords,X,(a,r)=>{var i=Lt(),m=s(i,!0);t(i),k(()=>S(m,e(r))),p(a,i)}),t(Ce),t(ye),t(xe),t(c),k(()=>{ue=P(D,1,"svelte-14dx2m1",null,ue,{active:e(b)==="none"}),ve=P(se,1,"svelte-14dx2m1",null,ve,{active:e(b)==="LH"}),me=P(he,1,"svelte-14dx2m1",null,me,{active:e(b)==="RH"}),be=P(G,1,"action-btn svelte-14dx2m1",null,be,{playing:e(R)}),S(je,e(R)?"Stop":"Start Metronome"),S(Ye,`BPM: ${e(T)??""}`)}),ct(v,()=>e(te),a=>o(te,a)),mt(pe,()=>e(T),a=>o(T,a)),p(J,c)};let _=U(()=>`Style: ${e(H).name}. ${e(H).description}`);bt(qe,{randomMode:!1,generateExpectedNotes:Ie,generateScoreProps:Oe,validateNoteEvent:ze,isCompleted:We,onReset:Ae,onComplete:()=>{},initialNote:"C",get description(){return e(_)},showScore:!1,exerciseType:"rhythm",children:l,$$slots:{default:!0}})}ot(),p(Pe,ce),dt()}lt(["change","click"]);export{Ft as component};
