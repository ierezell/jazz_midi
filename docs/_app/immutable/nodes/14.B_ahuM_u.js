import{f as O,a as K}from"../chunks/Bdvgn338.js";import{p as re,U as N,V as w,k as e,X as H,a as ae,Z as o,c as _,r as M,f as ne,_ as ce,s as b,t as ie}from"../chunks/ZtE6Gyvq.js";import{d as ue}from"../chunks/BnZ86L-c.js";import{i as de}from"../chunks/CdTPX8-T.js";import{r as fe,i as V,s as W}from"../chunks/C2lzuMI8.js";import{b as ve}from"../chunks/CVoLLLxN.js";import{p as me}from"../chunks/-nZJNBOr.js";import{S as ge,N as D,M as F}from"../chunks/CXrKfc7O.js";import{B as pe}from"../chunks/DBDa-pHI.js";import{p as he}from"../chunks/BYaj1R6p.js";function _e(y,i,C){let n="right";typeof C=="boolean"?n=C?"right":"left":n=C;const g=ge[i],c=[];if(n==="left"||n==="both"){const u=D[y+"2"];c.push(...g.map(m=>u+m))}if(n==="right"||n==="both"){const u=D[y+"3"];c.push(...g.map(m=>u+m))}return n==="both"&&c.sort((u,m)=>u-m),c}var Me=O('<div class="control-group svelte-1l89l8c"><label class="svelte-1l89l8c"><input type="checkbox" class="svelte-1l89l8c"/> In order</label></div> <div class="control-group svelte-1l89l8c"><label for="handMode" class="svelte-1l89l8c">Hand:</label> <select id="handMode" class="svelte-1l89l8c"><option class="svelte-1l89l8c">Right Hand</option><option class="svelte-1l89l8c">Left Hand</option><option class="svelte-1l89l8c">Both Hands</option></select></div> <div class="control-group svelte-1l89l8c"><label for="scaleMode" class="svelte-1l89l8c">Scale mode:</label> <select id="scaleMode" class="svelte-1l89l8c"><option class="svelte-1l89l8c">Major</option><option class="svelte-1l89l8c">Minor</option></select></div>',1),be=O('<div class="scale-controls svelte-1l89l8c"><!></div>');function ze(y,i){re(i,!0);const C="Play the scale shown, ascending and/or descending, using your MIDI keyboard. Try to follow the correct order.";let n=me(i,"strictMode",3,!0),g=N(w(i.sequentialMode??!1)),c=N(w(i.handMode??"right")),u=N(w(i.scaleMode??"Maj")),m=H(()=>i.rootKey??"C"),f=N(w([])),a=N(w(new Set)),U=H(()=>`${e(m)} ${e(u)==="Maj"?"Major":"Minor"} Scale`),X=H(()=>i.prompt??e(U));function Z(){o(f,[],!0),o(a,new Set,!0)}function J(l,t,r,s){return e(g)?Y(t,r):$(t,r)}function j(l){return _e(e(m),e(u),e(c))}function Q(l){const r=j().map(s=>F[s]);return{selectedNote:e(m),leftHand:e(c)==="left"||e(c)==="both"?[r]:[],rightHand:e(c)==="right"||e(c)==="both"?[r]:[]}}function Y(l,t,r){const s=e(f).length,d=t[s];if(n()?l.noteNumber===d:l.noteNumber%12===d%12)o(f,[...e(f),l.noteNumber],!0),o(a,new Set([...e(a),l.noteNumber]),!0);else{const v=F[d]?.slice(0,-1)??String(d);return o(f,[],!0),o(a,new Set,!0),{isCorrect:!1,message:`Wrong note! Expected ${v} ${n()?"":"(any octave)"}`,collected:!1,resetCollected:!0}}return e(f).length===t.length?{isCorrect:!0,message:"Perfect scale! ðŸŽµâœ¨",collected:!0,resetCollected:!1}:{isCorrect:!0,message:`Good! Note ${s+1}/${t.length}`,collected:!0,resetCollected:!1}}function $(l,t,r){const s=t.map(v=>v%12),d=l.noteNumber%12;if(n()?t.includes(l.noteNumber):s.includes(d)){o(a,new Set([...e(a),l.noteNumber]),!0);let v=!1;if(n())v=e(a).size===t.length;else{const E=new Set([...e(a)].map(x=>x%12)),S=new Set(s);v=E.size===S.size}return v?{isCorrect:!0,message:"Perfect scale! ðŸŽµ",collected:!0,resetCollected:!1}:{isCorrect:!0,message:`Good! ${e(a).size}/${t.length} notes`,collected:!0,resetCollected:!1}}else return o(a,new Set,!0),{isCorrect:!1,message:"Wrong note!",resetCollected:!0,collected:!1}}function ee(l,t){if(e(g))return e(f).length===t.length&&e(f).every((r,s)=>n()?r===t[s]:r%12===t[s]%12);if(n()){const r=[...new Set(t)];return e(a).size===r.length}else{const r=new Set([...e(a)].map(d=>d%12)),s=new Set(t.map(d=>d%12));return r.size===s.size}}function te(l){const t=l.target;o(g,t.checked,!0),o(a,new Set,!0),o(f,[],!0)}function le(l){const t=l.target;o(c,t.value,!0),o(a,new Set,!0),o(f,[],!0)}function oe(l){const t=l.target;o(u,t.value,!0),o(a,new Set,!0),o(f,[],!0)}{const l=r=>{var s=be(),d=_(s);{var P=v=>{var E=Me(),S=ne(E),x=_(S),q=_(x);fe(q),q.__change=te,ce(),M(x),M(S);var z=b(S,2),p=b(_(z),2);p.__change=le;var T=_(p);T.value=T.__value="right";var k=b(T);k.value=k.__value="left";var R=b(k);R.value=R.__value="both",M(p);var L;V(p),M(z);var A=b(z,2),h=b(_(A),2);h.__change=oe;var I=_(h);I.value=I.__value="Maj";var B=b(I);B.value=B.__value="Min",M(h);var G;V(h),M(A),ie(()=>{L!==(L=e(c))&&(p.value=(p.__value=e(c))??"",W(p,e(c))),G!==(G=e(u))&&(h.value=(h.__value=e(u))??"",W(h,e(u)))}),ve(q,()=>e(g),se=>o(g,se)),K(v,E)};de(d,v=>{!i.randomMode&&!he.url.searchParams.get("unitId")&&v(P)})}M(s),K(r,s)};let t=H(()=>i.onComplete??(()=>{}));pe(y,{get randomMode(){return i.randomMode},generateExpectedNotes:j,generateScoreProps:Q,validateNoteEvent:J,isCompleted:ee,onReset:Z,get onComplete(){return e(t)},get initialNote(){return e(m)},description:C,exerciseType:"scale",get progressiveHints(){return i.progressiveHints},get prompt(){return e(X)},showTempoControl:!0,timingModeLabel:"Play scale on beat",children:l,$$slots:{default:!0}})}ae()}ue(["change"]);export{ze as component};
