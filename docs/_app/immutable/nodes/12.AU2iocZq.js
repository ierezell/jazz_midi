import{f as L,a as $,c as Ke}from"../chunks/Bdvgn338.js";import{a as et}from"../chunks/BRJReVLM.js";import{p as tt,U as R,V as st,W as at,k as e,X as U,a as nt,Z as d,s as n,c as a,t as y,Y as ye,r as t,f as ot}from"../chunks/ZtE6Gyvq.js";import{d as it,s as S}from"../chunks/BnZ86L-c.js";import{e as V,i as X}from"../chunks/DfaP9-sJ.js";import{i as O}from"../chunks/CdTPX8-T.js";import{j as rt,r as dt,c as B,h as de}from"../chunks/PYtk8PMn.js";import{t as lt,f as ct}from"../chunks/BEryLFqn.js";import{a as ut}from"../chunks/CVoLLLxN.js";import{B as mt}from"../chunks/Dal78mhG.js";const ht="pop",vt="Pop Groove",bt="LH: Whole-note octaves. RH: Syncopated quarter-note feel (1, 2, 2.5, 4).",ft=100,pt="4/4",gt=["F","Am","G","Dm"],Ht=!0,$t=1,_t=[{beat:1,hand:"LH"},{beat:1,hand:"RH"},{beat:2,hand:"RH"},{beat:2.5,hand:"RH"},{beat:4,hand:"RH"}],xt={id:ht,name:vt,description:bt,suggestedBpm:ft,timeSignature:pt,defaultChords:gt,isProgression:Ht,measures:$t,hits:_t},Rt="rock",Lt="Rock Driving",Ct="LH: Driving eighth-note octaves. RH: Steady chords.",yt=120,St="4/4",kt=["C","F","Bb","Eb"],Bt=!0,Pt=1,Mt=[{beat:1,hand:"LH"},{beat:1.5,hand:"LH"},{beat:2,hand:"LH"},{beat:2.5,hand:"LH"},{beat:3,hand:"LH"},{beat:3.5,hand:"LH"},{beat:4,hand:"LH"},{beat:4.5,hand:"LH"},{beat:1,hand:"RH"},{beat:2,hand:"RH"},{beat:3,hand:"RH"},{beat:4,hand:"RH"}],Dt={id:Rt,name:Lt,description:Ct,suggestedBpm:yt,timeSignature:St,defaultChords:kt,isProgression:Bt,measures:Pt,hits:Mt},Tt="jazz-charleston",wt="Jazz (Charleston)",Et='The classic Charleston rhythm. RH hits on 1 and the "and" of 2.',Ft=140,Nt="4/4",zt=["Dm7","G7","Cmaj7"],Gt=!0,It=1,Ot=[{beat:1,hand:"LH"},{beat:1,hand:"RH"},{beat:2.5,hand:"RH"}],Wt={id:Tt,name:wt,description:Et,suggestedBpm:Ft,timeSignature:Nt,defaultChords:zt,isProgression:Gt,measures:It,hits:Ot},At="funk-basic",jt="Funk Stabs",qt='Syncopated RH "chanks" on 16th-note off-beats.',Yt=95,Jt="4/4",Qt=["Cm7","F9"],Ut=!0,Vt=1,Xt=[{beat:1,hand:"LH"},{beat:1.25,hand:"RH"},{beat:2,hand:"LH"},{beat:2.75,hand:"RH"},{beat:3,hand:"LH"},{beat:4,hand:"RH"},{beat:4.5,hand:"RH"}],Zt={id:At,name:jt,description:qt,suggestedBpm:Yt,timeSignature:Jt,defaultChords:Qt,isProgression:Ut,measures:Vt,hits:Xt},Kt="herbie-funk",es="Herbie Hancock Funk",ts='G minor funk blues. Syncopated LH bassline and RH hits on the "and" of 1.',ss=105,as="4/4",ns=["Gm7","C7","D7"],os=!0,is=2,rs=[{beat:1,hand:"LH"},{beat:1.5,hand:"RH"},{beat:2,hand:"LH"},{beat:2.5,hand:"LH"},{beat:3,hand:"LH"},{beat:4.5,hand:"RH"},{beat:5,hand:"LH"},{beat:6,hand:"RH"},{beat:7.5,hand:"RH"},{beat:8,hand:"LH"}],ds={id:Kt,name:es,description:ts,suggestedBpm:ss,timeSignature:as,defaultChords:ns,isProgression:os,measures:is,hits:rs},ls="latin-montuno",cs="Latin (Montuno)",us="Highly syncopated Montuno pattern focusing on off-beats.",ms=120,hs="4/4",vs=["Cm","Ebaug","Eb","Ebaug"],bs=!0,fs=2,ps=[{beat:1.5,hand:"RH"},{beat:2,hand:"RH"},{beat:2.5,hand:"RH"},{beat:3.5,hand:"RH"},{beat:4,hand:"RH"},{beat:4.5,hand:"RH"},{beat:5.5,hand:"RH"},{beat:6,hand:"RH"},{beat:6.5,hand:"RH"},{beat:7.5,hand:"RH"},{beat:8,hand:"RH"},{beat:8.5,hand:"RH"}],gs={id:ls,name:cs,description:us,suggestedBpm:ms,timeSignature:hs,defaultChords:vs,isProgression:bs,measures:fs,hits:ps},Hs="blues-shuffle",$s="Blues Shuffle",_s="Loping triplet feel. LH plays a walking shuffle pattern.",xs=90,Rs="4/4",Ls=["G7","C7","D7"],Cs=!0,ys=1,Ss=[{beat:1,hand:"LH"},{beat:1.66,hand:"LH"},{beat:2,hand:"LH"},{beat:2.66,hand:"LH"},{beat:3,hand:"LH"},{beat:3.66,hand:"LH"},{beat:4,hand:"LH"},{beat:4.66,hand:"LH"},{beat:1,hand:"RH"},{beat:2.66,hand:"RH"},{beat:4,hand:"RH"}],ks={id:Hs,name:$s,description:_s,suggestedBpm:xs,timeSignature:Rs,defaultChords:Ls,isProgression:Cs,measures:ys,hits:Ss},Bs="country-waltz",Ps="Country Waltz",Ms="Boom-chick-chick feel in 6/8. LH alternates Root and Fifth.",Ds=110,Ts="6/8",ws=["F","C/E","D7"],Es=!0,Fs=1,Ns=[{beat:1,hand:"LH"},{beat:2,hand:"RH"},{beat:3,hand:"RH"},{beat:4,hand:"LH"},{beat:5,hand:"RH"},{beat:6,hand:"RH"}],zs={id:Bs,name:Ps,description:Ms,suggestedBpm:Ds,timeSignature:Ts,defaultChords:ws,isProgression:Es,measures:Fs,hits:Ns},Gs="blues-shells",Is="Blues Shells",Os="LH: Root-Fifth walking. RH: Root-3-7 Shell voicings on beats 2 and 4.",Ws=80,As="4/4",js=["G7","C7","G7","D7"],qs=!0,Ys=1,Js=[{beat:1,hand:"LH"},{beat:2,hand:"LH"},{beat:2,hand:"RH"},{beat:3,hand:"LH"},{beat:4,hand:"LH"},{beat:4,hand:"RH"}],Qs={id:Gs,name:Is,description:Os,suggestedBpm:Ws,timeSignature:As,defaultChords:js,isProgression:qs,measures:Ys,hits:Js},Us="funk-root-chord",Vs="Funk Root-Chord",Xs='LH: Punchy roots on 1 and 3. RH: 16th-note chord stabs on the "e" and "a".',Zs=90,Ks="4/4",ea=["E9","A13"],ta=!0,sa=1,aa=[{beat:1,hand:"LH"},{beat:1.25,hand:"RH"},{beat:1.75,hand:"RH"},{beat:3,hand:"LH"},{beat:3.25,hand:"RH"},{beat:3.75,hand:"RH"}],na={id:Us,name:Vs,description:Xs,suggestedBpm:Zs,timeSignature:Ks,defaultChords:ea,isProgression:ta,measures:sa,hits:aa},Z=[xt,Dt,Wt,Zt,ds,gs,ks,zs,Qs,na];var oa=L("<option> </option>"),ia=L("<div></div>"),ra=L('<div><span class="hit-dot svelte-14dx2m1"></span> <span class="hit-label svelte-14dx2m1"> </span></div>'),da=L('<div class="playhead svelte-14dx2m1"></div>'),la=L('<div class="sync-meter-card card-premium svelte-14dx2m1"><span class="label svelte-14dx2m1">LH/RH Sync</span> <div class="sync-gauge svelte-14dx2m1"><div class="sync-axis svelte-14dx2m1"></div> <div class="sync-marker svelte-14dx2m1"></div></div> <span class="sync-val svelte-14dx2m1"> </span></div>'),ca=L('<div class="timing-feedback-container svelte-14dx2m1"><div><span class="feedback-msg svelte-14dx2m1"> </span> <span class="diff-val svelte-14dx2m1"> </span></div> <!></div>'),ua=L(`<div class="completion-cta card-premium svelte-14dx2m1"><h3 class="svelte-14dx2m1">Target Reached!</h3> <p class="svelte-14dx2m1">You've completed 32 hits. Click below to save your stats.</p> <button class="finish-btn svelte-14dx2m1">Finish Exercise</button></div>`),ma=L('<span class="chord-tag svelte-14dx2m1"> </span>'),ha=L('<div class="rhythm-exercise-content svelte-14dx2m1"><div class="rhythm-header card-premium svelte-14dx2m1"><div class="pattern-selector svelte-14dx2m1"><label for="pattern-select" class="svelte-14dx2m1">Musical Style</label> <select id="pattern-select" class="select-premium svelte-14dx2m1"></select></div> <div class="rhythm-controls"><div class="hand-isolation svelte-14dx2m1"><span class="label svelte-14dx2m1" id="solo-focus-label">Solo Focus</span> <div class="toggle-group svelte-14dx2m1" role="group" aria-labelledby="solo-focus-label"><button>Both</button> <button>LH Only</button> <button>RH Only</button></div></div> <button> </button> <div class="bpm-input svelte-14dx2m1"><label for="bpm" class="svelte-14dx2m1"> </label> <input id="bpm" type="range" min="40" max="200"/></div></div></div> <div class="timeline-container card-premium svelte-14dx2m1"><div class="timeline-labels svelte-14dx2m1"><span>1</span><span>&</span><span>2</span><span>&</span> <span>3</span><span>&</span><span>4</span><span>&</span></div> <div class="timeline-track svelte-14dx2m1"><!>  <!> <!></div></div> <div class="feedback-area svelte-14dx2m1"><!> <!> <div class="chord-display card-premium svelte-14dx2m1"><span class="label svelte-14dx2m1">Current Sequence:</span> <div class="chords svelte-14dx2m1"></div></div></div></div>');function La(Se,ke){tt(ke,!0);let D=R(100),_=R(!1),W=R(0),x=R(null),A=R(""),T=R(null),b=R("none"),K=0,ee=0,u=null,j=0,q=null,Be=25,Pe=.1,P=R(0),w=[],E=[],te=R(st(Z[0].id)),p=U(()=>Z.find(l=>l.id===e(te))||Z[0]);const Me=.15,De=60;function Te(){const l=60/e(D)/4;j+=l,ye(P);const g=e(p).measures*4*4;e(P)>=g&&d(P,0)}function we(l,g){const J=l/4+1;if(E.push({beat:J,time:g}),!!u&&l%4===0){const f=u.createOscillator(),c=u.createGain();f.connect(c),c.connect(u.destination);const H=l/4%(parseInt(e(p).timeSignature[0])||4)===0;f.frequency.value=H?880:440,c.gain.value=.2,f.start(g),f.stop(g+.05)}}function le(){if(u){for(;j<u.currentTime+Pe;)we(e(P),j),Te();q=window.setTimeout(le,Be)}}function Ee(){e(_)||(u||(u=new AudioContext),d(_,!0),d(P,0),j=u.currentTime+.1,le())}function Y(){d(_,!1),q&&(window.clearTimeout(q),q=null),E=[],d(x,null),d(A,"")}function Fe(){e(_)?Y():Ee()}function Ne(l){return[60]}function ze(l){return{selectedNote:l,leftHand:[],rightHand:[]}}function Ge(l,g,J){if(!e(_)||!u)return{isCorrect:!1,message:"Start the metronome first!",collected:!1,resetCollected:!1};const f=u.currentTime;E=E.filter(m=>m.time>f-1);let c=1/0;const H=g.noteNumber<De?"LH":"RH";if(e(b)!=="none"&&H!==e(b))return{isCorrect:!1,message:`Focus on ${e(b)}!`,collected:!1,resetCollected:!1};for(const m of E)for(const F of e(p).hits){if(F.hand!==H)continue;const N=F.beat-m.beat,M=m.time+N*(60/e(D))-f;Math.abs(M)<Math.abs(c)&&(c=M)}const k=Math.abs(c);if(d(x,c*1e3),k<=Me){let m="Perfect!";return k>.05&&(m=c>0?"Early":"Late"),d(A,m,!0),ye(W),w.push(k*1e3),H==="LH"?K=f:ee=f,Math.abs(K-ee)<.2&&d(T,(ee-K)*1e3),{isCorrect:!0,message:`${H}: ${m} (${Math.round(c*1e3)}ms)`,collected:!0,resetCollected:!0}}else return d(A,"Miss"),{isCorrect:!1,message:"Off beat!",collected:!1,resetCollected:!1}}function Ie(l,g){return e(W)>=32}function Oe(){d(W,0),w=[],Y()}et(()=>{Y(),u&&u.close()});{const l=(J,f=at)=>{var c=ha(),H=a(c),k=a(H),m=n(a(k),2);m.__change=Y,V(m,21,()=>Z,X,(s,i)=>{var o=oa(),v=a(o,!0);t(o);var r={};y(()=>{S(v,e(i).name),r!==(r=e(i).id)&&(o.value=(o.__value=e(i).id)??"")}),$(s,o)}),t(m),t(k);var F=n(k,2),N=a(F),se=n(a(N),2),M=a(se);M.__click=()=>d(b,"none");let ce;var ae=n(M,2);ae.__click=()=>d(b,"LH");let ue;var me=n(ae,2);me.__click=()=>d(b,"RH");let he;t(se),t(N);var z=n(N,2);let ve;z.__click=Fe;var We=a(z,!0);t(z);var be=n(z,2),ne=a(be),Ae=a(ne);t(ne);var fe=n(ne,2);dt(fe),t(be),t(F),t(H);var oe=n(H,2),pe=n(a(oe),2),ge=a(pe);V(ge,17,()=>Array(e(p).measures*16),X,(s,i,o)=>{const v=U(()=>o%4===0),r=U(()=>o%2===0);var h=ia();let C;y(()=>C=B(h,1,"subdivision-mark svelte-14dx2m1",null,C,{whole:e(v),half:e(r)})),$(s,h)});var He=n(ge,2);{var je=s=>{var i=Ke(),o=ot(i);V(o,17,()=>e(p).hits,X,(v,r)=>{var h=ra();let C;var Q=n(a(h),2),ie=a(Q,!0);t(Q),t(h),y(()=>{C=B(h,1,"hit-marker svelte-14dx2m1",null,C,{lh:e(r).hand==="LH",rh:e(r).hand==="RH",dimmed:e(b)!=="none"&&e(r).hand!==e(b)}),de(h,`left: ${(e(r).beat-1)/(e(p).measures*4)*100}%`),S(ie,e(r).hand)}),lt(3,h,()=>ct),$(v,h)}),$(s,i)};O(He,s=>{e(_)&&s(je)})}var qe=n(He,2);{var Ye=s=>{var i=da();y(()=>de(i,`left: ${e(P)/(e(p).measures*16)*100}%`)),$(s,i)};O(qe,s=>{e(_)&&s(Ye)})}t(pe),t(oe);var $e=n(oe,2),_e=a($e);{var Je=s=>{var i=ca(),o=a(i);let v;var r=a(o),h=a(r,!0);t(r);var C=n(r,2),Q=a(C);t(C),t(o);var ie=n(o,2);{var Ue=G=>{var I=la(),re=n(a(I),2),Ve=n(a(re),2);t(re);var Ce=n(re,2),Xe=a(Ce,!0);t(Ce),t(I),y(Ze=>{de(Ve,`left: ${50+e(T)/100*50}%`),S(Xe,Ze)},[()=>Math.abs(e(T))<10?"Locked":`${Math.round(e(T))}ms`]),$(G,I)};O(ie,G=>{e(T)!==null&&G(Ue)})}t(i),y((G,I)=>{v=B(o,1,"timing-feedback svelte-14dx2m1",null,v,G),S(h,e(A)),S(Q,`${e(x)>0?"+":""}${I??""}ms`)},[()=>({perfect:Math.abs(e(x))<50,near:Math.abs(e(x))>=50&&Math.abs(e(x))<120,miss:Math.abs(e(x))>=120}),()=>Math.round(e(x))]),$(s,i)};O(_e,s=>{e(x)!==null&&s(Je)})}var xe=n(_e,2);{var Qe=s=>{var i=ua(),o=n(a(i),4);o.__click=()=>{const v=w.length>0?w.reduce((r,h)=>r+h,0)/w.length:void 0;f().completeExercise({avgDeviationMs:v})},t(i),$(s,i)};O(xe,s=>{e(W)>=32&&s(Qe)})}var Re=n(xe,2),Le=n(a(Re),2);V(Le,21,()=>e(p).defaultChords,X,(s,i)=>{var o=ma(),v=a(o,!0);t(o),y(()=>S(v,e(i))),$(s,o)}),t(Le),t(Re),t($e),t(c),y(()=>{ce=B(M,1,"svelte-14dx2m1",null,ce,{active:e(b)==="none"}),ue=B(ae,1,"svelte-14dx2m1",null,ue,{active:e(b)==="LH"}),he=B(me,1,"svelte-14dx2m1",null,he,{active:e(b)==="RH"}),ve=B(z,1,"action-btn svelte-14dx2m1",null,ve,{playing:e(_)}),S(We,e(_)?"Stop":"Start Metronome"),S(Ae,`BPM: ${e(D)??""}`)}),rt(m,()=>e(te),s=>d(te,s)),ut(fe,()=>e(D),s=>d(D,s)),$(J,c)};let g=U(()=>`Style: ${e(p).name}. ${e(p).description}`);mt(Se,{randomMode:!1,generateExpectedNotes:Ne,generateScoreProps:ze,validateNoteEvent:Ge,isCompleted:Ie,onReset:Oe,onComplete:()=>{},initialNote:"C",get description(){return e(g)},showScore:!1,exerciseType:"rhythm",children:l,$$slots:{default:!0}})}nt()}it(["change","click"]);export{La as component};
