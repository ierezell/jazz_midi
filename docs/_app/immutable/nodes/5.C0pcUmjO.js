import{f as K,a as y,t as ee,c as be}from"../chunks/CGs25f5Q.js";import{p as xe,U as B,V as te,W as Me,k as e,a as Te,Y as T,Z as b,f as F,s as a,c as p,r as u,t as E}from"../chunks/CPN3W99e.js";import{d as He,s as S}from"../chunks/Cf1jdkyt.js";import{e as Re,i as Ee}from"../chunks/Cg977V2y.js";import{i as W}from"../chunks/CO7pLaZ9.js";import{i as j,s as z}from"../chunks/CZv5_2PD.js";import{B as Ne,a as Ie,b as Pe,g as Ve}from"../chunks/BvxIlnQz.js";import{e as oe,N as we,D as Ae,b as De}from"../chunks/CXrKfc7O.js";import{p as G}from"../chunks/j92QXW3d.js";var Le=K("<option> </option>"),ke=K('<div class="control-group svelte-b6xay4"><label for="chord-type" class="svelte-b6xay4">Chord Type:</label> <select id="chord-type"></select></div> <div class="control-group svelte-b6xay4"><label for="inversion" class="svelte-b6xay4">Inversion:</label> <select id="inversion"><option>Root</option><option>1st</option><option>2nd</option><option>3rd</option></select></div> <div class="control-group svelte-b6xay4"><label for="voicing" class="svelte-b6xay4">Voicing:</label> <select id="voicing"><option>Full Right Hand</option><option>Full Left Hand</option><option>1 & 7 Left / 3 & 5 Right</option><option>1 & 5 Left / 3 & 7 Right</option><option>Rootless A (3-5-7-9)</option><option>Rootless B (7-9-3-5)</option></select></div>',1),Be=K('<!> <div class="controls svelte-b6xay4"><!></div>',1);function Oe(ae,r){xe(r,!0);const re="Play the notes of the displayed chord on your MIDI keyboard. Try to match the voicing and inversion shown.",ne=T(()=>G.url.searchParams.get("root"));let U=["maj7","min7","7","dom7","half-dim7","dim7"],_=T(()=>G.url.searchParams.get("quality")??r.chordType??(r.randomMode?U[Math.floor(Math.random()*U.length)]:"maj7")),f=B(te(r.inversion??(r.randomMode?Math.floor(Math.random()*4):0))),i=B(te(r.voicing??(r.randomMode?oe[Math.floor(Math.random()*oe.length)]:"full-right"))),se=T(()=>e(ne)??r.rootKey??"C"),H=B(!1);function le(o){const t=o+Ae,n=we[t],c=Ie(n,e(_),e(f));return Pe(c,e(i))}function ie(o,t,n){const c=n.map(R=>R%12),s=t.noteNumber%12;if(c.includes(s)){if(n.includes(t.noteNumber))return{isCorrect:!0,message:"Correct chord tone!",collected:!0,resetCollected:!1};if(e(i).startsWith("rootless"))return{isCorrect:!0,message:"Correct chord tone (octave ignored)!",collected:!0,resetCollected:!1}}return{isCorrect:!1,message:"Not a chord tone. Try again!",collected:!1,resetCollected:!0}}function ce(o){const t=o.target;b(_,t.value)}function ve(o){const t=o.target;b(f,parseInt(t.value),!0)}function de(o){const t=o.target;b(i,t.value,!0)}function ue(o){try{const t=Ve(o,e(_),e(f),e(i));return console.debug("Generated score data:",{selectedNote:o,chordType:e(_),voicing:e(i),inversion:e(f),scoreData:t}),{leftHand:t.leftHand,rightHand:t.rightHand,selectedNote:o}}catch(t){return console.error("Error generating score data:",t),{selectedNote:"C",leftHand:[[]],rightHand:[["C4","E4","G4"]]}}}function _e(o,t){if(e(i).startsWith("rootless")){const n=new Set(o.map(s=>s%12)),c=new Set(t.map(s=>s%12));return n.size===c.size&&[...n].every(s=>c.has(s))}return o.length===t.length&&o.every(n=>t.includes(n))}function fe(){b(H,!1)}Ne(ae,{get randomMode(){return r.randomMode},generateExpectedNotes:le,generateScoreProps:ue,validateNoteEvent:ie,isCompleted:_e,onReset:fe,get onComplete(){return r.onComplete},get initialNote(){return e(se)},description:re,get progressiveHints(){return r.progressiveHints},get prompt(){return r.prompt},children:(t,n=Me)=>{const c=T(()=>e(H)),s=T(()=>n().completed);var R=Be(),q=F(R);{var ge=l=>{var d=ee();E(()=>S(d,b(H,!0))),y(l,d)},he=l=>{var d=be(),x=F(d);{var v=m=>{var C=ee();E(()=>S(C,b(H,!1))),y(m,C)};W(x,m=>{!e(s)&&e(c)&&m(v)},!0)}y(l,d)};W(q,l=>{e(s)&&!e(c)?l(ge):l(he,!1)})}var O=a(q,2),pe=p(O);{var me=l=>{var d=ke(),x=F(d),v=a(p(x),2);v.__change=ce,Re(v,21,()=>De,Ee,(Ce,k)=>{var M=Le(),ye=p(M,!0);u(M);var $={};E(()=>{S(ye,e(k)),$!==($=e(k))&&(M.value=(M.__value=e(k))??"")}),y(Ce,M)}),u(v);var m;j(v),u(x);var C=a(x,2),g=a(p(C),2);g.__change=ve;var N=p(g);N.value=N.__value=0;var I=a(N);I.value=I.__value=1;var P=a(I);P.value=P.__value=2;var Y=a(P);Y.value=Y.__value=3,u(g);var Z;j(g),u(C);var J=a(C,2),h=a(p(J),2);h.__change=de;var V=p(h);V.value=V.__value="full-right";var w=a(V);w.value=w.__value="full-left";var A=a(w);A.value=A.__value="1735";var D=a(A);D.value=D.__value="1537";var L=a(D);L.value=L.__value="rootless-a";var Q=a(L);Q.value=Q.__value="rootless-b",u(h);var X;j(h),u(J),E(()=>{m!==(m=e(_))&&(v.value=(v.__value=e(_))??"",z(v,e(_))),Z!==(Z=e(f))&&(g.value=(g.__value=e(f))??"",z(g,e(f))),X!==(X=e(i))&&(h.value=(h.__value=e(i))??"",z(h,e(i)))}),y(l,d)};W(pe,l=>{!r.randomMode&&!G.url.searchParams.get("unitId")&&l(me)})}u(O),y(t,R)},$$slots:{default:!0}}),Te()}He(["change"]);export{Oe as component};
