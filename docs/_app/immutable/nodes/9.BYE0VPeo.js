import"../chunks/NZTpNUN0.js";import{p as xe,N as j,O as le,g as Me,k as e,f as y,b as C,c as be,d as m,P as Ie,Q as D,a as J,s as n,t as F,R as I,W as we,r as f,S as ie,T as Ne}from"../chunks/DekTh3_k.js";import{d as Pe,s as k}from"../chunks/BEn0398A.js";import{i as B}from"../chunks/De59rqUo.js";import{A as ce,e as Te,M as G,N as M,D as b,i as Ve}from"../chunks/BcYS4v02.js";import{i as ve,s as de,a as Ee}from"../chunks/9bBOD8_0.js";import{p as Fe}from"../chunks/CbvXJoCI.js";import{B as ye,b as Ae,c as X}from"../chunks/Bq00vTX4.js";function Le(w,l,N){const g=w.target;I(l,parseInt(g.value),!0),N()}function je(w,l,N){const g=w.target;I(l,g.value,!0),N()}var De=y('<div class="control-group svelte-1qz769a"><label for="inversion" class="svelte-1qz769a">Inversion:</label> <select id="inversion" class="svelte-1qz769a"><option class="svelte-1qz769a">Root</option><option class="svelte-1qz769a">1st</option><option class="svelte-1qz769a">2nd</option><option class="svelte-1qz769a">3rd</option></select></div> <div class="control-group svelte-1qz769a"><label for="voicing" class="svelte-1qz769a">Voicing:</label> <select id="voicing" class="svelte-1qz769a"><option class="svelte-1qz769a">Full Right Hand</option><option class="svelte-1qz769a">Full Left Hand</option><option class="svelte-1qz769a">1 & 7 Left / 3 & 5 Right</option><option class="svelte-1qz769a">1 & 5 Left / 3 & 7 Right</option></select></div>',1),ke=y("<div> </div>"),Be=y('<div class="completion svelte-1qz769a">ðŸŽ‰ ii-V-I Completed!</div>'),Ge=y('<!> <div class="progression-controls svelte-1qz769a"><!> <div class="chord-progress svelte-1qz769a"></div></div> <div class="exercise-status svelte-1qz769a"><div class="current-chord svelte-1qz769a"> </div> <!></div>',1),He=y('<div class="progression-exercise svelte-1qz769a"><!></div>');function Ye(w,l){xe(l,!0);const N="Play the II-V-I progression as shown. Use the correct chords and voicings for each step.";let g=Fe(l,"randomMode",3,!1),i=j(0),q=j(le(l.inversion??(g()?Math.floor(Math.random()*4):0))),P=j(le(l.voicing??(g()?ce[Math.floor(Math.random()*ce.length)]:"full-right"))),T=j(!1);function ue(){A(),I(T,!1)}Me(()=>{e(T)&&l.onComplete&&l.onComplete()});function A(){I(i,0)}function Y(t){const o=M[t+b]+2,a=M[t+b]+7,_=M[t+b],c=X(o,"min7",e(q)),z=X(a,"7",e(q)),x=X(_,"maj7",e(q));return[c,z,x][e(i)]}function fe(t){const o=Y(t);return[o.root,o.third,o.fifth,o.seventh].filter(a=>a!=null)}function _e(t,o,a,_){const c=L(t)[e(i)];if(a.includes(o.noteNumber)){const d=_.filter(O=>a.includes(O)).length,V=a.length;return d===V?e(i)<2?(setTimeout(()=>{we(i)},1e3),{isCorrect:!0,message:Z(),collected:!0,resetCollected:!1}):{isCorrect:!0,message:Z(),collected:!0,resetCollected:!1}:{isCorrect:!0,message:`Good! ${d}/${V} notes for ${c}`,collected:!0,resetCollected:!1}}const x=a.filter(d=>!_.includes(d)).map(d=>G[d].slice(0,-1)).join(", ");return{isCorrect:!1,message:`Wrong note. For ${c} expected: ${x}`,collected:!1,resetCollected:!0}}function me(t,o){if(o.length===0)return!1;const c=t.filter(z=>o.includes(z)).length===o.length&&e(i)===2;return c&&setTimeout(()=>{A()},2e3),c}function L(t="C"){const o=M[t+b]+2,a=M[t+b]+7,_=M[t+b];return[`${G[o].slice(0,-1)}m7`,`${G[a].slice(0,-1)}7`,`${G[_].slice(0,-1)}maj7`]}function Z(){return e(i)<2?`Great! Now play ${L()[e(i)+1]}`:"Perfect! Complete ii-V-I progression! ðŸŽµâœ¨"}function ge(t){const o=Y(t);return{...Ae(o,e(P)),selectedNote:t}}var H=He(),he=m(H);{const t=(_,c=Ie)=>{var z=Ge();const x=D(()=>e(T)),d=D(()=>c().completed);var V=J(z);{var O=r=>{var v=ie();F(()=>k(v,I(T,!0))),C(r,v)},pe=r=>{var v=Ne(),h=J(v);{var s=u=>{var p=ie();F(()=>k(p,I(T,!1))),C(u,p)};B(h,u=>{!e(d)&&e(x)&&u(s)},!0)}C(r,v)};B(V,r=>{e(d)&&!e(x)?r(O):r(pe,!1)})}var S=n(V,2),$=m(S);{var Ce=r=>{var v=De(),h=J(v),s=n(m(h),2);s.__change=[Le,q,A];var u=m(s);u.value=u.__value=0;var p=n(u);p.value=p.__value=1;var E=n(p);E.value=E.__value=2;var oe=n(E);oe.value=oe.__value=3,f(s);var re;ve(s),f(h);var se=n(h,2),R=n(m(se),2);R.__change=[je,P,A];var W=m(R);W.value=W.__value="full-right";var K=n(W);K.value=K.__value="full-left";var Q=n(K);Q.value=Q.__value="1735";var ae=n(Q);ae.value=ae.__value="1537",f(R);var ne;ve(R),f(se),F(()=>{re!==(re=e(q))&&(s.value=(s.__value=e(q))??"",de(s,e(q))),ne!==(ne=e(P))&&(R.value=(R.__value=e(P))??"",de(R,e(P)))}),C(r,v)};B($,r=>{g()||r(Ce)})}var ee=n($,2);Te(ee,21,()=>L(c().selectedNote),Ve,(r,v,h)=>{var s=ke();let u;var p=m(s,!0);f(s),F(E=>{u=Ee(s,1,"chord-indicator svelte-1qz769a",null,u,E),k(p,e(v))},[()=>({active:h===e(i),completed:h<e(i)})]),C(r,s)}),f(ee),f(S);var te=n(S,2),U=m(te),qe=m(U);f(U);var ze=n(U,2);{var Re=r=>{var v=Be();C(r,v)};B(ze,r=>{c().completed&&r(Re)})}f(te),F(r=>k(qe,`Current: ${r??""} (${e(i)+1}/3)`),[()=>L(c().selectedNote)[e(i)]]),C(_,z)};let o=D(()=>l.onComplete||(()=>{})),a=D(()=>l.rootKey||"C");ye(he,{get randomMode(){return g()},generateExpectedNotes:fe,generateScoreProps:ge,validateNoteEvent:_e,isCompleted:me,onReset:ue,get onComplete(){return e(o)},get initialNote(){return e(a)},description:N,children:t,$$slots:{default:!0}})}f(H),C(w,H),be()}Pe(["change"]);export{Ye as component};
