import{c as ae,a as b,f as N}from"../chunks/CFIxE8eA.js";import{o as Te,a as Ne}from"../chunks/DkZ4bG6r.js";import{x as Ee,I as Se,b1 as Ve,b as Ae,p as ge,f as oe,a as ue,c as l,s as c,k as e,r as t,t as U,U as C,V as R,Z as x,Y as ce,X as de}from"../chunks/jpeKWS-T.js";import{d as he,s as K}from"../chunks/CMZx5vTi.js";import{i as Z}from"../chunks/etsv1dl2.js";import{B as Pe}from"../chunks/BzK2yrzK.js";import"../chunks/TXQ6eOlp.js";import{c as He,B as Ue}from"../chunks/Cka3GhAH.js";import{A as Ke,b as Oe,c as je,d as fe,e as _e,N as ve,f as qe,D as pe,M as ze}from"../chunks/CXrKfc7O.js";import{e as F,i as W}from"../chunks/C5dV_Rsv.js";import{r as X,h as Y}from"../chunks/DEwekSJk.js";import{component as Be}from"./6.Cgm9AlZn.js";import{component as De}from"./14.CMpLDsDJ.js";import{component as Ge}from"./16.CbwKOZRT.js";function Le(J,v,w){Ee&&Se();var E=new Pe(J),M=!Ve();Ae(()=>{var I=v();M&&I!==null&&typeof I=="object"&&(I={}),E.ensure(I,w)})}const Re=["chord","scale","II-V-I","note","interval","partition","progression","rhythm"];var Fe=N('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),We=N('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Xe=N('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Ye=N('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Ze=N('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Je=N('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Qe=N('<div class="popup-overlay svelte-pgit1g" role="dialog" aria-modal="true" aria-label="Configure exercises" tabindex="0"><div class="popup-content svelte-pgit1g"><button type="button" class="close-btn svelte-pgit1g" aria-label="Close">√ó</button> <h2 class="svelte-pgit1g">Exercise Configuration</h2> <div class="config-grid svelte-pgit1g"><div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Exercise Types</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Notes</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Chord Types</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Inversions</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Scale Modes</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Voicings</h3> <div class="checkbox-grid svelte-pgit1g"></div></div></div></div></div>');function $e(J,v){ge(v,!0);function w(_,k,s){let h=[];switch(_){case"allowedExerciseTypes":h=[...v.allowedExerciseTypes];break;case"allowedNotes":h=[...v.allowedNotes];break;case"allowedChordTypes":h=[...v.allowedChordTypes];break;case"allowedInversions":h=[...v.allowedInversions];break;case"allowedScaleModes":h=[...v.allowedScaleModes];break;case"allowedVoicings":h=[...v.allowedVoicings];break}if(s)h.push(k);else if(h.length>1){const S=h.indexOf(k);S>-1&&h.splice(S,1)}v.onUpdate(_,h.sort())}function E(_){(_ instanceof MouseEvent&&_.target.classList.contains("popup-overlay")||_ instanceof KeyboardEvent&&_.key==="Escape")&&v.onClose()}var M=ae(),I=oe(M);{var A=_=>{var k=Qe();k.__click=u=>E(u),k.__keydown=u=>E(u);var s=l(k),h=l(s);h.__click=()=>v.onClose();var S=c(h,4),q=l(S),P=c(l(q),2);F(P,21,()=>Re,W,(u,r)=>{var i=Fe(),a=l(i);X(a),a.__change=n=>w("allowedExerciseTypes",e(r),n.currentTarget.checked);var g=c(a,2),y=l(g,!0);t(g),t(i),U((n,ee)=>{Y(a,n),K(y,ee)},[()=>v.allowedExerciseTypes.includes(e(r)),()=>e(r).charAt(0).toUpperCase()+e(r).slice(1)]),b(u,i)}),t(P),t(q);var T=c(q,2),O=c(l(T),2);F(O,21,()=>Ke,W,(u,r)=>{var i=We(),a=l(i);X(a),a.__change=n=>w("allowedNotes",e(r),n.currentTarget.checked);var g=c(a,2),y=l(g,!0);t(g),t(i),U(n=>{Y(a,n),K(y,e(r))},[()=>v.allowedNotes.includes(e(r))]),b(u,i)}),t(O),t(T);var H=c(T,2),re=c(l(H),2);F(re,21,()=>Oe,W,(u,r)=>{var i=Xe(),a=l(i);X(a),a.__change=n=>w("allowedChordTypes",e(r),n.currentTarget.checked);var g=c(a,2),y=l(g,!0);t(g),t(i),U(n=>{Y(a,n),K(y,e(r))},[()=>v.allowedChordTypes.includes(e(r))]),b(u,i)}),t(re),t(H);var Q=c(H,2),z=c(l(Q),2);F(z,21,()=>je,W,(u,r)=>{var i=Ye(),a=l(i);X(a),a.__change=n=>w("allowedInversions",e(r).toString(),n.currentTarget.checked);var g=c(a,2),y=l(g,!0);t(g),t(i),U(n=>{Y(a,n),K(y,e(r)===0?"Root":`${e(r)}${e(r)===1?"st":e(r)===2?"nd":"rd"}`)},[()=>v.allowedInversions.includes(e(r))]),b(u,i)}),t(z),t(Q);var j=c(Q,2),B=c(l(j),2);F(B,21,()=>fe,W,(u,r)=>{var i=Ze(),a=l(i);X(a),a.__change=n=>w("allowedScaleModes",e(r),n.currentTarget.checked);var g=c(a,2),y=l(g,!0);t(g),t(i),U(n=>{Y(a,n),K(y,e(r))},[()=>v.allowedScaleModes.includes(e(r))]),b(u,i)}),t(B),t(j);var se=c(j,2),$=c(l(se),2);F($,21,()=>_e,W,(u,r)=>{var i=Je(),a=l(i);X(a),a.__change=n=>w("allowedVoicings",e(r),n.currentTarget.checked);var g=c(a,2),y=l(g,!0);t(g),t(i),U((n,ee)=>{Y(a,n),K(y,ee)},[()=>v.allowedVoicings.includes(e(r)),()=>e(r).charAt(0).toUpperCase()+e(r).slice(1)]),b(u,i)}),t($),t(se),t(S),t(s),t(k),b(_,k)};Z(I,_=>{v.showPopup&&_(A)})}b(J,M),ue()}he(["click","keydown","change"]);var et=N('<div class="completion-overlay svelte-1a0o1e6"><div class="completion-message svelte-1a0o1e6"><h2 class="svelte-1a0o1e6">üéâ Correct!</h2> <p> </p> <button class="skip-btn svelte-1a0o1e6">Skip</button></div></div>'),tt=N('<div class="loading svelte-1a0o1e6">Generating...</div>'),at=N('<div class="flashcards-container svelte-1a0o1e6"><div class="header svelte-1a0o1e6"><div class="progress svelte-1a0o1e6"> </div> <div class="controls svelte-1a0o1e6"><button class="config-btn svelte-1a0o1e6">‚öôÔ∏è Config</button> <button class="new-btn svelte-1a0o1e6">üé≤ New Card</button></div></div> <!> <!> <!></div>');function _t(J,v){ge(v,!0);let w=C(R(["C","F","G"])),E=C(R(["maj7","min7","7","major","minor"])),M=C(R([0,1,2,3])),I=C(R(fe)),A=C(R(_e)),_=C(R(["note","interval","chord","scale","II-V-I"])),k=C(!1),s=C(null),h=C(0),S=C(!1),q=C(0),P=C(0),T=null;function O(){const p=e(_)[Math.floor(Math.random()*e(_).length)],o=e(w)[Math.floor(Math.random()*e(w).length)];let f;if(p==="note"){const d=ve[`${o}${pe}`];f={type:"note",prompt:o,subtext:"Play the note",expectedNotes:[d]}}else if(p==="interval"){const d=Object.keys(qe),m=d[Math.floor(Math.random()*d.length)],V=ve[`${o}${pe}`],te=He(o,m);f={type:"interval",prompt:`${o} + ${m}`,subtext:"Play the interval",expectedNotes:[V,te]}}else if(p==="chord"){const d=e(E)[Math.floor(Math.random()*e(E).length)],m=e(M)[Math.floor(Math.random()*e(M).length)],V=e(A)[Math.floor(Math.random()*e(A).length)];f={type:"chord",prompt:`${o} ${d}`,subtext:"Play the chord",expectedNotes:[],config:{chordType:d,inversion:m,voicing:V,root:o}}}else if(p==="scale"){const d=e(I)[Math.floor(Math.random()*e(I).length)];f={type:"scale",prompt:`${o} ${d} Scale`,subtext:"Play the scale",expectedNotes:[],config:{mode:d,root:o}}}else{const d=e(M)[Math.floor(Math.random()*e(M).length)],m=e(A)[Math.floor(Math.random()*e(A).length)];f={type:"II-V-I",prompt:`${o} II-V-I`,subtext:"Play the progression",expectedNotes:[],config:{inversion:d,voicing:m,root:o}}}x(s,f,!0),x(h,Date.now(),!0),x(S,!1),T&&clearInterval(T),x(P,0)}function H(){x(S,!0),ce(q),x(P,3),T=setInterval(()=>{ce(P,-1),e(P)<=0&&(T&&clearInterval(T),O())},1e3)}Te(()=>{O()}),Ne(()=>{T&&clearInterval(T)});function re(p,o,f,d){if(f.includes(o.noteNumber)){const m=d.filter(le=>f.includes(le)),V=new Set(m),te=new Set(f);return V.size===te.size?{isCorrect:!0,message:"Correct!",collected:!0,resetCollected:!1}:{isCorrect:!0,message:"Good note...",collected:!0,resetCollected:!1}}return{isCorrect:!1,message:"Wrong note",collected:!1,resetCollected:!0}}function Q(p,o){const f=new Set(p.filter(m=>o.includes(m))),d=new Set(o);return f.size===d.size}var z=at(),j=l(z),B=l(j),se=l(B);t(B);var $=c(B,2),u=l($);u.__click=()=>x(k,!0);var r=c(u,2);r.__click=O,t($),t(j);var i=c(j,2);$e(i,{get showPopup(){return e(k)},get allowedNotes(){return e(w)},get allowedChordTypes(){return e(E)},get allowedInversions(){return e(M)},get allowedScaleModes(){return e(I)},get allowedVoicings(){return e(A)},get allowedExerciseTypes(){return e(_)},onClose:()=>x(k,!1),onUpdate:(p,o)=>{switch(p){case"allowedNotes":x(w,o,!0);break;case"allowedChordTypes":x(E,o,!0);break;case"allowedInversions":x(M,o.map(Number),!0);break;case"allowedScaleModes":x(I,o,!0);break;case"allowedVoicings":x(A,o,!0);break;case"allowedExerciseTypes":x(_,o,!0);break}}});var a=c(i,2);{var g=p=>{var o=et(),f=l(o),d=c(l(f),2),m=l(d);t(d);var V=c(d,2);V.__click=O,t(f),t(o),U(()=>K(m,`Next card in ${e(P)??""}...`)),b(p,o)};Z(a,p=>{e(S)&&p(g)})}var y=c(a,2);{var n=p=>{var o=ae(),f=oe(o);Le(f,()=>e(h),d=>{var m=ae(),V=oe(m);{var te=D=>{Be(D,{randomMode:!0,onComplete:H,get chordType(){return e(s).config.chordType},get inversion(){return e(s).config.inversion},get voicing(){return e(s).config.voicing},get rootKey(){return e(s).config.root},progressiveHints:!0,get prompt(){return e(s).prompt}})},le=D=>{var ie=ae(),me=oe(ie);{var be=G=>{De(G,{randomMode:!0,onComplete:H,get scaleMode(){return e(s).config.mode},get rootKey(){return e(s).config.root},progressiveHints:!0,get prompt(){return e(s).prompt}})},xe=G=>{var ne=ae(),we=oe(ne);{var ye=L=>{Ge(L,{randomMode:!0,onComplete:H,get inversion(){return e(s).config.inversion},get voicing(){return e(s).config.voicing},get rootKey(){return e(s).config.root},progressiveHints:!0,get prompt(){return e(s).prompt}})},ke=L=>{{let Ce=de(()=>e(s).prompt.split(" ")[0]),Me=de(()=>e(s).subtext??"");Ue(L,{randomMode:!0,generateExpectedNotes:()=>e(s).expectedNotes,generateScoreProps:()=>({selectedNote:e(s).prompt.split(" ")[0],leftHand:[],rightHand:[e(s).expectedNotes.map(Ie=>ze[Ie])]}),validateNoteEvent:re,isCompleted:Q,onComplete:H,get initialNote(){return e(Ce)},get description(){return e(Me)},exerciseType:"chord",progressiveHints:!0,onReset:()=>{},get prompt(){return e(s).prompt}})}};Z(we,L=>{e(s).type==="II-V-I"?L(ye):L(ke,!1)},!0)}b(G,ne)};Z(me,G=>{e(s).type==="scale"?G(be):G(xe,!1)},!0)}b(D,ie)};Z(V,D=>{e(s).type==="chord"?D(te):D(le,!1)})}b(d,m)}),b(p,o)},ee=p=>{var o=tt();b(p,o)};Z(y,p=>{e(s)?p(n):p(ee,!1)})}t(z),U(()=>K(se,`Cards: ${e(q)??""} / 10`)),b(J,z),ue()}he(["click"]);export{_t as component};
