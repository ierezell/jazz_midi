import{c as $,a as m,f as N}from"../chunks/Dh1Z6ki8.js";import{o as Me,a as Te}from"../chunks/Cj0Ip7jH.js";import{w as Ie,I as Ne,b2 as Ee,b as Se,p as de,f as ee,a as ve,c as n,s as c,k as e,r as s,t as H,U as y,V as G,Z as k,X as Ve,Y as re}from"../chunks/DRD-yT8e.js";import{d as ge,s as O}from"../chunks/Chq1SuiK.js";import{i as te}from"../chunks/J_yv6X8T.js";import{B as Ae}from"../chunks/HqejFRXJ.js";import{c as Pe,B as He}from"../chunks/BV0_FfjC.js";import{A as Oe,b as Ue,c as je,d as pe,e as ue,N as ne,f as ze,D as ce,M as Ke}from"../chunks/CXrKfc7O.js";import{e as L,i as R}from"../chunks/CBGogYsa.js";import{r as F,g as W}from"../chunks/BsbaTnXO.js";import{component as qe}from"./6.mrswdWaL.js";import{component as Be}from"./13.ZpxwiQZv.js";import{component as De}from"./15.BQo1xAKx.js";function Ge(X,d,_){Ie&&Ne();var I=new Ae(X),C=!Ee();Se(()=>{var M=d();C&&M!==null&&typeof M=="object"&&(M={}),I.ensure(M,_)})}const Le=!1,ht=Object.freeze(Object.defineProperty({__proto__:null,ssr:Le},Symbol.toStringTag,{value:"Module"})),Re=["chord","scale","II-V-I","note","interval","partition","progression","rhythm"];var Fe=N('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),We=N('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Xe=N('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Ye=N('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Ze=N('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Je=N('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Qe=N('<div class="popup-overlay svelte-pgit1g" role="dialog" aria-modal="true" aria-label="Configure exercises" tabindex="0"><div class="popup-content svelte-pgit1g"><button type="button" class="close-btn svelte-pgit1g" aria-label="Close">√ó</button> <h2 class="svelte-pgit1g">Exercise Configuration</h2> <div class="config-grid svelte-pgit1g"><div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Exercise Types</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Notes</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Chord Types</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Inversions</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Scale Modes</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Voicings</h3> <div class="checkbox-grid svelte-pgit1g"></div></div></div></div></div>');function $e(X,d){de(d,!0);function _(h,w,l){let u=[];switch(h){case"allowedExerciseTypes":u=[...d.allowedExerciseTypes];break;case"allowedNotes":u=[...d.allowedNotes];break;case"allowedChordTypes":u=[...d.allowedChordTypes];break;case"allowedInversions":u=[...d.allowedInversions];break;case"allowedScaleModes":u=[...d.allowedScaleModes];break;case"allowedVoicings":u=[...d.allowedVoicings];break}if(l)u.push(w);else if(u.length>1){const V=u.indexOf(w);V>-1&&u.splice(V,1)}d.onUpdate(h,u.sort())}function I(h){(h instanceof MouseEvent&&h.target.classList.contains("popup-overlay")||h instanceof KeyboardEvent&&h.key==="Escape")&&d.onClose()}var C=$(),M=ee(C);{var E=h=>{var w=Qe();w.__click=g=>I(g),w.__keydown=g=>I(g);var l=n(w),u=n(l);u.__click=()=>d.onClose();var V=c(u,4),U=n(V),T=c(n(U),2);L(T,21,()=>Re,R,(g,r)=>{var i=Fe(),o=n(i);F(o),o.__change=t=>_("allowedExerciseTypes",e(r),t.currentTarget.checked);var v=c(o,2),b=n(v,!0);s(v),s(i),H((t,a)=>{W(o,t),O(b,a)},[()=>d.allowedExerciseTypes.includes(e(r)),()=>e(r).charAt(0).toUpperCase()+e(r).slice(1)]),m(g,i)}),s(T),s(U);var Y=c(U,2),j=c(n(Y),2);L(j,21,()=>Oe,R,(g,r)=>{var i=We(),o=n(i);F(o),o.__change=t=>_("allowedNotes",e(r),t.currentTarget.checked);var v=c(o,2),b=n(v,!0);s(v),s(i),H(t=>{W(o,t),O(b,e(r))},[()=>d.allowedNotes.includes(e(r))]),m(g,i)}),s(j),s(Y);var S=c(Y,2),ae=c(n(S),2);L(ae,21,()=>Ue,R,(g,r)=>{var i=Xe(),o=n(i);F(o),o.__change=t=>_("allowedChordTypes",e(r),t.currentTarget.checked);var v=c(o,2),b=n(v,!0);s(v),s(i),H(t=>{W(o,t),O(b,e(r))},[()=>d.allowedChordTypes.includes(e(r))]),m(g,i)}),s(ae),s(S);var Z=c(S,2),z=c(n(Z),2);L(z,21,()=>je,R,(g,r)=>{var i=Ye(),o=n(i);F(o),o.__change=t=>_("allowedInversions",e(r).toString(),t.currentTarget.checked);var v=c(o,2),b=n(v,!0);s(v),s(i),H(t=>{W(o,t),O(b,e(r)===0?"Root":`${e(r)}${e(r)===1?"st":e(r)===2?"nd":"rd"}`)},[()=>d.allowedInversions.includes(e(r))]),m(g,i)}),s(z),s(Z);var A=c(Z,2),K=c(n(A),2);L(K,21,()=>pe,R,(g,r)=>{var i=Ze(),o=n(i);F(o),o.__change=t=>_("allowedScaleModes",e(r),t.currentTarget.checked);var v=c(o,2),b=n(v,!0);s(v),s(i),H(t=>{W(o,t),O(b,e(r))},[()=>d.allowedScaleModes.includes(e(r))]),m(g,i)}),s(K),s(A);var oe=c(A,2),J=c(n(oe),2);L(J,21,()=>ue,R,(g,r)=>{var i=Je(),o=n(i);F(o),o.__change=t=>_("allowedVoicings",e(r),t.currentTarget.checked);var v=c(o,2),b=n(v,!0);s(v),s(i),H((t,a)=>{W(o,t),O(b,a)},[()=>d.allowedVoicings.includes(e(r)),()=>e(r).charAt(0).toUpperCase()+e(r).slice(1)]),m(g,i)}),s(J),s(oe),s(V),s(l),s(w),m(h,w)};te(M,h=>{d.showPopup&&h(E)})}m(X,C),ve()}ge(["click","keydown","change"]);var et=N('<div class="loading svelte-1a0o1e6">Generating...</div>'),tt=N('<div class="flashcards-container svelte-1a0o1e6"><div class="header svelte-1a0o1e6"><div class="progress svelte-1a0o1e6"> </div> <div class="controls svelte-1a0o1e6"><button class="config-btn svelte-1a0o1e6">‚öôÔ∏è Config</button> <button class="new-btn svelte-1a0o1e6">üé≤ New Card</button></div></div> <!> <!></div>');function ft(X,d){de(d,!0);let _=y(G(["C","F","G"])),I=y(G(["maj7","min7","7","major","minor"])),C=y(G([0,1,2,3])),M=y(G(pe)),E=y(G(ue)),h=y(G(["note","interval","chord","scale","II-V-I"])),w=y(!1),l=y(null),u=y(0),V=y(!1),U=y(0),T=null,Y=y(0);function j(){const t=e(h)[Math.floor(Math.random()*e(h).length)],a=e(_)[Math.floor(Math.random()*e(_).length)];let f;if(t==="note"){const p=ne[`${a}${ce}`];f={type:"note",prompt:a,subtext:"Play the note",expectedNotes:[p]}}else if(t==="interval"){const p=Object.keys(ze),x=p[Math.floor(Math.random()*p.length)],P=ne[`${a}${ce}`],Q=Pe(a,x);f={type:"interval",prompt:`${a} + ${x}`,subtext:"Play the interval",expectedNotes:[P,Q]}}else if(t==="chord"){const p=e(I)[Math.floor(Math.random()*e(I).length)],x=e(C)[Math.floor(Math.random()*e(C).length)],P=e(E)[Math.floor(Math.random()*e(E).length)];f={type:"chord",prompt:`${a} ${p}`,subtext:"Play the chord",expectedNotes:[],config:{chordType:p,inversion:x,voicing:P,root:a}}}else if(t==="scale"){const p=e(M)[Math.floor(Math.random()*e(M).length)];f={type:"scale",prompt:`${a} ${p} Scale`,subtext:"Play the scale",expectedNotes:[],config:{mode:p,root:a}}}else{const p=e(C)[Math.floor(Math.random()*e(C).length)],x=e(E)[Math.floor(Math.random()*e(E).length)];f={type:"II-V-I",prompt:`${a} II-V-I`,subtext:"Play the progression",expectedNotes:[],config:{inversion:p,voicing:x,root:a}}}k(l,f,!0),k(u,Date.now(),!0),k(V,!1),T&&clearTimeout(T),k(Y,0)}function S(){Ve(U),T&&clearTimeout(T),T=setTimeout(()=>{j()},1e3)}Me(()=>{j()}),Te(()=>{T&&clearTimeout(T)});function ae(t,a,f,p){if(f.includes(a.noteNumber)){const x=p.filter(se=>f.includes(se)),P=new Set(x),Q=new Set(f);return P.size===Q.size?{isCorrect:!0,message:"Correct!",collected:!0,resetCollected:!1}:{isCorrect:!0,message:"Good note...",collected:!0,resetCollected:!1}}return{isCorrect:!1,message:"Wrong note",collected:!1,resetCollected:!0}}function Z(t,a){const f=new Set(t.filter(x=>a.includes(x))),p=new Set(a);return f.size===p.size}var z=tt(),A=n(z),K=n(A),oe=n(K);s(K);var J=c(K,2),g=n(J);g.__click=()=>k(w,!0);var r=c(g,2);r.__click=j,s(J),s(A);var i=c(A,2);$e(i,{get showPopup(){return e(w)},get allowedNotes(){return e(_)},get allowedChordTypes(){return e(I)},get allowedInversions(){return e(C)},get allowedScaleModes(){return e(M)},get allowedVoicings(){return e(E)},get allowedExerciseTypes(){return e(h)},onClose:()=>k(w,!1),onUpdate:(t,a)=>{switch(t){case"allowedNotes":k(_,a,!0);break;case"allowedChordTypes":k(I,a,!0);break;case"allowedInversions":k(C,a.map(Number),!0);break;case"allowedScaleModes":k(M,a,!0);break;case"allowedVoicings":k(E,a,!0);break;case"allowedExerciseTypes":k(h,a,!0);break}}});var o=c(i,2);{var v=t=>{var a=$(),f=ee(a);Ge(f,()=>e(u),p=>{var x=$(),P=ee(x);{var Q=q=>{qe(q,{randomMode:!0,onComplete:S,get chordType(){return e(l).config.chordType},get inversion(){return e(l).config.inversion},get voicing(){return e(l).config.voicing},get rootKey(){return e(l).config.root},progressiveHints:!0,get prompt(){return e(l).prompt}})},se=q=>{var le=$(),he=ee(le);{var fe=B=>{Be(B,{randomMode:!0,onComplete:S,get scaleMode(){return e(l).config.mode},get rootKey(){return e(l).config.root},progressiveHints:!0,get prompt(){return e(l).prompt}})},me=B=>{var ie=$(),_e=ee(ie);{var be=D=>{De(D,{randomMode:!0,onComplete:S,get inversion(){return e(l).config.inversion},get voicing(){return e(l).config.voicing},get rootKey(){return e(l).config.root},progressiveHints:!0,get prompt(){return e(l).prompt}})},xe=D=>{{let we=re(()=>e(l).prompt.split(" ")[0]),ye=re(()=>e(l).subtext??""),ke=re(()=>e(l).type==="note"?"note":"interval");He(D,{randomMode:!0,generateExpectedNotes:()=>e(l).expectedNotes,generateScoreProps:()=>({selectedNote:e(l).prompt.split(" ")[0],leftHand:[],rightHand:[e(l).expectedNotes.map(Ce=>Ke[Ce])]}),validateNoteEvent:ae,isCompleted:Z,onComplete:S,get initialNote(){return e(we)},get description(){return e(ye)},get exerciseType(){return e(ke)},progressiveHints:!0,onReset:()=>{},get prompt(){return e(l).prompt}})}};te(_e,D=>{e(l).type==="II-V-I"?D(be):D(xe,!1)},!0)}m(B,ie)};te(he,B=>{e(l).type==="scale"?B(fe):B(me,!1)},!0)}m(q,le)};te(P,q=>{e(l).type==="chord"?q(Q):q(se,!1)})}m(p,x)}),m(t,a)},b=t=>{var a=et();m(t,a)};te(o,t=>{e(l)?t(v):t(b,!1)})}s(z),H(()=>O(oe,`Cards: ${e(U)??""} / 10`)),m(X,z),ve()}ge(["click"]);export{ft as component,ht as universal};
