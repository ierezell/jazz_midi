import{f as L,a as z}from"../chunks/CGs25f5Q.js";import{a as ue}from"../chunks/DuGQJ7ph.js";import{p as fe,W as me,Z as c,a as ve,k as e,U as x,s as v,c as r,t as G,X as pe,r as l}from"../chunks/CPN3W99e.js";import{d as he,s as _}from"../chunks/Cf1jdkyt.js";import{i as be}from"../chunks/CO7pLaZ9.js";import{a as B,r as xe}from"../chunks/CZv5_2PD.js";import{a as _e}from"../chunks/DNtVZOVd.js";import{B as ge}from"../chunks/BvxIlnQz.js";var ye=L('<div><span class="feedback-text svelte-14dx2m1"> </span> <span class="diff-text svelte-14dx2m1"> </span></div>'),Me=L('<div class="rhythm-container svelte-14dx2m1"><h2>Rhythm Training</h2> <div class="controls svelte-14dx2m1"><button> </button> <div class="bpm-control svelte-14dx2m1"><label for="bpm"> </label> <input id="bpm" type="range" min="40" max="200"/></div></div> <div class="visualizer svelte-14dx2m1"><div>ðŸŽµ</div> <!></div> <div class="stats"><p> </p></div></div>');function Be(Q,U){fe(U,!0);let g=x(60),d=x(!1),w=x(0),n=x(null),y=x(""),t=null,M=0,C=null,X=25,Z=.1,h=0,b=[];const j=.15;function F(){const o=60/e(g);M+=o,h++,h===4&&(h=0)}function J(o,f){if(b.push({note:o,time:f}),!t)return;const p=t.createOscillator(),i=t.createGain();p.connect(i),i.connect(t.destination),p.frequency.value=o===0?880:440,i.gain.value=.5,p.start(f),p.stop(f+.05)}function I(){if(t){for(;M<t.currentTime+Z;)J(h,M),F();C=window.setTimeout(I,X)}}function K(){e(d)||(t||(t=new AudioContext),c(d,!0),h=0,M=t.currentTime+.1,I())}function $(){c(d,!1),C&&(window.clearTimeout(C),C=null),b=[],c(n,null),c(y,"")}function V(){e(d)?$():K()}function Y(o){return[60]}function ee(o){return{selectedNote:o,leftHand:[],rightHand:[]}}function te(o,f,p){if(!e(d)||!t)return{isCorrect:!1,message:"Start the metronome first!",collected:!1,resetCollected:!1};const i=t.currentTime;let s=1/0;b=b.filter(a=>a.time>i-1);for(const a of b){const N=a.time-i;Math.abs(N)<Math.abs(s)&&(s=N,a.time)}const u=Math.abs(s);if(c(n,s*1e3),u<=j){let a="Perfect!";return u>.05&&(a=s>0?"Early":"Late"),c(y,a,!0),pe(w),{isCorrect:!0,message:`${a} (${Math.round(s*1e3)}ms)`,collected:!0,resetCollected:!0}}else return c(y,"Miss"),{isCorrect:!1,message:`Missed! (${Math.round(s*1e3)}ms)`,collected:!1,resetCollected:!1}}function se(o,f){return!1}ue(()=>{$(),t&&t.close()}),ge(Q,{randomMode:!1,generateExpectedNotes:Y,generateScoreProps:ee,validateNoteEvent:te,isCompleted:se,onReset:()=>{c(w,0),$()},onComplete:()=>{},initialNote:"C",description:"Play any note on the beat. Try to be as precise as possible!",showScore:!1,exerciseType:"rhythm",children:(f,p=me)=>{var i=Me(),s=v(r(i),2),u=r(s);let a;u.__click=V;var N=r(u,!0);l(u);var S=v(u,2),k=r(S),ae=r(k);l(k);var E=v(k,2);xe(E),l(S),l(s);var P=v(s,2),H=r(P);let W;var re=v(H,2);{var le=m=>{var T=ye();let R;var D=r(T),oe=r(D,!0);l(D);var q=v(D,2),ie=r(q);l(q),l(T),G((ce,de)=>{R=B(T,1,"feedback-display svelte-14dx2m1",null,R,ce),_(oe,e(y)),_(ie,`${e(n)>0?"+":""}${de??""}ms`)},[()=>({success:Math.abs(e(n))<50,warn:Math.abs(e(n))>=50&&Math.abs(e(n))<150,error:Math.abs(e(n))>=150}),()=>Math.round(e(n))]),z(m,T)};be(re,m=>{e(n)!==null&&m(le)})}l(P);var A=v(P,2),O=r(A),ne=r(O);l(O),l(A),l(i),G(m=>{a=B(u,1,"play-btn svelte-14dx2m1",null,a,{playing:e(d)}),_(N,e(d)?"Stop":"Start"),_(ae,`BPM: ${e(g)??""}`),W=B(H,1,"beat-indicator svelte-14dx2m1",null,W,m),_(ne,`Hits: ${e(w)??""}`)},[()=>({pulse:e(d)&&Math.abs(e(n)||1e3)<100})]),_e(E,()=>e(g),m=>c(g,m)),z(f,i)},$$slots:{default:!0}}),ve()}he(["click"]);export{Be as component};
