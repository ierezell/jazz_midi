import"../chunks/NZTpNUN0.js";import{p as pe,aq as P,R as Z,g as fe,k as e,f as $,b as z,c as _e,aU as he,d as u,a as ee,s as n,t as E,ar as me,S as T,r as c,av as ge}from"../chunks/CopMHf-A.js";import{d as Ce,s as D}from"../chunks/BtHBiExd.js";import{i as G}from"../chunks/BZTAz8MF.js";import{b as te,e as qe,M as H,N as x,i as ze}from"../chunks/CJpwhoEZ.js";import{i as oe,f as re,b as xe}from"../chunks/D6jhRq7z.js";import{p as Me}from"../chunks/CVImFuel.js";import{B as be,a as Re,c as A}from"../chunks/CPdQYdRh.js";function Ie(M,p,f){const o=M.target;T(p,parseInt(o.value),!0),f()}function Ve(M,p,f){const o=M.target;T(p,o.value,!0),f()}var $e=$('<div class="control-group svelte-1qz769a"><label for="inversion" class="svelte-1qz769a">Inversion:</label> <select id="inversion" class="svelte-1qz769a"><option class="svelte-1qz769a">Root</option><option class="svelte-1qz769a">1st</option><option class="svelte-1qz769a">2nd</option><option class="svelte-1qz769a">3rd</option></select></div> <div class="control-group svelte-1qz769a"><label for="voicing" class="svelte-1qz769a">Voicing:</label> <select id="voicing" class="svelte-1qz769a"><option class="svelte-1qz769a">Full</option><option class="svelte-1qz769a">Left Hand</option><option class="svelte-1qz769a">Right Hand</option><option class="svelte-1qz769a">Split</option></select></div>',1),Pe=$("<div> </div>"),Ee=$('<div class="completion svelte-1qz769a">ðŸŽ‰ ii-V-I Completed!</div>'),Te=$('<!> <div class="progression-controls svelte-1qz769a"><!> <div class="chord-progress svelte-1qz769a"></div></div> <div class="exercise-status svelte-1qz769a"><div class="current-chord svelte-1qz769a"> </div> <!></div>',1),we=$('<div class="progression-exercise svelte-1qz769a"><!></div>');function Ge(M,p){pe(p,!0);let f=Me(p,"randomMode",3,!1),o=P(0),h=P(Z(f()?Math.floor(Math.random()*4):0)),b=P(Z(f()?te[Math.floor(Math.random()*te.length)]:"full")),w=P(!1);fe(()=>{e(w)&&p.onComplete&&p.onComplete()});function N(){T(o,0)}function L(r){const t=x[r+"4"]+2,s=x[r+"4"]+7,v=x[r+"4"],l=A(t,"min7",e(h)),_=A(s,"7",e(h)),m=A(v,"maj7",e(h));return[l,_,m][e(o)]}function se(r){const t=L(r);return[t.root,t.third,t.fifth,t.seventh].filter(s=>s!=null)}function ae(r,t,s,v){if(s.includes(t.noteNumber)){const l=v.filter(m=>s.includes(m)).length,_=s.length;return l===_?e(o)<2?(setTimeout(()=>{me(o)},1e3),{isCorrect:!0,message:U()}):{isCorrect:!0,message:U()}:{isCorrect:!0,message:`Good! ${l}/${_} notes for ${R(r)[e(o)]}`}}return{isCorrect:!1,message:`Wrong note! Expected: ${R()[e(o)]}`}}function ne(r,t){if(t.length===0)return!1;const l=r.filter(_=>t.includes(_)).length===t.length&&e(o)===2;return l&&setTimeout(()=>{N()},2e3),l}function R(r="C"){const t=x[r+"4"]+2,s=x[r+"4"]+7,v=x[r+"4"];return[`${H[t].slice(0,-1)}m7`,`${H[s].slice(0,-1)}7`,`${H[v].slice(0,-1)}maj7`]}function U(){return e(o)<2?`Great! Now play ${R()[e(o)+1]}`:"Perfect! Complete ii-V-I progression! ðŸŽµâœ¨"}function ie(r){const t=L(r);return{...Re(t,e(b)),selectedNote:r}}var j=we(),le=u(j);be(le,{exerciseTitle:"ii-V-I Progression",exerciseDescription:"Play each chord in sequence: ii7 - V7 - Imaj7",get randomMode(){return f()},generateExpectedNotes:se,generateScoreProps:ie,validateNoteEvent:ae,isCompleted:ne,children:(t,s=he)=>{var v=Te(),l=ee(v);{var _=a=>{var d=ge();E(()=>D(d,T(w,s().completed,!0))),z(a,d)};G(l,a=>{s().completed!==e(w)&&a(_)})}var m=n(l,2),y=u(m);{var ce=a=>{var d=$e(),C=ee(d),i=n(u(C),2);i.__change=[Ie,h,N];var q=u(i);q.value=q.__value=0;var I=n(q);I.value=I.__value=1;var V=n(I);V.value=V.__value=2;var K=n(V);K.value=K.__value=3,c(i);var O;oe(i),c(C);var Q=n(C,2),g=n(u(Q),2);g.__change=[Ve,b,N];var S=u(g);S.value=S.__value="full";var k=n(S);k.value=k.__value="left-hand";var B=n(k);B.value=B.__value="right-hand";var X=n(B);X.value=X.__value="split",c(g);var Y;oe(g),c(Q),E(()=>{O!==(O=e(h))&&(i.value=(i.__value=e(h))??"",re(i,e(h))),Y!==(Y=e(b))&&(g.value=(g.__value=e(b))??"",re(g,e(b)))}),z(a,d)};G(y,a=>{f()||a(ce)})}var W=n(y,2);qe(W,21,()=>R(s().selectedNote),ze,(a,d,C)=>{var i=Pe();let q;var I=u(i,!0);c(i),E(V=>{q=xe(i,1,"chord-indicator svelte-1qz769a",null,q,V),D(I,e(d))},[()=>({active:C===e(o),completed:C<e(o)})]),z(a,i)}),c(W),c(m);var J=n(m,2),F=u(J),ve=u(F);c(F);var de=n(F,2);{var ue=a=>{var d=Ee();z(a,d)};G(de,a=>{s().completed&&a(ue)})}c(J),E(a=>D(ve,`Current: ${a??""} (${e(o)+1}/3)`),[()=>R(s().selectedNote)[e(o)]]),z(t,v)},$$slots:{default:!0}}),c(j),z(M,j),_e()}Ce(["change"]);export{Ge as component};
