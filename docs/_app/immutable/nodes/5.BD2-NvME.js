import"../chunks/NZTpNUN0.js";import{p as ue,ao as C,Q as F,g as pe,k as e,c as fe,ap as me,f as S,a as G,s as b,d as f,b as _,R as o,aq as H,r as u,ar as U,t as M,as as _e,at as ge}from"../chunks/u8fP_b2Q.js";import{d as he,s as z}from"../chunks/isL9873N.js";import{i as B}from"../chunks/Cj8lQ-n9.js";import{A as K,I as P,M as X,N as j,e as we,i as Ne}from"../chunks/DmnNUe2y.js";import{i as xe,r as ye,s as Ce}from"../chunks/CXakw2E1.js";import{b as be}from"../chunks/CoLbScs5.js";import{B as Me,c as Z}from"../chunks/CZxLfcpG.js";const ze=!0,Ge=Object.freeze(Object.defineProperty({__proto__:null,prerender:ze},Symbol.toStringTag,{value:"Module"}));function Se(I,s,l,g){const c=I.target;o(s,c.checked,!0),o(l,new Set,!0),o(g,!0)}function Ie(I,s,l,g){const c=I.target;o(s,c.value,!0),o(l,new Set,!0),o(g,!0)}var Ee=S('<option class="svelte-zlw4o"> </option>'),Re=S('<div class="control-group svelte-zlw4o"><label for="intervalType" class="svelte-zlw4o">Interval:</label> <select id="intervalType" class="svelte-zlw4o"></select></div> <div class="control-group svelte-zlw4o"><label class="svelte-zlw4o"><input type="checkbox" class="svelte-zlw4o"/> Show both notes</label></div>',1),Te=S('<div class="interval-info svelte-zlw4o"><span class="root-note svelte-zlw4o"> </span> <span class="interval-name svelte-zlw4o"> </span></div>'),ke=S('<span class="instruction waiting svelte-zlw4o">ðŸŽ¹ Play the root note first</span>'),Be=S('<span class="instruction playing svelte-zlw4o"> </span>'),Pe=S('<!> <div class="interval-controls svelte-zlw4o"><!> <!> <div class="play-instruction svelte-zlw4o"><!></div></div>',1);function Ke(I,s){ue(s,!0);let l=C(F(s.intervalType??(s.randomMode?K[Math.floor(Math.random()*K.length)]:"major3rd"))),g=C(F(s.showBothNotes??!0)),c=C(F(new Set)),E=C(!1),R=C(null),w=C(!0);function $(){o(c,new Set,!0),o(E,!1),o(R,null),o(w,!0)}pe(()=>{e(E)&&s.onComplete&&s.onComplete()});function ee(i){try{const a=Z(i,e(l),"4"),n=j[i+"4"],p=j[a+"4"];return o(R,n,!0),console.debug(`Interval ${P[e(l)]} from ${i}4 to ${a}4:`,`Root MIDI: ${n}, Expected MIDI: ${p}`),[n,p]}catch(a){console.error("Error generating expected note:",a);const n=j.C4,p=j.E4;return o(R,n,!0),[n,p]}}function te(i){try{const a=Z(i,e(l),"4"),n=i+"4",p=a+"4",h=e(g)?[[n,p]]:[[p]];return{selectedNote:i,leftHand:[],rightHand:h}}catch(a){return console.error("Error generating score props:",a),{selectedNote:i,leftHand:[],rightHand:[["C4","E4"]]}}}function oe(i,a,n,p){const[h,T]=n,x=P[e(l)],y=i;return e(w)?a.noteNumber===h?(o(c,new Set([h]),!0),o(w,!1),{isCorrect:!0,message:`Good! Root note ${y} played. Now play the ${x}`,collected:!0,resetCollected:!1}):{isCorrect:!1,message:`Start with the root note: ${y}`,collected:!1,resetCollected:!1}:a.noteNumber===T?(o(c,new Set([h,T]),!0),{isCorrect:!0,message:`Perfect ${x}! ðŸŽµâœ¨`,collected:!0,resetCollected:!1}):a.noteNumber===h?{isCorrect:!0,message:`Root note again. Now play the ${x}`,collected:!1,resetCollected:!1}:(o(c,new Set,!0),o(w,!0),{isCorrect:!1,message:`Wrong! You played ${X[a.noteNumber]?.slice(0,-1)}. Start over with root: ${y}`,collected:!1,resetCollected:!0})}function re(i,a){const n=[...new Set(a)];return e(c).size===n.length}{const i=(p,h=me)=>{var T=Pe();const x=H(()=>e(E)),y=H(()=>h().completed);var q=G(T);{var ae=t=>{var r=U();M(()=>z(r,o(E,!0))),_(t,r)},se=t=>{var r=_e(),v=G(r);{var d=m=>{var N=U();M(()=>z(N,o(E,!1))),_(m,N)};B(v,m=>{!e(y)&&e(x)&&m(d)},!0)}_(t,r)};B(q,t=>{e(y)&&!e(x)?t(ae):t(se,!1)})}var L=b(q,2),Q=f(L);{var le=t=>{var r=Re(),v=G(r),d=b(f(v),2);d.__change=[Ie,l,c,w],we(d,21,()=>K,Ne,(O,V)=>{var k=Ee(),de=f(k,!0);u(k);var J={};M(()=>{z(de,P[e(V)]),J!==(J=e(V))&&(k.value=(k.__value=e(V))??"")}),_(O,k)}),u(d);var m;xe(d),u(v);var N=b(v,2),A=f(N),D=f(A);ye(D),D.__change=[Se,g,c,w],ge(),u(A),u(N),M(()=>{m!==(m=e(l))&&(d.value=(d.__value=e(l))??"",Ce(d,e(l)))}),be(D,()=>e(g),O=>o(g,O)),_(t,r)};B(Q,t=>{s.randomMode||t(le)})}var W=b(Q,2);{var ne=t=>{var r=Te(),v=f(r),d=f(v);u(v);var m=b(v,2),N=f(m);u(m),u(r),M(A=>{z(d,`Root: ${A??""}`),z(N,`â†’ ${P[e(l)]??""}`)},[()=>X[e(R)]?.slice(0,-1)]),_(t,r)};B(W,t=>{e(R)!==null&&t(ne)})}var Y=b(W,2),ie=f(Y);{var ce=t=>{var r=ke();_(t,r)},ve=t=>{var r=Be(),v=f(r);u(r),M(()=>z(v,`ðŸŽµ Now play the ${P[e(l)]??""}`)),_(t,r)};B(ie,t=>{e(w)?t(ce):t(ve,!1)})}u(Y),u(L),_(p,T)};let a=H(()=>s.onComplete||(()=>{})),n=H(()=>s.rootKey||"C");Me(I,{get randomMode(){return s.randomMode},generateExpectedNotes:ee,generateScoreProps:te,validateNoteEvent:oe,isCompleted:re,onReset:$,get onComplete(){return e(a)},get initialNote(){return e(n)},children:i,$$slots:{default:!0}})}fe()}he(["change"]);export{Ke as component,Ge as universal};
