import{f as K,a as y,t as ee,c as be}from"../chunks/BHFmxDGj.js";import{p as xe,U as F,V as te,W as Me,v as e,a as Te,Y as T,X as b,f as S,s as a,c as g,r as u,t as E}from"../chunks/D-WvxLPx.js";import{d as Re,s as W}from"../chunks/y4LLdheI.js";import{e as He,i as Ee}from"../chunks/DiVgXp1T.js";import{i as j}from"../chunks/DD9bTvrE.js";import{i as k,a as z}from"../chunks/C_BxDK4Q.js";import{B as Ne,a as Ie,b as Pe,g as Ve}from"../chunks/CpJS4eQ0.js";import{e as oe,N as we,D as Ae,b as De}from"../chunks/DgZpB3qr.js";import{p as G}from"../chunks/BpP5SezP.js";var Le=K("<option> </option>"),Be=K('<div class="control-group svelte-b6xay4"><label for="chord-type" class="svelte-b6xay4">Chord Type:</label> <select id="chord-type"></select></div> <div class="control-group svelte-b6xay4"><label for="inversion" class="svelte-b6xay4">Inversion:</label> <select id="inversion"><option>Root</option><option>1st</option><option>2nd</option><option>3rd</option></select></div> <div class="control-group svelte-b6xay4"><label for="voicing" class="svelte-b6xay4">Voicing:</label> <select id="voicing"><option>Full Right Hand</option><option>Full Left Hand</option><option>1 & 7 Left / 3 & 5 Right</option><option>1 & 5 Left / 3 & 7 Right</option><option>Rootless A (3-5-7-9)</option><option>Rootless B (7-9-3-5)</option></select></div>',1),Fe=K('<!> <div class="controls svelte-b6xay4"><!></div>',1);function Oe(ae,r){xe(r,!0);const re="Play the notes of the displayed chord on your MIDI keyboard. Try to match the voicing and inversion shown.",ne=T(()=>G.url.searchParams.get("root"));let U=["maj7","min7","7","dom7","half-dim7","dim7"],_=T(()=>G.url.searchParams.get("quality")??r.chordType??(r.randomMode?U[Math.floor(Math.random()*U.length)]:"maj7")),f=F(te(r.inversion??(r.randomMode?Math.floor(Math.random()*4):0))),i=F(te(r.voicing??(r.randomMode?oe[Math.floor(Math.random()*oe.length)]:"full-right"))),se=T(()=>e(ne)??r.rootKey??"C"),R=F(!1);function le(o){const t=o+Ae,n=we[t],c=Ie(n,e(_),e(f));return Pe(c,e(i))}function ie(o,t,n){const c=n.map(H=>H%12),s=t.noteNumber%12;if(c.includes(s)){if(n.includes(t.noteNumber))return{isCorrect:!0,message:"Correct chord tone!",collected:!0,resetCollected:!1};if(e(i).startsWith("rootless"))return{isCorrect:!0,message:"Correct chord tone (octave ignored)!",collected:!0,resetCollected:!1}}return{isCorrect:!1,message:"Not a chord tone. Try again!",collected:!1,resetCollected:!0}}function ce(o){const t=o.target;b(_,t.value)}function ve(o){const t=o.target;b(f,parseInt(t.value),!0)}function de(o){const t=o.target;b(i,t.value,!0)}function ue(o){try{const t=Ve(o,e(_),e(f),e(i));return console.debug("Generated score data:",{selectedNote:o,chordType:e(_),voicing:e(i),inversion:e(f),scoreData:t}),{leftHand:t.leftHand,rightHand:t.rightHand,selectedNote:o}}catch(t){return console.error("Error generating score data:",t),{selectedNote:"C",leftHand:[[]],rightHand:[["C4","E4","G4"]]}}}function _e(o,t){if(e(i).startsWith("rootless")){const n=new Set(o.map(s=>s%12)),c=new Set(t.map(s=>s%12));return n.size===c.size&&[...n].every(s=>c.has(s))}return o.length===t.length&&o.every(n=>t.includes(n))}function fe(){b(R,!1)}Ne(ae,{get randomMode(){return r.randomMode},generateExpectedNotes:le,generateScoreProps:ue,validateNoteEvent:ie,isCompleted:_e,onReset:fe,get onComplete(){return r.onComplete},get initialNote(){return e(se)},description:re,children:(t,n=Me)=>{const c=T(()=>e(R)),s=T(()=>n().completed);var H=Fe(),q=S(H);{var he=l=>{var d=ee();E(()=>W(d,b(R,!0))),y(l,d)},pe=l=>{var d=be(),x=S(d);{var v=m=>{var C=ee();E(()=>W(C,b(R,!1))),y(m,C)};j(x,m=>{!e(s)&&e(c)&&m(v)},!0)}y(l,d)};j(q,l=>{e(s)&&!e(c)?l(he):l(pe,!1)})}var O=a(q,2),ge=g(O);{var me=l=>{var d=Be(),x=S(d),v=a(g(x),2);v.__change=ce,He(v,21,()=>De,Ee,(Ce,B)=>{var M=Le(),ye=g(M,!0);u(M);var $={};E(()=>{W(ye,e(B)),$!==($=e(B))&&(M.value=(M.__value=e(B))??"")}),y(Ce,M)}),u(v);var m;k(v),u(x);var C=a(x,2),h=a(g(C),2);h.__change=ve;var N=g(h);N.value=N.__value=0;var I=a(N);I.value=I.__value=1;var P=a(I);P.value=P.__value=2;var X=a(P);X.value=X.__value=3,u(h);var Y;k(h),u(C);var J=a(C,2),p=a(g(J),2);p.__change=de;var V=g(p);V.value=V.__value="full-right";var w=a(V);w.value=w.__value="full-left";var A=a(w);A.value=A.__value="1735";var D=a(A);D.value=D.__value="1537";var L=a(D);L.value=L.__value="rootless-a";var Q=a(L);Q.value=Q.__value="rootless-b",u(p);var Z;k(p),u(J),E(()=>{m!==(m=e(_))&&(v.value=(v.__value=e(_))??"",z(v,e(_))),Y!==(Y=e(f))&&(h.value=(h.__value=e(f))??"",z(h,e(f))),Z!==(Z=e(i))&&(p.value=(p.__value=e(i))??"",z(p,e(i)))}),y(l,d)};j(ge,l=>{!r.randomMode&&!G.url.searchParams.get("unitId")&&l(me)})}u(O),y(t,H)},$$slots:{default:!0}}),Te()}Re(["change"]);export{Oe as component};
