import{f as G,a as N,t as Y,c as ve}from"../chunks/Bdvgn338.js";import{p as pe,U as I,V as R,g as ge,k as e,W as he,X as B,a as _e,Z as r,f as Z,s as D,t as S,c as w,r as M,_ as Ne}from"../chunks/ZtE6Gyvq.js";import{d as Me,s as U}from"../chunks/BnZ86L-c.js";import{e as ye,i as Ce}from"../chunks/BFmSp7VO.js";import{i as V}from"../chunks/CdTPX8-T.js";import{i as be,r as xe,s as Ie}from"../chunks/U2hmf67d.js";import{b as we}from"../chunks/CVoLLLxN.js";import{a as T,A as H,N as z,I as k,M as F}from"../chunks/CXrKfc7O.js";import{B as Te,c as J}from"../chunks/BJLlDXwa.js";var Ee=G("<option> </option>"),Re=G('<div class="controls-area svelte-os8fbx"><div class="control-group svelte-os8fbx"><label for="intervalType">Interval Type</label> <select id="intervalType"></select></div> <div class="control-group svelte-os8fbx"><label><input type="checkbox"/> Right hand mode</label></div></div>'),Se=G("<!> <!>",1);function ze(Q,v){pe(v,!0);const ee="Play the interval shown on the staff using your MIDI keyboard. Listen and check your answer.";let y=v.randomMode,K=v.onComplete,te=v.intervalType,oe=v.rightHandMode,re=v.rootKey,i=I(R(te??(y?T[Math.floor(Math.random()*T.length)]:"major3rd"))),p=I(R(oe??(y?Math.random()>.5:!0))),n=I(R(re??(y?H[Math.floor(Math.random()*H.length)]:"C"))),d=I(R(new Set)),g=I(!1);function ae(){r(d,new Set,!0),r(g,!1)}ge(()=>{e(g)&&K&&K()});function ne(){const l=H[Math.floor(Math.random()*H.length)],t=T[Math.floor(Math.random()*T.length)];r(n,l,!0),r(i,t,!0),r(d,new Set,!0),r(g,!1)}function L(l,t){const o=["G","A","B"].includes(l);return t?o?"2":"3":o?"1":"2"}function se(l){try{const t=L(e(n),e(p)),o=J(e(n),e(i),t),s=z[e(n)+t],a=o;return console.debug(`Interval ${k[e(i)]} from ${e(n)}${t} to ${a}:`,`Root MIDI: ${s}, Expected MIDI: ${a}`),s===a?[s]:[s,a]}catch(t){console.error("Error generating expected note:",t);const o=z.C4,s=z.E4;return[o,s]}}function le(l){try{const t=L(e(n),e(p)),o=J(e(n),e(i),t),s=e(n)+t,a=F[o];let h=[],m=[];return e(p)?m=[[s,a]]:h=[[s,a]],{selectedNote:e(n),leftHand:h,rightHand:m}}catch(t){return console.error("Error generating score props:",t),{selectedNote:e(n),leftHand:[],rightHand:[["C4","E4"]]}}}function ie(l,t,o,s){const a=k[e(i)],m=o.length===1?1:2;if(o.includes(t.noteNumber)){if(r(d,new Set([...e(d),t.noteNumber]),!0),e(d).size===m)return setTimeout(()=>{ne()},1500),{isCorrect:!0,message:`Perfect ${a}! ðŸŽµâœ¨`,collected:!0,resetCollected:!0};{const[E,O]=o.length===2?o:[o[0],o[0]];return{isCorrect:!0,message:`Good! ${t.noteNumber===E?"root":a} played (${e(d).size}/${m})`,collected:!0,resetCollected:!1}}}else return r(d,new Set,!0),{isCorrect:!1,message:`Wrong! You played ${F[t.noteNumber]?.slice(0,-1)}. Play ${a} from ${e(n)}`,collected:!1,resetCollected:!0}}function ce(l,t){return!1}function de(l){const t=l.target;r(i,t.value,!0),r(d,new Set,!0)}function ue(l){const t=l.target;r(p,t.checked,!0),r(d,new Set,!0)}let fe=B(()=>`${k[e(i)]} from ${e(n)}`);Te(Q,{get randomMode(){return y},generateExpectedNotes:se,generateScoreProps:le,validateNoteEvent:ie,isCompleted:ce,onReset:ae,onComplete:()=>{},get initialNote(){return e(n)},description:ee,get prompt(){return e(fe)},showTempoControl:!1,showTrainingControl:!1,children:(t,o=he)=>{const s=B(()=>e(g)),a=B(()=>o().completed);var h=Se(),m=Z(h);{var E=c=>{var u=Y();S(()=>U(u,r(g,!0))),N(c,u)},O=c=>{var u=ve(),C=Z(u);{var f=_=>{var b=Y();S(()=>U(b,r(g,!1))),N(_,b)};V(C,_=>{!e(a)&&e(s)&&_(f)},!0)}N(c,u)};V(m,c=>{e(a)&&!e(s)?c(E):c(O,!1)})}var W=D(m,2);{var j=c=>{var u=Re(),C=w(u),f=D(w(C),2);f.__change=de,ye(f,21,()=>T,Ce,(P,$)=>{var x=Ee(),me=w(x,!0);M(x);var X={};S(()=>{U(me,k[e($)]),X!==(X=e($))&&(x.value=(x.__value=e($))??"")}),N(P,x)}),M(f);var _;be(f),M(C);var b=D(C,2),q=w(b),A=w(q);xe(A),A.__change=ue,Ne(),M(q),M(b),M(u),S(()=>{_!==(_=e(i))&&(f.value=(f.__value=e(i))??"",Ie(f,e(i)))}),we(A,()=>e(p),P=>r(p,P)),N(c,u)};V(W,c=>{y||c(j)})}N(t,h)},$$slots:{default:!0}}),_e()}Me(["change"]);export{ze as component};
