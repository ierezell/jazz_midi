import"../chunks/NZTpNUN0.js";import{d as fe,o as ge,s as E}from"../chunks/DutP5Gvj.js";import{p as Ne,z as x,A as q,f as j,b as C,c as xe,B as d,d as u,k as e,r as v,C as h,E as be,a as _e,s as b,t as ye}from"../chunks/C7Lc0MXo.js";import{i as F}from"../chunks/DSSW3rDz.js";import{M as Me}from"../chunks/xECcMkd1.js";import{A as H,c as $,m as B,d as Ee,N as w,a as $e,b as L}from"../chunks/KCvTrXcA.js";import{m as S,a as G,B as we}from"../chunks/B0lqf9OI.js";import{u as Se}from"../chunks/CTQRNL6p.js";const Te=async()=>({title:"Random Jazz Exercises",description:"Practice random jazz exercises including chords, scales, and ii-V-I progressions"}),Ue=Object.freeze(Object.defineProperty({__proto__:null,load:Te},Symbol.toStringTag,{value:"Module"}));function Ce(I,D,m,t){d(D,m(),!0),t()}var je=j('<div class="completion svelte-170d4py">ðŸŽ‰ Exercise Completed!</div>'),De=j('<div class="random-controls svelte-170d4py"><div class="control-group svelte-170d4py"><button class="debug-btn svelte-170d4py"> </button> <button class="reset-btn svelte-170d4py">Reset</button> <button class="new-exercise-btn svelte-170d4py">New Exercise</button></div></div> <div class="exercise-status svelte-170d4py"><div class="exercise-type svelte-170d4py"> </div> <div class="exercise-key svelte-170d4py"> </div> <div class="progress svelte-170d4py"> </div> <div class="mistakes svelte-170d4py"> </div> <!></div>',1),Pe=j('<div class="loading svelte-170d4py">Generating random exercise...</div>'),ke=j('<div class="random-exercise svelte-170d4py"><!></div>');function Ve(I,D){Ne(D,!0);let m=x(q([])),t=x(null),f=x(0),T=x(!1),y=x(!1),M=x(""),U=x(q(Date.now())),Q=h(()=>e(f)>=3),X=h(()=>e(f)>=6),P=h(()=>e(m).map(o=>o.noteNumber)),l=h(()=>e(t)?.expectedNotes||[]),Y=h(()=>{if(!e(t)||e(t).type!=="chord")return[];const o=e(t).key+"4",s=w[o],r=$(s,e(t).chordType||"maj7",e(t).inversion||0);return Me.Chord.createChordToneMapping(r,s,e(t).chordType||"maj7",e(t).inversion||0)}),Z=h(()=>({selectedNote:e(t)?.key||"C",midiNotes:e(P),noteEvents:e(m),debugMode:e(y),showNoteNames:e(Q),showKeyboard:e(X),feedbackMessage:e(M),errorCount:e(f),completed:e(T)})),ee=h(()=>({notes:e(t)?.scoreNotes||[],highlightedNotes:e(P).map(o=>B(o)),title:e(t)?.description||"Random Exercise"}));function V(){const o=["chord","scale-major","scale-minor","ii-v-i"],s=o[Math.floor(Math.random()*o.length)],r=H[Math.floor(Math.random()*H.length)];return te(s,r)}function te(o,s){switch(o){case"chord":{const r=L[Math.floor(Math.random()*L.length)],a=Math.floor(Math.random()*4),n=s+"4",c=w[n],i=$(c,r,a),p=[i.root,i.third,i.fifth,i.seventh].filter(_=>_!=null),g=p.map(_=>B(_));return{type:o,key:s,chordType:r,inversion:a,description:`${s}${r}${a>0?` (${a}st inversion)`:""}`,expectedNotes:p,scoreNotes:g}}case"scale-major":{const r=$e[s],n=Array.from(new Set(r.map(i=>i.slice(0,-1)))).map(i=>i+"4"),c=n.map(i=>w[i]);return{type:o,key:s,description:`${s} Major Scale`,expectedNotes:c,scoreNotes:n}}case"scale-minor":{const r=Ee[s],n=Array.from(new Set(r.map(i=>i.slice(0,-1)))).map(i=>i+"4"),c=n.map(i=>w[i]);return{type:o,key:s,description:`${s} Minor Scale`,expectedNotes:c,scoreNotes:n}}case"ii-v-i":{const r=w[s+"4"],a=$(r+2,"min7"),n=$(r+7,"7"),c=$(r,"maj7"),i=[a.root,a.third,a.fifth,a.seventh,n.root,n.third,n.fifth,n.seventh,c.root,c.third,c.fifth,c.seventh].filter(g=>g!=null),p=i.map(g=>B(g));return{type:o,key:s,description:`${s} ii-V-I Progression`,expectedNotes:i,scoreNotes:p}}default:throw new Error(`Unknown exercise type: ${o}`)}}function oe(o){console.log("Note selection not supported in random exercise mode")}function W(){d(y,!e(y)),e(y)?S.enableDebugMode():S.disableDebugMode()}function k(){d(f,0),d(m,[],!0),d(T,!1),d(M,""),d(U,Date.now(),!0),S.resetExercise()}function se(o){if(e(t)&&(d(m,[o,...e(m).slice(0,9)],!0),o.type==="on"))if(e(l).includes(o.noteNumber)){const s=e(m).filter(r=>r.type==="on").filter(r=>e(l).includes(r.noteNumber));if(s.length===e(l).length){d(T,!0),d(M,re(),!0),G.playSuccess();const r=(Date.now()-e(U))/1e3,a=Math.round(e(l).length/(e(l).length+e(f))*100);Se.updateNoteProgress(e(t).key,e(t).type.startsWith("scale")?"scale":e(t).type==="ii-v-i"?"progression":"chord",e(t).chordType,!0,r,a)}else d(M,`Good! ${s.length}/${e(l).length}`)}else be(f),d(M,"Wrong note!"),G.playError()}function re(){if(!e(t))return"Excellent! ðŸŽµ";switch(e(t).type){case"chord":return`Perfect ${e(t).description} chord! ðŸŽ¹`;case"scale-major":case"scale-minor":return`Excellent ${e(t).description}! ðŸŽµ`;case"ii-v-i":return`Great ${e(t).description}! ðŸŽµâœ¨`;default:return"Excellent! ðŸŽµ"}}ge(()=>(d(t,V(),!0),S.connect(se),G.initialize(),()=>{S.disconnect()}));var z=ke(),ie=u(z);{var ne=o=>{{let s=h(()=>({chordToneInfo:e(Y),showChordTones:e(t).type==="chord"}));we(o,{get exerciseState(){return e(Z)},exerciseTitle:"Random Exercise",get exerciseDescription(){return e(t).description},get expectedNotes(){return e(l)},get scoreProps(){return e(ee)},get keyboardProps(){return e(s)},onNoteSelect:oe,onDebugToggle:W,onReset:k,customControls:!0,children:(r,a)=>{var n=De(),c=_e(n),i=u(c),p=u(i);p.__click=W;var g=u(p);v(p);var _=b(p,2);_.__click=k;var ce=b(_,2);ce.__click=[Ce,t,V,k],v(i),v(c);var J=b(c,2),A=u(J),de=u(A);v(A);var O=b(A,2),le=u(O);v(O);var R=b(O,2),pe=u(R);v(R);var K=b(R,2),ue=u(K);v(K);var ve=b(K,2);{var me=N=>{var he=je();C(N,he)};F(ve,N=>{e(T)&&N(me)})}v(J),ye(N=>{E(g,`${e(y)?"Disable":"Enable"} Debug Mode`),E(de,`Type: ${e(t).type??""}`),E(le,`Key: ${e(t).key??""}`),E(pe,`Progress: ${N??""}%`),E(ue,`Mistakes: ${e(f)??""}`)},[()=>Math.round(e(P).filter(N=>e(l).includes(N)).length/e(l).length*100)]),C(r,n)},$$slots:{default:!0}})}},ae=o=>{var s=Pe();C(o,s)};F(ie,o=>{e(t)?o(ne):o(ae,!1)})}v(z),C(I,z),xe()}fe(["click"]);export{Ve as component,Ue as universal};
