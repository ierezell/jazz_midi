import"../chunks/NZTpNUN0.js";import{p as Re,N as y,O as le,g as xe,k as e,f as V,b as C,c as Me,d as m,P as be,R as A,a as W,s as n,t as P,Q as w,aw as we,r as f,S as ne,T as Ne}from"../chunks/DPDCOiIW.js";import{d as Te,s as D}from"../chunks/ZRc7GTJ1.js";import{i as k}from"../chunks/CPFqVV7e.js";import{f as ie,e as Ee,M as B,N as M,D as b,i as Fe}from"../chunks/Dh5yjYp3.js";import{i as ce,s as ve,a as Ie}from"../chunks/abe3cog1.js";import{p as Pe}from"../chunks/0uPyBmg-.js";import{B as Ve,b as Le,a as J}from"../chunks/DkJRdrwJ.js";function je(N,i,g){const s=N.target;w(i,parseInt(s.value),!0),g()}function ye(N,i,g){const s=N.target;w(i,s.value,!0),g()}var Ae=V('<div class="control-group svelte-1qz769a"><label for="inversion" class="svelte-1qz769a">Inversion:</label> <select id="inversion" class="svelte-1qz769a"><option class="svelte-1qz769a">Root</option><option class="svelte-1qz769a">1st</option><option class="svelte-1qz769a">2nd</option><option class="svelte-1qz769a">3rd</option></select></div> <div class="control-group svelte-1qz769a"><label for="voicing" class="svelte-1qz769a">Voicing:</label> <select id="voicing" class="svelte-1qz769a"><option class="svelte-1qz769a">Full Right Hand</option><option class="svelte-1qz769a">Full Left Hand</option><option class="svelte-1qz769a">1 & 7 Left / 3 & 5 Right</option><option class="svelte-1qz769a">1 & 5 Left / 3 & 7 Right</option></select></div>',1),De=V("<div> </div>"),ke=V('<div class="completion svelte-1qz769a">ðŸŽ‰ ii-V-I Completed!</div>'),Be=V('<!> <div class="progression-controls svelte-1qz769a"><!> <div class="chord-progress svelte-1qz769a"></div></div> <div class="exercise-status svelte-1qz769a"><div class="current-chord svelte-1qz769a"> </div> <!></div>',1),Ge=V('<div class="progression-exercise svelte-1qz769a"><!></div>');function Xe(N,i){Re(i,!0);let g=Pe(i,"randomMode",3,!1),s=y(0),q=y(le(i.inversion??(g()?Math.floor(Math.random()*4):0))),T=y(le(i.voicing??(g()?ie[Math.floor(Math.random()*ie.length)]:"full-right"))),E=y(!1);function de(){L(),w(E,!1)}xe(()=>{e(E)&&i.onComplete&&i.onComplete()});function L(){w(s,0)}function X(t){const o=M[t+b]+2,l=M[t+b]+7,_=M[t+b],c=J(o,"min7",e(q)),z=J(l,"7",e(q)),x=J(_,"maj7",e(q));return[c,z,x][e(s)]}function ue(t){const o=X(t);return[o.root,o.third,o.fifth,o.seventh].filter(l=>l!=null)}function fe(t,o,l,_){const c=j(t)[e(s)];if(l.includes(o.noteNumber)){const d=_.filter(H=>l.includes(H)).length,F=l.length;return d===F?e(s)<2?(setTimeout(()=>{we(s)},1e3),{isCorrect:!0,message:Y(),collected:!0,resetCollected:!1}):{isCorrect:!0,message:Y(),collected:!0,resetCollected:!1}:{isCorrect:!0,message:`Good! ${d}/${F} notes for ${c}`,collected:!0,resetCollected:!1}}const x=l.filter(d=>!_.includes(d)).map(d=>B[d].slice(0,-1)).join(", ");return{isCorrect:!1,message:`Wrong note. For ${c} expected: ${x}`,collected:!1,resetCollected:!0}}function _e(t,o){if(o.length===0)return!1;const c=t.filter(z=>o.includes(z)).length===o.length&&e(s)===2;return c&&setTimeout(()=>{L()},2e3),c}function j(t="C"){const o=M[t+b]+2,l=M[t+b]+7,_=M[t+b];return[`${B[o].slice(0,-1)}m7`,`${B[l].slice(0,-1)}7`,`${B[_].slice(0,-1)}maj7`]}function Y(){return e(s)<2?`Great! Now play ${j()[e(s)+1]}`:"Perfect! Complete ii-V-I progression! ðŸŽµâœ¨"}function me(t){const o=X(t);return{...Le(o,e(T)),selectedNote:t}}var G=Ge(),ge=m(G);{const t=(_,c=be)=>{var z=Be();const x=A(()=>e(E)),d=A(()=>c().completed);var F=W(z);{var H=r=>{var v=ne();P(()=>D(v,w(E,!0))),C(r,v)},pe=r=>{var v=Ne(),p=W(v);{var a=u=>{var h=ne();P(()=>D(h,w(E,!1))),C(u,h)};k(p,u=>{!e(d)&&e(x)&&u(a)},!0)}C(r,v)};k(F,r=>{e(d)&&!e(x)?r(H):r(pe,!1)})}var O=n(F,2),Z=m(O);{var he=r=>{var v=Ae(),p=W(v),a=n(m(p),2);a.__change=[je,q,L];var u=m(a);u.value=u.__value=0;var h=n(u);h.value=h.__value=1;var I=n(h);I.value=I.__value=2;var te=n(I);te.value=te.__value=3,f(a);var oe;ce(a),f(p);var re=n(p,2),R=n(m(re),2);R.__change=[ye,T,L];var K=m(R);K.value=K.__value="full-right";var Q=n(K);Q.value=Q.__value="full-left";var U=n(Q);U.value=U.__value="1735";var se=n(U);se.value=se.__value="1537",f(R);var ae;ce(R),f(re),P(()=>{oe!==(oe=e(q))&&(a.value=(a.__value=e(q))??"",ve(a,e(q))),ae!==(ae=e(T))&&(R.value=(R.__value=e(T))??"",ve(R,e(T)))}),C(r,v)};k(Z,r=>{g()||r(he)})}var $=n(Z,2);Ee($,21,()=>j(c().selectedNote),Fe,(r,v,p)=>{var a=De();let u;var h=m(a,!0);f(a),P(I=>{u=Ie(a,1,"chord-indicator svelte-1qz769a",null,u,I),D(h,e(v))},[()=>({active:p===e(s),completed:p<e(s)})]),C(r,a)}),f($),f(O);var ee=n(O,2),S=m(ee),Ce=m(S);f(S);var qe=n(S,2);{var ze=r=>{var v=ke();C(r,v)};k(qe,r=>{c().completed&&r(ze)})}f(ee),P(r=>D(Ce,`Current: ${r??""} (${e(s)+1}/3)`),[()=>j(c().selectedNote)[e(s)]]),C(_,z)};let o=A(()=>i.onComplete||(()=>{})),l=A(()=>i.rootKey||"C");Ve(ge,{get randomMode(){return g()},generateExpectedNotes:ue,generateScoreProps:me,validateNoteEvent:fe,isCompleted:_e,onReset:de,get onComplete(){return e(o)},get initialNote(){return e(l)},children:t,$$slots:{default:!0}})}f(G),C(N,G),Me()}Te(["change"]);export{Xe as component};
