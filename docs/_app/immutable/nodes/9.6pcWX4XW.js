import{c as $,a as b,f as E}from"../chunks/Bdvgn338.js";import{o as Te,a as ke}from"../chunks/BRJReVLM.js";import{x as Ie,I as Ne,b2 as Ee,b as Se,p as de,f as ee,a as ve,c as v,s as u,k as e,r as l,t as P,U as C,V as G,Z as M,Y as Ae,X as re}from"../chunks/ZtE6Gyvq.js";import{d as ge,s as H}from"../chunks/BnZ86L-c.js";import{i as te}from"../chunks/CdTPX8-T.js";import{B as Ve}from"../chunks/BBj3Lkrj.js";import{c as Oe,B as Ue}from"../chunks/BJLlDXwa.js";import{A as Pe,b as He,c as je,d as pe,e as ue,N as ne,f as ze,D as ce,M as Ke}from"../chunks/CXrKfc7O.js";import{e as L,i as R}from"../chunks/BFmSp7VO.js";import{r as F,d as W}from"../chunks/U2hmf67d.js";import{component as qe}from"./7.BsX3wF1f.js";import{component as Be}from"./15.ooVVvL8D.js";import{component as De}from"./17.DuYtqXXp.js";function Ge(X,n,x){Ie&&Ne();var N=new Ve(X),T=!Ee();Se(()=>{var k=n();T&&k!==null&&typeof k=="object"&&(k={}),N.ensure(k,x)})}const Le=!1,ft=Object.freeze(Object.defineProperty({__proto__:null,ssr:Le},Symbol.toStringTag,{value:"Module"})),Re=["chord","scale","II-V-I","note","interval","partition","progression","rhythm"];var Fe=E('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),We=E('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Xe=E('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Ye=E('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Ze=E('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Je=E('<label class="checkbox-label svelte-pgit1g"><input type="checkbox"/> <span> </span></label>'),Qe=E('<div class="popup-overlay svelte-pgit1g" role="dialog" aria-modal="true" aria-label="Configure exercises" tabindex="0"><div class="popup-content svelte-pgit1g"><button type="button" class="close-btn svelte-pgit1g" aria-label="Close">√ó</button> <h2 class="svelte-pgit1g">Exercise Configuration</h2> <div class="config-grid svelte-pgit1g"><div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Exercise Types</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Notes</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Chord Types</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Inversions</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Scale Modes</h3> <div class="checkbox-grid svelte-pgit1g"></div></div> <div class="config-section svelte-pgit1g"><h3 class="svelte-pgit1g">Voicings</h3> <div class="checkbox-grid svelte-pgit1g"></div></div></div></div></div>');function $e(X,n){de(n,!0);function x(c,p,a){if(c==="allowedExerciseTypes"){const t=[...n.allowedExerciseTypes];if(a)t.push(p);else if(t.length>1){const g=t.indexOf(p);g>-1&&t.splice(g,1)}n.onUpdate(c,t.sort())}else if(c==="allowedNotes"){const t=[...n.allowedNotes];if(a)t.push(p);else if(t.length>1){const g=t.indexOf(p);g>-1&&t.splice(g,1)}n.onUpdate(c,t.sort())}else if(c==="allowedChordTypes"){const t=[...n.allowedChordTypes];if(a)t.push(p);else if(t.length>1){const g=t.indexOf(p);g>-1&&t.splice(g,1)}n.onUpdate(c,t.sort())}else if(c==="allowedInversions"){const t=[...n.allowedInversions];if(a)t.push(p);else if(t.length>1){const g=t.indexOf(p);g>-1&&t.splice(g,1)}n.onUpdate(c,t.sort((g,A)=>g-A).map(String))}else if(c==="allowedScaleModes"){const t=[...n.allowedScaleModes];if(a)t.push(p);else if(t.length>1){const g=t.indexOf(p);g>-1&&t.splice(g,1)}n.onUpdate(c,t.sort())}else if(c==="allowedVoicings"){const t=[...n.allowedVoicings];if(a)t.push(p);else if(t.length>1){const g=t.indexOf(p);g>-1&&t.splice(g,1)}n.onUpdate(c,t.sort())}}function N(c){(c instanceof MouseEvent&&c.target.classList.contains("popup-overlay")||c instanceof KeyboardEvent&&c.key==="Escape")&&n.onClose()}var T=$(),k=ee(T);{var S=c=>{var p=Qe();p.__click=h=>N(h),p.__keydown=h=>N(h);var a=v(p),t=v(a);t.__click=()=>n.onClose();var g=u(t,4),A=v(g),I=u(v(A),2);L(I,21,()=>Re,R,(h,i)=>{var d=Fe(),r=v(d);F(r),r.__change=o=>x("allowedExerciseTypes",e(i),o.currentTarget.checked);var f=u(r,2),w=v(f,!0);l(f),l(d),P((o,s)=>{W(r,o),H(w,s)},[()=>n.allowedExerciseTypes.includes(e(i)),()=>e(i).charAt(0).toUpperCase()+e(i).slice(1)]),b(h,d)}),l(I),l(A);var Y=u(A,2),j=u(v(Y),2);L(j,21,()=>Pe,R,(h,i)=>{var d=We(),r=v(d);F(r),r.__change=o=>x("allowedNotes",e(i),o.currentTarget.checked);var f=u(r,2),w=v(f,!0);l(f),l(d),P(o=>{W(r,o),H(w,e(i))},[()=>n.allowedNotes.includes(e(i))]),b(h,d)}),l(j),l(Y);var V=u(Y,2),oe=u(v(V),2);L(oe,21,()=>He,R,(h,i)=>{var d=Xe(),r=v(d);F(r),r.__change=o=>x("allowedChordTypes",e(i),o.currentTarget.checked);var f=u(r,2),w=v(f,!0);l(f),l(d),P(o=>{W(r,o),H(w,e(i))},[()=>n.allowedChordTypes.includes(e(i))]),b(h,d)}),l(oe),l(V);var Z=u(V,2),z=u(v(Z),2);L(z,21,()=>je,R,(h,i)=>{var d=Ye(),r=v(d);F(r),r.__change=o=>x("allowedInversions",e(i).toString(),o.currentTarget.checked);var f=u(r,2),w=v(f,!0);l(f),l(d),P(o=>{W(r,o),H(w,e(i)===0?"Root":`${e(i)}${e(i)===1?"st":e(i)===2?"nd":"rd"}`)},[()=>n.allowedInversions.includes(e(i))]),b(h,d)}),l(z),l(Z);var O=u(Z,2),K=u(v(O),2);L(K,21,()=>pe,R,(h,i)=>{var d=Ze(),r=v(d);F(r),r.__change=o=>x("allowedScaleModes",e(i),o.currentTarget.checked);var f=u(r,2),w=v(f,!0);l(f),l(d),P(o=>{W(r,o),H(w,e(i))},[()=>n.allowedScaleModes.includes(e(i))]),b(h,d)}),l(K),l(O);var ae=u(O,2),J=u(v(ae),2);L(J,21,()=>ue,R,(h,i)=>{var d=Je(),r=v(d);F(r),r.__change=o=>x("allowedVoicings",e(i),o.currentTarget.checked);var f=u(r,2),w=v(f,!0);l(f),l(d),P((o,s)=>{W(r,o),H(w,s)},[()=>n.allowedVoicings.includes(e(i)),()=>e(i).charAt(0).toUpperCase()+e(i).slice(1)]),b(h,d)}),l(J),l(ae),l(g),l(a),l(p),b(c,p)};te(k,c=>{n.showPopup&&c(S)})}b(X,T),ve()}ge(["click","keydown","change"]);var et=E('<div class="loading svelte-1a0o1e6">Generating...</div>'),tt=E('<div class="flashcards-container svelte-1a0o1e6"><div class="header svelte-1a0o1e6"><div class="progress svelte-1a0o1e6"> </div> <div class="controls svelte-1a0o1e6"><button class="config-btn svelte-1a0o1e6">‚öôÔ∏è Config</button> <button class="new-btn svelte-1a0o1e6">üé≤ New Card</button></div></div> <!> <!></div>');function ht(X,n){de(n,!0);let x=C(G(["C","F","G"])),N=C(G(["maj7","min7","7","major","minor"])),T=C(G([0,1,2,3])),k=C(G(pe)),S=C(G(ue)),c=C(G(["note","interval","chord","scale","II-V-I"])),p=C(!1),a=C(null),t=C(0),g=C(!1),A=C(0),I=null,Y=C(0);function j(){const o=e(c)[Math.floor(Math.random()*e(c).length)],s=e(x)[Math.floor(Math.random()*e(x).length)];let _;if(o==="note"){const m=ne[`${s}${ce}`];_={type:"note",prompt:s,subtext:"Play the note",expectedNotes:[m]}}else if(o==="interval"){const m=Object.keys(ze),y=m[Math.floor(Math.random()*m.length)],U=ne[`${s}${ce}`],Q=Oe(s,y);_={type:"interval",prompt:`${s} + ${y}`,subtext:"Play the interval",expectedNotes:[U,Q]}}else if(o==="chord"){const m=e(N)[Math.floor(Math.random()*e(N).length)],y=e(T)[Math.floor(Math.random()*e(T).length)],U=e(S)[Math.floor(Math.random()*e(S).length)];_={type:"chord",prompt:`${s} ${m}`,subtext:"Play the chord",expectedNotes:[],config:{chordType:m,inversion:y,voicing:U,root:s}}}else if(o==="scale"){const m=e(k)[Math.floor(Math.random()*e(k).length)];_={type:"scale",prompt:`${s} ${m} Scale`,subtext:"Play the scale",expectedNotes:[],config:{mode:m,root:s}}}else{const m=e(T)[Math.floor(Math.random()*e(T).length)],y=e(S)[Math.floor(Math.random()*e(S).length)];_={type:"II-V-I",prompt:`${s} II-V-I`,subtext:"Play the progression",expectedNotes:[],config:{inversion:m,voicing:y,root:s}}}M(a,_,!0),M(t,Date.now(),!0),M(g,!1),I&&clearTimeout(I),M(Y,0)}function V(){Ae(A),I&&clearTimeout(I),I=setTimeout(()=>{j()},1e3)}Te(()=>{j()}),ke(()=>{I&&clearTimeout(I)});function oe(o,s,_,m){if(_.includes(s.noteNumber)){const y=m.filter(se=>_.includes(se)),U=new Set(y),Q=new Set(_);return U.size===Q.size?{isCorrect:!0,message:"Correct!",collected:!0,resetCollected:!1}:{isCorrect:!0,message:"Good note...",collected:!0,resetCollected:!1}}return{isCorrect:!1,message:"Wrong note",collected:!1,resetCollected:!0}}function Z(o,s){const _=new Set(o.filter(y=>s.includes(y))),m=new Set(s);return _.size===m.size}var z=tt(),O=v(z),K=v(O),ae=v(K);l(K);var J=u(K,2),h=v(J);h.__click=()=>M(p,!0);var i=u(h,2);i.__click=j,l(J),l(O);var d=u(O,2);$e(d,{get showPopup(){return e(p)},get allowedNotes(){return e(x)},get allowedChordTypes(){return e(N)},get allowedInversions(){return e(T)},get allowedScaleModes(){return e(k)},get allowedVoicings(){return e(S)},get allowedExerciseTypes(){return e(c)},onClose:()=>M(p,!1),onUpdate:(o,s)=>{switch(o){case"allowedNotes":M(x,s,!0);break;case"allowedChordTypes":M(N,s,!0);break;case"allowedInversions":M(T,s.map(Number),!0);break;case"allowedScaleModes":M(k,s,!0);break;case"allowedVoicings":M(S,s,!0);break;case"allowedExerciseTypes":M(c,s,!0);break}}});var r=u(d,2);{var f=o=>{var s=$(),_=ee(s);Ge(_,()=>e(t),m=>{var y=$(),U=ee(y);{var Q=q=>{qe(q,{randomMode:!0,onComplete:V,get chordType(){return e(a).config.chordType},get inversion(){return e(a).config.inversion},get voicing(){return e(a).config.voicing},get rootKey(){return e(a).config.root},progressiveHints:!0,get prompt(){return e(a).prompt}})},se=q=>{var le=$(),fe=ee(le);{var he=B=>{Be(B,{randomMode:!0,onComplete:V,get scaleMode(){return e(a).config.mode},get rootKey(){return e(a).config.root},progressiveHints:!0,get prompt(){return e(a).prompt}})},me=B=>{var ie=$(),_e=ee(ie);{var be=D=>{De(D,{randomMode:!0,onComplete:V,get inversion(){return e(a).config.inversion},get voicing(){return e(a).config.voicing},get rootKey(){return e(a).config.root},progressiveHints:!0,get prompt(){return e(a).prompt}})},xe=D=>{{let we=re(()=>e(a).prompt.split(" ")[0]),ye=re(()=>e(a).subtext??""),Ce=re(()=>e(a).type==="note"?"note":"interval");Ue(D,{randomMode:!0,generateExpectedNotes:()=>e(a).expectedNotes,generateScoreProps:()=>({selectedNote:e(a).prompt.split(" ")[0],leftHand:[],rightHand:[e(a).expectedNotes.map(Me=>Ke[Me])]}),validateNoteEvent:oe,isCompleted:Z,onComplete:V,get initialNote(){return e(we)},get description(){return e(ye)},get exerciseType(){return e(Ce)},progressiveHints:!0,onReset:()=>{},get prompt(){return e(a).prompt}})}};te(_e,D=>{e(a).type==="II-V-I"?D(be):D(xe,!1)},!0)}b(B,ie)};te(fe,B=>{e(a).type==="scale"?B(he):B(me,!1)},!0)}b(q,le)};te(U,q=>{e(a).type==="chord"?q(Q):q(se,!1)})}b(m,y)}),b(o,s)},w=o=>{var s=et();b(o,s)};te(r,o=>{e(a)?o(f):o(w,!1)})}l(z),P(()=>H(ae,`Cards: ${e(A)??""} / 10`)),b(X,z),ve()}ge(["click"]);export{ht as component,ft as universal};
