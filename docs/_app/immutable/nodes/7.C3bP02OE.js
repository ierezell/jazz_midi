import"../chunks/NZTpNUN0.js";import{p as se,ap as q,R as E,g as ne,k as e,c as le,aU as ie,f as Q,a as z,s as N,b as C,S as n,aq as O,d as h,r as p,as as U,t as A,ar as ce,ao as V}from"../chunks/wFTEGHnI.js";import{d as de,s as D}from"../chunks/BJdPA1W9.js";import{i as j}from"../chunks/DB4UBEnh.js";import{r as F,i as ue,g as ve}from"../chunks/BBAnfavV.js";import{a as J}from"../chunks/DK-HBcj1.js";import{c as K,M as H,N as me,S as fe}from"../chunks/M4Hk-hxN.js";import{B as ge}from"../chunks/BywGZpRb.js";function _e(f,o,c){const i=f.target;n(o,i.checked,!0),n(c,new Set,!0)}function he(f,o,c){const i=f.target;n(o,i.checked,!0),n(c,new Set,!0)}function pe(f,o,c){const i=f.target;n(o,i.value,!0),n(c,new Set,!0)}var Me=Q('<div class="control-group svelte-qe37du"><label class="svelte-qe37du"><input type="checkbox" class="svelte-qe37du"/> In order</label></div> <div class="control-group svelte-qe37du"><label class="svelte-qe37du"><input type="checkbox" class="svelte-qe37du"/> Right hand</label></div> <div class="control-group svelte-qe37du"><label for="scaleMode" class="svelte-qe37du">Scale mode:</label> <select id="scaleMode" class="svelte-qe37du"><option class="svelte-qe37du">Major</option><option class="svelte-qe37du">Minor</option></select></div>',1),Se=Q('<!> <div class="scale-controls svelte-qe37du"><!></div>',1);function ye(f,o){se(o,!0);let c=q(E(o.sequentialMode??(o.randomMode?Math.random()>.5:!0))),i=q(E(o.handMode??(o.randomMode?Math.random()>.5:!0))),S=q(E(o.scaleMode??(o.randomMode?K[Math.floor(Math.random()*K.length)]:"Maj"))),l=q(E(new Set)),x=q(!1);ne(()=>{e(x)&&o.onComplete&&o.onComplete()});function I(r){const t=me[r+(e(i)?"4":"3")],s=fe[e(S)].map(a=>t+a);return console.debug(`Scale for ${r}4:`,s.map(a=>H[a])),s}function X(r){const s=I(r).map(u=>H[u]),a=e(i)?s.map(u=>[u]):[],d=e(i)?[]:s.map(u=>[u]);return{selectedNote:r,leftHand:d,rightHand:a}}function Y(r,t,s,a){return e(c)?Z(t,s):$(t,s)}function Z(r,t,s){const a=e(l).size,d=t[a];if(r.noteNumber===d)n(l,e(l).add(r.noteNumber),!0);else{const u=H[d]?.slice(0,-1)||d.toString();return n(l,new Set,!0),{isCorrect:!1,message:`Wrong note! Expected ${u} (note ${a+1})`}}return e(l).size===t.length?{isCorrect:!0,message:"Perfect scale! ðŸŽµâœ¨"}:{isCorrect:!0,message:`Good! Note ${a+1}/${t.length}`}}function $(r,t,s){if(t.includes(r.noteNumber))n(l,e(l).add(r.noteNumber),!0);else return n(l,new Set,!0),{isCorrect:!1,message:"Wrong note!"};return e(l).size===t.length?{isCorrect:!0,message:"Perfect scale! ðŸŽµ"}:{isCorrect:!0,message:`Good! ${e(l).size}/${t.length} notes`}}function ee(r,t){if(e(c))return r.length===t.length&&r.every((s,a)=>s===t[a]);{const s=[...new Set(r)],a=[...new Set(t)];return s.length===a.length&&s.every(d=>a.includes(d))}}ge(f,{get randomMode(){return o.randomMode},generateExpectedNotes:I,generateScoreProps:X,validateNoteEvent:Y,isCompleted:ee,children:(t,s=ie)=>{var a=Se();const d=O(()=>e(x)),u=O(()=>s().completed);var P=z(a);{var te=v=>{var m=U();A(()=>D(m,n(x,!0))),C(v,m)},ae=v=>{var m=ce(),b=z(m);{var w=g=>{var M=U();A(()=>D(M,n(x,!1))),C(g,M)};j(b,g=>{!e(u)&&e(d)&&g(w)},!0)}C(v,m)};j(P,v=>{e(u)&&!e(d)?v(te):v(ae,!1)})}var R=N(P,2),oe=h(R);{var re=v=>{var m=Me(),b=z(m),w=h(b),g=h(w);F(g),g.__change=[_e,c,l],V(),p(w),p(b);var M=N(b,2),B=h(M),k=h(B);F(k),k.__change=[he,i,l],V(),p(B),p(M);var G=N(M,2),_=N(h(G),2);_.__change=[pe,S,l];var y=h(_);y.value=y.__value="Maj";var L=N(y);L.value=L.__value="Min",p(_);var W;ue(_),p(G),A(()=>{W!==(W=e(S))&&(_.value=(_.__value=e(S))??"",ve(_,e(S)))}),J(g,()=>e(c),T=>n(c,T)),J(k,()=>e(i),T=>n(i,T)),C(v,m)};j(oe,v=>{o.randomMode||v(re)})}p(R),C(t,a)},$$slots:{default:!0}}),le()}de(["change"]);export{ye as component};
