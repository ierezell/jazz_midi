import"../chunks/CWj6FrbW.js";import{d as fe,o as ge,s as $}from"../chunks/BmhLxRLF.js";import{p as Ne,o as x,q as U,f as j,b as C,c as xe,v as d,d as u,k as e,r as v,w as h,y as be,a as _e,s as b,t as ye}from"../chunks/CiAnzwjR.js";import{i as F}from"../chunks/9NUL7pul.js";import{m as E,a as G,B as Me}from"../chunks/DfZBKltH.js";import{u as $e}from"../chunks/DZz6v8Gc.js";import{c as Ee}from"../chunks/CoExbraD.js";import{A as H,c as w,m as I,d as we,N as S,a as Se,b as L}from"../chunks/X11iEPzw.js";const Te=async()=>({title:"Random Jazz Exercises",description:"Practice random jazz exercises including chords, scales, and ii-V-I progressions"}),Ve=Object.freeze(Object.defineProperty({__proto__:null,load:Te},Symbol.toStringTag,{value:"Module"}));function Ce(B,D,m,o){d(D,m(),!0),o()}var je=j('<div class="completion svelte-170d4py">ðŸŽ‰ Exercise Completed!</div>'),De=j('<div class="random-controls svelte-170d4py"><div class="control-group svelte-170d4py"><button class="debug-btn svelte-170d4py"> </button> <button class="reset-btn svelte-170d4py">Reset</button> <button class="new-exercise-btn svelte-170d4py">New Exercise</button></div></div> <div class="exercise-status svelte-170d4py"><div class="exercise-type svelte-170d4py"> </div> <div class="exercise-key svelte-170d4py"> </div> <div class="progress svelte-170d4py"> </div> <div class="mistakes svelte-170d4py"> </div> <!></div>',1),Pe=j('<div class="loading svelte-170d4py">Generating random exercise...</div>'),ke=j('<div class="random-exercise svelte-170d4py"><!></div>');function We(B,D){Ne(D,!0);let m=x(U([])),o=x(null),f=x(0),T=x(!1),y=x(!1),M=x(""),V=x(U(Date.now())),Q=h(()=>e(f)>=3),X=h(()=>e(f)>=6),P=h(()=>e(m).map(t=>t.noteNumber)),l=h(()=>{var t;return((t=e(o))==null?void 0:t.expectedNotes)||[]}),Y=h(()=>{if(!e(o)||e(o).type!=="chord")return[];const t=e(o).key+"4",s=S[t],r=w(s,e(o).chordType||"maj7",e(o).inversion||0);return Ee(r)}),Z=h(()=>{var t;return{selectedNote:((t=e(o))==null?void 0:t.key)||"C",midiNotes:e(P),noteEvents:e(m),debugMode:e(y),showNoteNames:e(Q),showKeyboard:e(X),feedbackMessage:e(M),errorCount:e(f),completed:e(T)}}),ee=h(()=>{var t,s;return{notes:((t=e(o))==null?void 0:t.scoreNotes)||[],highlightedNotes:e(P).map(r=>I(r)),title:((s=e(o))==null?void 0:s.description)||"Random Exercise"}});function W(){const t=["chord","scale-major","scale-minor","ii-v-i"],s=t[Math.floor(Math.random()*t.length)],r=H[Math.floor(Math.random()*H.length)];return te(s,r)}function te(t,s){switch(t){case"chord":{const r=L[Math.floor(Math.random()*L.length)],a=Math.floor(Math.random()*4),i=s+"4",c=S[i],n=w(c,r,a),p=[n.root,n.third,n.fifth,n.seventh].filter(_=>_!=null),g=p.map(_=>I(_));return{type:t,key:s,chordType:r,inversion:a,description:`${s}${r}${a>0?` (${a}st inversion)`:""}`,expectedNotes:p,scoreNotes:g}}case"scale-major":{const r=Se[s],i=Array.from(new Set(r.map(n=>n.slice(0,-1)))).map(n=>n+"4"),c=i.map(n=>S[n]);return{type:t,key:s,description:`${s} Major Scale`,expectedNotes:c,scoreNotes:i}}case"scale-minor":{const r=we[s],i=Array.from(new Set(r.map(n=>n.slice(0,-1)))).map(n=>n+"4"),c=i.map(n=>S[n]);return{type:t,key:s,description:`${s} Minor Scale`,expectedNotes:c,scoreNotes:i}}case"ii-v-i":{const r=S[s+"4"],a=w(r+2,"min7"),i=w(r+7,"7"),c=w(r,"maj7"),n=[a.root,a.third,a.fifth,a.seventh,i.root,i.third,i.fifth,i.seventh,c.root,c.third,c.fifth,c.seventh].filter(g=>g!=null),p=n.map(g=>I(g));return{type:t,key:s,description:`${s} ii-V-I Progression`,expectedNotes:n,scoreNotes:p}}default:throw new Error(`Unknown exercise type: ${t}`)}}function oe(t){console.log("Note selection not supported in random exercise mode")}function q(){d(y,!e(y)),e(y)?E.enableDebugMode():E.disableDebugMode()}function k(){d(f,0),d(m,[],!0),d(T,!1),d(M,""),d(V,Date.now(),!0),E.resetExercise()}function se(t){if(e(o)&&(d(m,[t,...e(m).slice(0,9)],!0),t.type==="on"))if(e(l).includes(t.noteNumber)){const s=e(m).filter(r=>r.type==="on").filter(r=>e(l).includes(r.noteNumber));if(s.length===e(l).length){d(T,!0),d(M,re(),!0),G.playSuccess();const r=(Date.now()-e(V))/1e3,a=Math.round(e(l).length/(e(l).length+e(f))*100);$e.updateNoteProgress(e(o).key,e(o).type.startsWith("scale")?"scale":e(o).type==="ii-v-i"?"progression":"chord",e(o).chordType,!0,r,a)}else d(M,`Good! ${s.length}/${e(l).length}`)}else be(f),d(M,"Wrong note!"),G.playError()}function re(){if(!e(o))return"Excellent! ðŸŽµ";switch(e(o).type){case"chord":return`Perfect ${e(o).description} chord! ðŸŽ¹`;case"scale-major":case"scale-minor":return`Excellent ${e(o).description}! ðŸŽµ`;case"ii-v-i":return`Great ${e(o).description}! ðŸŽµâœ¨`;default:return"Excellent! ðŸŽµ"}}ge(()=>(d(o,W(),!0),E.connect(se),G.initialize(),()=>{E.disconnect()}));var z=ke(),ne=u(z);{var ie=t=>{{let s=h(()=>({chordToneInfo:e(Y),showChordTones:e(o).type==="chord"}));Me(t,{get exerciseState(){return e(Z)},exerciseTitle:"Random Exercise",get exerciseDescription(){return e(o).description},get expectedNotes(){return e(l)},get scoreProps(){return e(ee)},get keyboardProps(){return e(s)},onNoteSelect:oe,onDebugToggle:q,onReset:k,customControls:!0,children:(r,a)=>{var i=De(),c=_e(i),n=u(c),p=u(n);p.__click=q;var g=u(p);v(p);var _=b(p,2);_.__click=k;var ce=b(_,2);ce.__click=[Ce,o,W,k],v(n),v(c);var J=b(c,2),O=u(J),de=u(O);v(O);var R=b(O,2),le=u(R);v(R);var A=b(R,2),pe=u(A);v(A);var K=b(A,2),ue=u(K);v(K);var ve=b(K,2);{var me=N=>{var he=je();C(N,he)};F(ve,N=>{e(T)&&N(me)})}v(J),ye(N=>{$(g,`${e(y)?"Disable":"Enable"} Debug Mode`),$(de,`Type: ${e(o).type??""}`),$(le,`Key: ${e(o).key??""}`),$(pe,`Progress: ${N??""}%`),$(ue,`Mistakes: ${e(f)??""}`)},[()=>Math.round(e(P).filter(N=>e(l).includes(N)).length/e(l).length*100)]),C(r,i)},$$slots:{default:!0}})}},ae=t=>{var s=Pe();C(t,s)};F(ne,t=>{e(o)?t(ie):t(ae,!1)})}v(z),C(B,z),xe()}fe(["click"]);export{We as component,Ve as universal};
