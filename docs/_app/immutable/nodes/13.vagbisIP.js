import{f as V,a as g,t as se,c as Ie}from"../chunks/BHFmxDGj.js";import{p as ye,U as N,V as ae,W as Pe,v as e,a as Ve,X as q,_ as be,c as p,f as O,s as n,t as P,Y as L,r as d}from"../chunks/D-WvxLPx.js";import{d as we,s as $}from"../chunks/y4LLdheI.js";import{e as Te,s as Ee,i as Fe}from"../chunks/DiVgXp1T.js";import{i as A}from"../chunks/DD9bTvrE.js";import{i as ne,a as ie}from"../chunks/C_BxDK4Q.js";import{p as Ne}from"../chunks/CcxOe7hN.js";import{B as Le,d as $e,a as S}from"../chunks/CpJS4eQ0.js";import{e as le,M as D,N as R,D as x}from"../chunks/DgZpB3qr.js";import{p as ce}from"../chunks/BpP5SezP.js";var Ae=V('<div class="control-group svelte-1jk8q9u"><label for="inversion" class="svelte-1jk8q9u">Inversion:</label> <select id="inversion" class="svelte-1jk8q9u"><option class="svelte-1jk8q9u">Root</option><option class="svelte-1jk8q9u">1st</option><option class="svelte-1jk8q9u">2nd</option><option class="svelte-1jk8q9u">3rd</option></select></div> <div class="control-group svelte-1jk8q9u"><label for="voicing" class="svelte-1jk8q9u">Voicing:</label> <select id="voicing" class="svelte-1jk8q9u"><option class="svelte-1jk8q9u">Full Right Hand</option><option class="svelte-1jk8q9u">Full Left Hand</option><option class="svelte-1jk8q9u">1 & 7 Left / 3 & 5 Right</option><option class="svelte-1jk8q9u">1 & 5 Left / 3 & 7 Right</option></select></div>',1),De=V("<div> </div>"),Ke=V('<div class="completion svelte-1jk8q9u">ðŸŽ‰ ii-V-I Completed!</div>'),Ue=V('<!> <div class="progression-controls svelte-1jk8q9u"><!> <div class="chord-progress svelte-1jk8q9u"></div></div> <div class="exercise-status svelte-1jk8q9u"><div class="current-chord svelte-1jk8q9u"> </div> <!></div>',1),Be=V('<div class="progression-exercise svelte-1jk8q9u"><!></div>');function Ze(ve,M){ye(M,!0);const ue="Play the II-V-I progression as shown. Use the correct chords and voicings for each step.";let b=Ne(M,"randomMode",3,!1);const de=L(()=>ce.url.searchParams.get("key"));let i=N(0),h=N(ae(M.inversion??(b()?Math.floor(Math.random()*4):0))),I=N(ae(M.voicing??(b()?le[Math.floor(Math.random()*le.length)]:"full-right"))),fe=L(()=>e(de)??M.rootKey??"C"),w=N(!1);function pe(){T(),q(w,!1)}function T(){q(i,0)}function X(o){const t=R[o+x]+2,s=R[o+x]+7,c=R[o+x],v=S(t,"min7",e(h)),C=S(s,"7",e(h)),k=S(c,"maj7",e(h));return[v,C,k][e(i)]}function me(o){const t=X(o);return[t.root,t.third,t.fifth,t.seventh].filter(s=>s!=null)}function _e(o,t,s,c){const v=E(o)[e(i)];if(s.includes(t.noteNumber)){const f=c.filter(y=>s.includes(y)).length,F=s.length;return f===F?e(i)<2?(setTimeout(()=>{be(i)},1e3),{isCorrect:!0,message:Y(),collected:!0,resetCollected:!1}):{isCorrect:!0,message:Y(),collected:!0,resetCollected:!1}:{isCorrect:!0,message:`Good! ${f}/${F} notes for ${v}`,collected:!0,resetCollected:!1}}const k=s.filter(f=>!c.includes(f)).map(f=>D[f].slice(0,-1)).join(", ");return{isCorrect:!1,message:`Wrong note. For ${v} expected: ${k}`,collected:!1,resetCollected:!0}}function ge(o,t){if(t.length===0)return!1;const v=o.filter(C=>t.includes(C)).length===t.length&&e(i)===2;return v&&setTimeout(()=>{T()},2e3),v}function E(o="C"){const t=R[o+x]+2,s=R[o+x]+7,c=R[o+x];return[`${D[t].slice(0,-1)}m7`,`${D[s].slice(0,-1)}7`,`${D[c].slice(0,-1)}maj7`]}function Y(){return e(i)<2?`Great! Now play ${E()[e(i)+1]}`:"Perfect! Complete ii-V-I progression! ðŸŽµâœ¨"}function he(o){const t=o.target;q(h,parseInt(t.value),!0),T()}function Ce(o){const t=o.target;q(I,t.value,!0),T()}function je(o){const t=X(o);return{...$e(t,e(I)),selectedNote:o}}var K=Be(),ke=p(K);Le(ke,{get randomMode(){return b()},generateExpectedNotes:me,generateScoreProps:je,validateNoteEvent:_e,isCompleted:ge,onReset:pe,"onComplete}":!0,get initialNote(){return e(fe)},description:ue,exerciseType:"progression",children:(t,s=Pe)=>{const c=L(()=>e(w)),v=L(()=>s().completed);var C=Ue(),k=O(C);{var f=r=>{var l=se();P(()=>$(l,q(w,!0))),g(r,l)},F=r=>{var l=Ie(),m=O(l);{var a=u=>{var _=se();P(()=>$(_,q(w,!1))),g(u,_)};A(m,u=>{!e(v)&&e(c)&&u(a)},!0)}g(r,l)};A(k,r=>{e(v)&&!e(c)?r(f):r(F,!1)})}var y=n(k,2),z=p(y);{var qe=r=>{var l=Ae(),m=O(l),a=n(p(m),2);a.__change=he;var u=p(a);u.value=u.__value=0;var _=n(u);_.value=_.__value=1;var B=n(_);B.value=B.__value=2;var Z=n(B);Z.value=Z.__value=3,d(a);var ee;ne(a),d(m);var te=n(m,2),j=n(p(te),2);j.__change=Ce;var G=p(j);G.value=G.__value="full-right";var H=n(G);H.value=H.__value="full-left";var W=n(H);W.value=W.__value="1735";var oe=n(W);oe.value=oe.__value="1537",d(j);var re;ne(j),d(te),P(()=>{ee!==(ee=e(h))&&(a.value=(a.__value=e(h))??"",ie(a,e(h))),re!==(re=e(I))&&(j.value=(j.__value=e(I))??"",ie(j,e(I)))}),g(r,l)};A(z,r=>{!b()&&!ce.url.searchParams.get("unitId")&&r(qe)})}var J=n(z,2);Te(J,21,()=>E(s().selectedNote),Fe,(r,l,m)=>{var a=De();let u;var _=p(a,!0);d(a),P(()=>{u=Ee(a,1,"chord-indicator svelte-1jk8q9u",null,u,{active:m===e(i),completed:m<e(i)}),$(_,e(l))}),g(r,a)}),d(J),d(y);var Q=n(y,2),U=p(Q),Re=p(U);d(U);var xe=n(U,2);{var Me=r=>{var l=Ke();g(r,l)};A(xe,r=>{s().completed&&r(Me)})}d(Q),P(r=>$(Re,`Current: ${r??""} (${e(i)+1}/3)`),[()=>E(s().selectedNote)[e(i)]]),g(t,C)},$$slots:{default:!0}}),d(K),g(ve,K),Ve()}we(["change"]);export{Ze as component};
