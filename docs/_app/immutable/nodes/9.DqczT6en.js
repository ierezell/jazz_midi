import"../chunks/CWj6FrbW.js";import{d as we,o as ye,s as _}from"../chunks/BmhLxRLF.js";import{p as ke,o as d,q as X,f as y,a as De,d as n,s as g,t as Y,b as w,k as e,c as Ee,v as o,w as t,r as i,y as Z}from"../chunks/CiAnzwjR.js";import{i as Te}from"../chunks/9NUL7pul.js";import{e as Pe,M as j,m as ee,i as Se,N as q,c as B}from"../chunks/X11iEPzw.js";import{s as Ie}from"../chunks/BW5o5L06.js";import{B as Re,m as N,a as G}from"../chunks/DfZBKltH.js";import{u as Ve}from"../chunks/DZz6v8Gc.js";import{c as je}from"../chunks/CoExbraD.js";var qe=y("<div> </div>"),Be=y('<div class="completion svelte-453sxh">ðŸŽ‰ ii-V-I Completed!</div>'),Ge=y('<div class="progression-controls svelte-453sxh"><div class="control-group svelte-453sxh"><button class="debug-btn svelte-453sxh"> </button> <button class="reset-btn svelte-453sxh">Reset</button></div> <div class="chord-progress svelte-453sxh"></div></div> <div class="exercise-status svelte-453sxh"><div class="current-chord svelte-453sxh"> </div> <div class="progress svelte-453sxh"> </div> <div class="mistakes svelte-453sxh"> </div> <!></div>',1),Ke=y('<div class="progression-exercise svelte-453sxh"><!></div>');function Xe(te,se){ke(se,!0);let a=d("C"),r=d(0),u=d(X([])),c=d(0),$=d(!1),f=d(!1),h=d(""),K=d(X(Date.now())),oe=t(()=>e(c)>=3),re=t(()=>e(c)>=6),k=t(()=>e(u).map(s=>s.noteNumber)),z=t(()=>q[e(a)+"4"]+2),W=t(()=>q[e(a)+"4"]+7),A=t(()=>q[e(a)+"4"]),ie=t(()=>B(e(z),"min7")),ae=t(()=>B(e(W),"7")),le=t(()=>B(e(A),"maj7")),ne=t(()=>[e(ie),e(ae),e(le)]),p=t(()=>[`${j[e(z)].slice(0,-1)}m7`,`${j[e(W)].slice(0,-1)}7`,`${j[e(A)].slice(0,-1)}maj7`]),x=t(()=>e(ne)[e(r)]),F=t(()=>[e(x).root,e(x).third,e(x).fifth,e(x).seventh].filter(s=>s!=null)),v=t(()=>e(F)),de=t(()=>je(e(x))),ce=t(()=>({selectedNote:e(a),midiNotes:e(k),noteEvents:e(u),debugMode:e(f),showNoteNames:e(oe),showKeyboard:e(re),feedbackMessage:e(h),errorCount:e(c),completed:e($)})),ve=t(()=>({notes:e(F).map(s=>ee(s)),highlightedNotes:e(k).map(s=>ee(s)),title:`${e(a)} ii-V-I: ${e(p)[e(r)]} (${e(r)+1}/3)`}));function ue(s){o(a,s,!0),D()}function H(){o(f,!e(f)),e(f)?N.enableDebugMode():N.disableDebugMode()}function D(){o(c,0),o(u,[],!0),o($,!1),o(r,0),o(h,""),o(K,Date.now(),!0),N.resetExercise()}function he(){if(e(r)<2)Z(r),o(h,`Great! Now play ${e(p)[e(r)]}`);else{o($,!0),o(h,`Perfect! Complete ${e(a)} ii-V-I progression! ðŸŽµâœ¨`),G.playSuccess();const s=(Date.now()-e(K))/1e3,m=Math.round(12/(12+e(c))*100);Ve.updateNoteProgress(e(a),"progression",void 0,!0,s,m)}}function pe(s){if(o(u,[s,...e(u).slice(0,9)],!0),s.type==="on")if(e(v).includes(s.noteNumber)){const m=e(u).filter(b=>b.type==="on").filter(b=>e(v).includes(b.noteNumber));m.length===e(v).length?he():o(h,`Good! ${m.length}/${e(v).length} notes for ${e(p)[e(r)]}`)}else Z(c),o(h,`Wrong note! Expected: ${e(p)[e(r)]}`),G.playError()}ye(()=>(N.connect(pe),G.initialize(),()=>{N.disconnect()}));var E=Ke(),me=n(E);{let s=t(()=>`${e(a)} ii-V-I Progression`),m=t(()=>({chordToneInfo:e(de),showChordTones:!0}));Re(me,{get exerciseState(){return e(ce)},get exerciseTitle(){return e(s)},exerciseDescription:"Play each chord in sequence: ii7 - V7 - Imaj7",get expectedNotes(){return e(v)},get scoreProps(){return e(ve)},get keyboardProps(){return e(m)},onNoteSelect:ue,onDebugToggle:H,onReset:D,customControls:!0,children:(b,ze)=>{var J=Ge(),T=De(J),P=n(T),C=n(P);C.__click=H;var ge=n(C);i(C);var fe=g(C,2);fe.__click=D,i(P);var L=g(P,2);Pe(L,21,()=>e(p),Se,(l,V,Q)=>{var M=qe();let U;var Ce=n(M,!0);i(M),Y(Me=>{U=Ie(M,1,"chord-indicator svelte-453sxh",null,U,Me),_(Ce,e(V))},[()=>({active:Q===e(r),completed:Q<e(r)})]),w(l,M)}),i(L),i(T);var O=g(T,2),S=n(O),xe=n(S);i(S);var I=g(S,2),be=n(I);i(I);var R=g(I,2),_e=n(R);i(R);var Ne=g(R,2);{var $e=l=>{var V=Be();w(l,V)};Te(Ne,l=>{e($)&&l($e)})}i(O),Y(l=>{_(ge,`${e(f)?"Disable":"Enable"} Debug Mode`),_(xe,`Current: ${e(p)[e(r)]??""} (${e(r)+1}/3)`),_(be,`Progress: ${l??""}%`),_(_e,`Mistakes: ${e(c)??""}`)},[()=>Math.round(e(k).filter(l=>e(v).includes(l)).length/e(v).length*100)]),w(b,J)},$$slots:{default:!0}})}i(E),w(te,E),Ee()}we(["click"]);export{Xe as component};
