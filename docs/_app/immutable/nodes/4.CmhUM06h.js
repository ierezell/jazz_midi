import"../chunks/NZTpNUN0.js";import{p as ue,N as H,O as I,c as fe,P as _e,f as K,a as P,k as e,R as Z,s as n,d as C,r as c,b as T,Q as x,S as $,t as E,T as he}from"../chunks/DPDCOiIW.js";import{d as ge,s as B}from"../chunks/ZRc7GTJ1.js";import{i as G}from"../chunks/CPFqVV7e.js";import{f as ee,N as pe,D as me,e as Ce,i as Me,b as be}from"../chunks/Dh5yjYp3.js";import{i as O,s as S}from"../chunks/abe3cog1.js";import{B as ye,g as Te,a as xe}from"../chunks/DkJRdrwJ.js";function Ne(u,t){const d=u.target;x(t,d.value,!0)}function je(u,t){const d=u.target;x(t,parseInt(d.value),!0)}function ke(u,t){const d=u.target;x(t,d.value,!0)}var He=K("<option> </option>"),Ee=K('<div class="control-group svelte-t0jkd5"><label for="chord-type" class="svelte-t0jkd5">Chord Type:</label> <select id="chord-type"></select></div> <div class="control-group svelte-t0jkd5"><label for="inversion" class="svelte-t0jkd5">Inversion:</label> <select id="inversion"><option>Root</option><option>1st</option><option>2nd</option><option>3rd</option></select></div> <div class="control-group svelte-t0jkd5"><label for="voicing" class="svelte-t0jkd5">Voicing:</label> <select id="voicing"><option>Full Right Hand</option><option>Full Left Hand</option><option>1 & 7 Left / 3 & 5 Right</option><option>1 & 5 Left / 3 & 7 Right</option></select></div>',1),Re=K('<!> <div class="controls svelte-t0jkd5"><!></div>',1);function Pe(u,t){ue(t,!0);let d=["maj7","min7","7","dom7","half-dim7","dim7"],f=H(I(t.chordType??(t.randomMode?d[Math.floor(Math.random()*d.length)]:"maj7"))),_=H(I(t.inversion??(t.randomMode?Math.floor(Math.random()*4):0))),h=H(I(t.voicing??(t.randomMode?ee[Math.floor(Math.random()*ee.length)]:"full-right"))),k=H(!1);function te(){x(k,!1)}function oe(l){const a=l+me,g=pe[a],o=xe(g,e(f),e(_)),M=[o.root,o.third,o.fifth,o.seventh].filter(r=>r!==void 0);switch(e(h)){case"full-right":return M;case"full-left":return M.map(r=>r-12).filter(r=>r>=24);case"1735":return[o.root-12,(o.seventh||o.root)-12,o.third,o.fifth].filter(r=>r!==void 0&&r>=24);case"1537":return[o.root-12,o.fifth-12,o.third,o.seventh||o.root].filter(r=>r!==void 0&&r>=24);default:return M}}function ae(l,a,g){return g.includes(a.noteNumber)?{isCorrect:!0,message:"Correct chord tone!",collected:!0,resetCollected:!1}:{isCorrect:!1,message:"Not a chord tone. Try again!",collected:!1,resetCollected:!0}}function re(l){try{const a=Te(l,e(f),e(_),e(h));return console.debug("Generated score data:",{selectedNote:l,chordType:e(f),voicing:e(h),inversion:e(_),scoreData:a}),{leftHand:a.leftHand,rightHand:a.rightHand,selectedNote:l}}catch(a){return console.error("Error generating score data:",a),{selectedNote:"C",leftHand:[[]],rightHand:[["C4","E4","G4"]]}}}function ne(l,a){return l.length===a.length&&l.every(g=>a.includes(g))}ye(u,{get randomMode(){return t.randomMode},generateExpectedNotes:oe,generateScoreProps:re,validateNoteEvent:ae,isCompleted:ne,onReset:te,get onComplete(){return t.onComplete},get initialNote(){return t.rootKey},children:(a,g=_e)=>{var o=Re();const M=Z(()=>e(k)),r=Z(()=>g().completed);var Q=P(o);{var le=i=>{var v=$();E(()=>B(v,x(k,!0))),T(i,v)},ie=i=>{var v=he(),N=P(v);{var s=b=>{var y=$();E(()=>B(y,x(k,!1))),T(b,y)};G(N,b=>{!e(r)&&e(M)&&b(s)},!0)}T(i,v)};G(Q,i=>{e(r)&&!e(M)?i(le):i(ie,!1)})}var U=n(Q,2),se=C(U);{var de=i=>{var v=Ee(),N=P(v),s=n(C(N),2);s.__change=[Ne,f],Ce(s,21,()=>be,Me,(ve,F)=>{var j=He(),ce=C(j,!0);c(j);var Y={};E(()=>{B(ce,e(F)),Y!==(Y=e(F))&&(j.value=(j.__value=e(F))??"")}),T(ve,j)}),c(s);var b;O(s),c(N);var y=n(N,2),p=n(C(y),2);p.__change=[je,_];var R=C(p);R.value=R.__value=0;var A=n(R);A.value=A.__value=1;var D=n(A);D.value=D.__value=2;var q=n(D);q.value=q.__value=3,c(p);var z;O(p),c(y);var J=n(y,2),m=n(C(J),2);m.__change=[ke,h];var L=C(m);L.value=L.__value="full-right";var V=n(L);V.value=V.__value="full-left";var w=n(V);w.value=w.__value="1735";var W=n(w);W.value=W.__value="1537",c(m);var X;O(m),c(J),E(()=>{b!==(b=e(f))&&(s.value=(s.__value=e(f))??"",S(s,e(f))),z!==(z=e(_))&&(p.value=(p.__value=e(_))??"",S(p,e(_))),X!==(X=e(h))&&(m.value=(m.__value=e(h))??"",S(m,e(h)))}),T(i,v)};G(se,i=>{t.randomMode||i(de)})}c(U),T(a,o)},$$slots:{default:!0}}),fe()}ge(["change"]);export{Pe as component};
