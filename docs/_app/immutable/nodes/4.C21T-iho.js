import"../chunks/NZTpNUN0.js";import{p as ue,ao as H,Q as I,c as fe,ap as _e,f as O,a as B,k as e,aq as Z,s as n,d as C,r as c,b as T,R as x,ar as $,t as E,as as he}from"../chunks/u8fP_b2Q.js";import{d as ge,s as G}from"../chunks/isL9873N.js";import{i as P}from"../chunks/Cj8lQ-n9.js";import{f as ee,N as pe,D as me,e as Ce,i as Me,b as be}from"../chunks/DmnNUe2y.js";import{i as q,s as K}from"../chunks/CXakw2E1.js";import{B as ye,g as Te,a as xe}from"../chunks/CZxLfcpG.js";function je(u,t){const d=u.target;x(t,d.value,!0)}function ke(u,t){const d=u.target;x(t,parseInt(d.value),!0)}function Ne(u,t){const d=u.target;x(t,d.value,!0)}var He=O("<option> </option>"),Ee=O('<div class="control-group svelte-t0jkd5"><label for="chord-type" class="svelte-t0jkd5">Chord Type:</label> <select id="chord-type"></select></div> <div class="control-group svelte-t0jkd5"><label for="inversion" class="svelte-t0jkd5">Inversion:</label> <select id="inversion"><option>Root</option><option>1st</option><option>2nd</option><option>3rd</option></select></div> <div class="control-group svelte-t0jkd5"><label for="voicing" class="svelte-t0jkd5">Voicing:</label> <select id="voicing"><option>Full Right Hand</option><option>Full Left Hand</option><option>1 & 7 Left / 3 & 5 Right</option><option>1 & 5 Left / 3 & 7 Right</option></select></div>',1),Re=O('<!> <div class="controls svelte-t0jkd5"><!></div>',1);function Be(u,t){ue(t,!0);let d=["maj7","min7","7","dom7","half-dim7","dim7"],f=H(I(t.chordType??(t.randomMode?d[Math.floor(Math.random()*d.length)]:"maj7"))),_=H(I(t.inversion??(t.randomMode?Math.floor(Math.random()*4):0))),h=H(I(t.voicing??(t.randomMode?ee[Math.floor(Math.random()*ee.length)]:"full-right"))),N=H(!1);function te(){x(N,!1)}function oe(l){const a=l+me,g=pe[a],o=xe(g,e(f),e(_)),M=[o.root,o.third,o.fifth,o.seventh].filter(r=>r!==void 0);switch(e(h)){case"full-right":return M;case"full-left":return M.map(r=>r-12).filter(r=>r>=24);case"1735":return[o.root-12,(o.seventh||o.root)-12,o.third,o.fifth].filter(r=>r!==void 0&&r>=24);case"1537":return[o.root-12,o.fifth-12,o.third,o.seventh||o.root].filter(r=>r!==void 0&&r>=24);default:return M}}function ae(l,a,g){return g.includes(a.noteNumber)?{isCorrect:!0,message:"Correct chord tone!",collected:!0,resetCollected:!1}:{isCorrect:!1,message:"Not a chord tone. Try again!",collected:!1,resetCollected:!0}}function re(l){try{const a=Te(l,e(f),e(_),e(h));return console.debug("Generated score data:",{selectedNote:l,chordType:e(f),voicing:e(h),inversion:e(_),scoreData:a}),{leftHand:a.leftHand,rightHand:a.rightHand,selectedNote:l}}catch(a){return console.error("Error generating score data:",a),{selectedNote:"C",leftHand:[[]],rightHand:[["C4","E4","G4"]]}}}function ne(l,a){return l.length===a.length&&l.every(g=>a.includes(g))}ye(u,{get randomMode(){return t.randomMode},generateExpectedNotes:oe,generateScoreProps:re,validateNoteEvent:ae,isCompleted:ne,onReset:te,get onComplete(){return t.onComplete},get initialNote(){return t.rootKey},children:(a,g=_e)=>{var o=Re();const M=Z(()=>e(N)),r=Z(()=>g().completed);var Q=B(o);{var le=i=>{var v=$();E(()=>G(v,x(N,!0))),T(i,v)},ie=i=>{var v=he(),j=B(v);{var s=b=>{var y=$();E(()=>G(y,x(N,!1))),T(b,y)};P(j,b=>{!e(r)&&e(M)&&b(s)},!0)}T(i,v)};P(Q,i=>{e(r)&&!e(M)?i(le):i(ie,!1)})}var S=n(Q,2),se=C(S);{var de=i=>{var v=Ee(),j=B(v),s=n(C(j),2);s.__change=[je,f],Ce(s,21,()=>be,Me,(ve,F)=>{var k=He(),ce=C(k,!0);c(k);var Y={};E(()=>{G(ce,e(F)),Y!==(Y=e(F))&&(k.value=(k.__value=e(F))??"")}),T(ve,k)}),c(s);var b;q(s),c(j);var y=n(j,2),p=n(C(y),2);p.__change=[ke,_];var R=C(p);R.value=R.__value=0;var A=n(R);A.value=A.__value=1;var D=n(A);D.value=D.__value=2;var U=n(D);U.value=U.__value=3,c(p);var z;q(p),c(y);var J=n(y,2),m=n(C(J),2);m.__change=[Ne,h];var L=C(m);L.value=L.__value="full-right";var V=n(L);V.value=V.__value="full-left";var w=n(V);w.value=w.__value="1735";var W=n(w);W.value=W.__value="1537",c(m);var X;q(m),c(J),E(()=>{b!==(b=e(f))&&(s.value=(s.__value=e(f))??"",K(s,e(f))),z!==(z=e(_))&&(p.value=(p.__value=e(_))??"",K(p,e(_))),X!==(X=e(h))&&(m.value=(m.__value=e(h))??"",K(m,e(h)))}),T(i,v)};P(se,i=>{t.randomMode||i(de)})}c(S),T(a,o)},$$slots:{default:!0}}),fe()}ge(["change"]);export{Be as component};
