import"../chunks/NZTpNUN0.js";import{p as Re,O as A,P as le,g as xe,k as e,f as N,Q as Me,b as C,c as be,R as b,az as Ie,d as m,a as J,s as n,t as F,S as D,r as f,T as ie,V as Ve}from"../chunks/DFYG1ZU2.js";import{d as we,s as B}from"../chunks/BgsxT_DW.js";import{i as G}from"../chunks/iFgn1dkZ.js";import{f as ce,M as H,e as Pe,N as x,D as M,i as Te}from"../chunks/Cxn_sF4j.js";import{i as ve,s as ue,c as Ee}from"../chunks/DD47jCIl.js";import{p as Fe}from"../chunks/B07LwgKQ.js";import{B as Ne,b as ye,a as X}from"../chunks/CcldRWvO.js";function Le(I,l,V){const g=I.target;b(l,parseInt(g.value),!0),V()}function Ae(I,l,V){const g=I.target;b(l,g.value,!0),V()}var De=N('<div class="control-group svelte-1jk8q9u"><label for="inversion" class="svelte-1jk8q9u">Inversion:</label> <select id="inversion" class="svelte-1jk8q9u"><option class="svelte-1jk8q9u">Root</option><option class="svelte-1jk8q9u">1st</option><option class="svelte-1jk8q9u">2nd</option><option class="svelte-1jk8q9u">3rd</option></select></div> <div class="control-group svelte-1jk8q9u"><label for="voicing" class="svelte-1jk8q9u">Voicing:</label> <select id="voicing" class="svelte-1jk8q9u"><option class="svelte-1jk8q9u">Full Right Hand</option><option class="svelte-1jk8q9u">Full Left Hand</option><option class="svelte-1jk8q9u">1 & 7 Left / 3 & 5 Right</option><option class="svelte-1jk8q9u">1 & 5 Left / 3 & 7 Right</option></select></div>',1),Be=N("<div> </div>"),Ge=N('<div class="completion svelte-1jk8q9u">ðŸŽ‰ ii-V-I Completed!</div>'),He=N('<!> <div class="progression-controls svelte-1jk8q9u"><!> <div class="chord-progress svelte-1jk8q9u"></div></div> <div class="exercise-status svelte-1jk8q9u"><div class="current-chord svelte-1jk8q9u"> </div> <!></div>',1),Oe=N('<div class="progression-exercise svelte-1jk8q9u"><!></div>');function Ye(I,l){Re(l,!0);const V="Play the II-V-I progression as shown. Use the correct chords and voicings for each step.";let g=Fe(l,"randomMode",3,!1),i=A(0),j=A(le(l.inversion??(g()?Math.floor(Math.random()*4):0))),w=A(le(l.voicing??(g()?ce[Math.floor(Math.random()*ce.length)]:"full-right"))),P=A(!1);function de(){y(),b(P,!1)}xe(()=>{e(P)&&l.onComplete&&l.onComplete()});function y(){b(i,0)}function Y(t){const o=x[t+M]+2,a=x[t+M]+7,_=x[t+M],c=X(o,"min7",e(j)),k=X(a,"7",e(j)),R=X(_,"maj7",e(j));return[c,k,R][e(i)]}function fe(t){const o=Y(t);return[o.root,o.third,o.fifth,o.seventh].filter(a=>a!=null)}function _e(t,o,a,_){const c=L(t)[e(i)];if(a.includes(o.noteNumber)){const u=_.filter(S=>a.includes(S)).length,T=a.length;return u===T?e(i)<2?(setTimeout(()=>{Ie(i)},1e3),{isCorrect:!0,message:Z(),collected:!0,resetCollected:!1}):{isCorrect:!0,message:Z(),collected:!0,resetCollected:!1}:{isCorrect:!0,message:`Good! ${u}/${T} notes for ${c}`,collected:!0,resetCollected:!1}}const R=a.filter(u=>!_.includes(u)).map(u=>H[u].slice(0,-1)).join(", ");return{isCorrect:!1,message:`Wrong note. For ${c} expected: ${R}`,collected:!1,resetCollected:!0}}function me(t,o){if(o.length===0)return!1;const c=t.filter(k=>o.includes(k)).length===o.length&&e(i)===2;return c&&setTimeout(()=>{y()},2e3),c}function L(t="C"){const o=x[t+M]+2,a=x[t+M]+7,_=x[t+M];return[`${H[o].slice(0,-1)}m7`,`${H[a].slice(0,-1)}7`,`${H[_].slice(0,-1)}maj7`]}function Z(){return e(i)<2?`Great! Now play ${L()[e(i)+1]}`:"Perfect! Complete ii-V-I progression! ðŸŽµâœ¨"}function ge(t){const o=Y(t);return{...ye(o,e(w)),selectedNote:t}}var O=Oe(),he=m(O);{const t=(_,c=Me)=>{const k=D(()=>e(P)),R=D(()=>c().completed);var u=He(),T=J(u);{var S=r=>{var v=ie();F(()=>B(v,b(P,!0))),C(r,v)},pe=r=>{var v=Ve(),h=J(v);{var s=d=>{var p=ie();F(()=>B(p,b(P,!1))),C(d,p)};G(h,d=>{!e(R)&&e(k)&&d(s)},!0)}C(r,v)};G(T,r=>{e(R)&&!e(k)?r(S):r(pe,!1)})}var U=n(T,2),$=m(U);{var Ce=r=>{var v=De(),h=J(v),s=n(m(h),2);s.__change=[Le,j,y];var d=m(s);d.value=d.__value=0;var p=n(d);p.value=p.__value=1;var E=n(p);E.value=E.__value=2;var oe=n(E);oe.value=oe.__value=3,f(s);var re;ve(s),f(h);var se=n(h,2),q=n(m(se),2);q.__change=[Ae,w,y];var K=m(q);K.value=K.__value="full-right";var Q=n(K);Q.value=Q.__value="full-left";var W=n(Q);W.value=W.__value="1735";var ae=n(W);ae.value=ae.__value="1537",f(q);var ne;ve(q),f(se),F(()=>{re!==(re=e(j))&&(s.value=(s.__value=e(j))??"",ue(s,e(j))),ne!==(ne=e(w))&&(q.value=(q.__value=e(w))??"",ue(q,e(w)))}),C(r,v)};G($,r=>{g()||r(Ce)})}var ee=n($,2);Pe(ee,21,()=>L(c().selectedNote),Te,(r,v,h)=>{var s=Be();let d;var p=m(s,!0);f(s),F(E=>{d=Ee(s,1,"chord-indicator svelte-1jk8q9u",null,d,E),B(p,e(v))},[()=>({active:h===e(i),completed:h<e(i)})]),C(r,s)}),f(ee),f(U);var te=n(U,2),z=m(te),je=m(z);f(z);var ke=n(z,2);{var qe=r=>{var v=Ge();C(r,v)};G(ke,r=>{c().completed&&r(qe)})}f(te),F(r=>B(je,`Current: ${r??""} (${e(i)+1}/3)`),[()=>L(c().selectedNote)[e(i)]]),C(_,u)};let o=D(()=>l.onComplete||(()=>{})),a=D(()=>l.rootKey||"C");Ne(he,{get randomMode(){return g()},generateExpectedNotes:fe,generateScoreProps:ge,validateNoteEvent:_e,isCompleted:me,onReset:de,get onComplete(){return e(o)},get initialNote(){return e(a)},description:V,children:t,$$slots:{default:!0}})}f(O),C(I,O),be()}we(["change"]);export{Ye as component};
