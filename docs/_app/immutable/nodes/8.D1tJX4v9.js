import"../chunks/NZTpNUN0.js";import{p as ge,ap as T,R as oe,g as Ce,k as e,f as V,b as C,c as qe,aU as ze,d as p,a as D,s as i,t as E,av as xe,S as N,aq as re,r as u,as as ae,ar as Me}from"../chunks/wFTEGHnI.js";import{d as be,s as F}from"../chunks/BJdPA1W9.js";import{i as S}from"../chunks/DB4UBEnh.js";import{d as se,e as Re,M as L,N as M,i as we}from"../chunks/M4Hk-hxN.js";import{i as ne,g as ie,b as Ie}from"../chunks/BBAnfavV.js";import{p as Ee}from"../chunks/BrqRBW94.js";import{B as Ne,a as Ve,c as U}from"../chunks/BywGZpRb.js";function Pe(b,v,m){const r=b.target;N(v,parseInt(r.value),!0),m()}function Te(b,v,m){const r=b.target;N(v,r.value,!0),m()}var Fe=V('<div class="control-group svelte-1qz769a"><label for="inversion" class="svelte-1qz769a">Inversion:</label> <select id="inversion" class="svelte-1qz769a"><option class="svelte-1qz769a">Root</option><option class="svelte-1qz769a">1st</option><option class="svelte-1qz769a">2nd</option><option class="svelte-1qz769a">3rd</option></select></div> <div class="control-group svelte-1qz769a"><label for="voicing" class="svelte-1qz769a">Voicing:</label> <select id="voicing" class="svelte-1qz769a"><option class="svelte-1qz769a">Full</option><option class="svelte-1qz769a">Left Hand</option><option class="svelte-1qz769a">Right Hand</option><option class="svelte-1qz769a">Split</option></select></div>',1),Se=V("<div> </div>"),je=V('<div class="completion svelte-1qz769a">ðŸŽ‰ ii-V-I Completed!</div>'),ke=V('<!> <div class="progression-controls svelte-1qz769a"><!> <div class="chord-progress svelte-1qz769a"></div></div> <div class="exercise-status svelte-1qz769a"><div class="current-chord svelte-1qz769a"> </div> <!></div>',1),ye=V('<div class="progression-exercise svelte-1qz769a"><!></div>');function $e(b,v){ge(v,!0);let m=Ee(v,"randomMode",3,!1),r=T(0),q=T(oe(v.inversion??(m()?Math.floor(Math.random()*4):0))),R=T(oe(v.voicing??(m()?se[Math.floor(Math.random()*se.length)]:"full"))),P=T(!1);Ce(()=>{e(P)&&v.onComplete&&v.onComplete()});function j(){N(r,0)}function W(a){const t=M[a+"4"]+2,s=M[a+"4"]+7,f=M[a+"4"],c=U(t,"min7",e(q)),_=U(s,"7",e(q)),x=U(f,"maj7",e(q));return[c,_,x][e(r)]}function le(a){const t=W(a);return[t.root,t.third,t.fifth,t.seventh].filter(s=>s!=null)}function ve(a,t,s,f){if(s.includes(t.noteNumber)){const c=f.filter(x=>s.includes(x)).length,_=s.length;return c===_?e(r)<2?(setTimeout(()=>{xe(r)},1e3),{isCorrect:!0,message:$()}):{isCorrect:!0,message:$()}:{isCorrect:!0,message:`Good! ${c}/${_} notes for ${w(a)[e(r)]}`}}return{isCorrect:!1,message:`Wrong note! Expected: ${w()[e(r)]}`}}function ce(a,t){if(t.length===0)return!1;const c=a.filter(_=>t.includes(_)).length===t.length&&e(r)===2;return c&&setTimeout(()=>{j()},2e3),c}function w(a="C"){const t=M[a+"4"]+2,s=M[a+"4"]+7,f=M[a+"4"];return[`${L[t].slice(0,-1)}m7`,`${L[s].slice(0,-1)}7`,`${L[f].slice(0,-1)}maj7`]}function $(){return e(r)<2?`Great! Now play ${w()[e(r)+1]}`:"Perfect! Complete ii-V-I progression! ðŸŽµâœ¨"}function de(a){const t=W(a);return{...Ve(t,e(R)),selectedNote:a}}var k=ye(),ue=p(k);Ne(ue,{get randomMode(){return m()},generateExpectedNotes:le,generateScoreProps:de,validateNoteEvent:ve,isCompleted:ce,children:(t,s=ze)=>{var f=ke();const c=re(()=>e(P)),_=re(()=>s().completed);var x=D(f);{var J=o=>{var l=ae();E(()=>F(l,N(P,!0))),C(o,l)},fe=o=>{var l=Me(),h=D(l);{var n=d=>{var g=ae();E(()=>F(g,N(P,!1))),C(d,g)};S(h,d=>{!e(_)&&e(c)&&d(n)},!0)}C(o,l)};S(x,o=>{e(_)&&!e(c)?o(J):o(fe,!1)})}var y=i(x,2),K=p(y);{var _e=o=>{var l=Fe(),h=D(l),n=i(p(h),2);n.__change=[Pe,q,j];var d=p(n);d.value=d.__value=0;var g=i(d);g.value=g.__value=1;var I=i(g);I.value=I.__value=2;var X=i(I);X.value=X.__value=3,u(n);var Y;ne(n),u(h);var Z=i(h,2),z=i(p(Z),2);z.__change=[Te,R,j];var G=p(z);G.value=G.__value="full";var H=i(G);H.value=H.__value="left-hand";var A=i(H);A.value=A.__value="right-hand";var ee=i(A);ee.value=ee.__value="split",u(z);var te;ne(z),u(Z),E(()=>{Y!==(Y=e(q))&&(n.value=(n.__value=e(q))??"",ie(n,e(q))),te!==(te=e(R))&&(z.value=(z.__value=e(R))??"",ie(z,e(R)))}),C(o,l)};S(K,o=>{m()||o(_e)})}var O=i(K,2);Re(O,21,()=>w(s().selectedNote),we,(o,l,h)=>{var n=Se();let d;var g=p(n,!0);u(n),E(I=>{d=Ie(n,1,"chord-indicator svelte-1qz769a",null,d,I),F(g,e(l))},[()=>({active:h===e(r),completed:h<e(r)})]),C(o,n)}),u(O),u(y);var Q=i(y,2),B=p(Q),pe=p(B);u(B);var me=i(B,2);{var he=o=>{var l=je();C(o,l)};S(me,o=>{s().completed&&o(he)})}u(Q),E(o=>F(pe,`Current: ${o??""} (${e(r)+1}/3)`),[()=>w(s().selectedNote)[e(r)]]),C(t,f)},$$slots:{default:!0}}),u(k),C(b,k),qe()}be(["change"]);export{$e as component};
