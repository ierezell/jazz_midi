import"../chunks/NZTpNUN0.js";import{p as pe,ap as E,R as Z,g as fe,k as e,f as P,b as z,c as _e,aU as he,d as p,a as ee,s as n,t as T,av as ge,S as w,r as v,as as me}from"../chunks/wFTEGHnI.js";import{d as Ce,s as D}from"../chunks/BJdPA1W9.js";import{i as G}from"../chunks/DB4UBEnh.js";import{d as oe,e as qe,M as H,N as x,i as ze}from"../chunks/M4Hk-hxN.js";import{i as te,g as re,b as xe}from"../chunks/BBAnfavV.js";import{p as Me}from"../chunks/BrqRBW94.js";import{B as be,a as Re,c as A}from"../chunks/CL49KPEd.js";function Ie(M,l,f){const t=M.target;w(l,parseInt(t.value),!0),f()}function Ve(M,l,f){const t=M.target;w(l,t.value,!0),f()}var Pe=P('<div class="control-group svelte-1qz769a"><label for="inversion" class="svelte-1qz769a">Inversion:</label> <select id="inversion" class="svelte-1qz769a"><option class="svelte-1qz769a">Root</option><option class="svelte-1qz769a">1st</option><option class="svelte-1qz769a">2nd</option><option class="svelte-1qz769a">3rd</option></select></div> <div class="control-group svelte-1qz769a"><label for="voicing" class="svelte-1qz769a">Voicing:</label> <select id="voicing" class="svelte-1qz769a"><option class="svelte-1qz769a">Full</option><option class="svelte-1qz769a">Left Hand</option><option class="svelte-1qz769a">Right Hand</option><option class="svelte-1qz769a">Split</option></select></div>',1),Ee=P("<div> </div>"),Te=P('<div class="completion svelte-1qz769a">ðŸŽ‰ ii-V-I Completed!</div>'),we=P('<!> <div class="progression-controls svelte-1qz769a"><!> <div class="chord-progress svelte-1qz769a"></div></div> <div class="exercise-status svelte-1qz769a"><div class="current-chord svelte-1qz769a"> </div> <!></div>',1),Ne=P('<div class="progression-exercise svelte-1qz769a"><!></div>');function Ge(M,l){pe(l,!0);let f=Me(l,"randomMode",3,!1),t=E(0),h=E(Z(l.inversion??(f()?Math.floor(Math.random()*4):0))),b=E(Z(l.voicing??(f()?oe[Math.floor(Math.random()*oe.length)]:"full"))),N=E(!1);fe(()=>{e(N)&&l.onComplete&&l.onComplete()});function j(){w(t,0)}function L(r){const o=x[r+"4"]+2,s=x[r+"4"]+7,d=x[r+"4"],c=A(o,"min7",e(h)),_=A(s,"7",e(h)),g=A(d,"maj7",e(h));return[c,_,g][e(t)]}function se(r){const o=L(r);return[o.root,o.third,o.fifth,o.seventh].filter(s=>s!=null)}function ae(r,o,s,d){if(s.includes(o.noteNumber)){const c=d.filter(g=>s.includes(g)).length,_=s.length;return c===_?e(t)<2?(setTimeout(()=>{ge(t)},1e3),{isCorrect:!0,message:U()}):{isCorrect:!0,message:U()}:{isCorrect:!0,message:`Good! ${c}/${_} notes for ${R(r)[e(t)]}`}}return{isCorrect:!1,message:`Wrong note! Expected: ${R()[e(t)]}`}}function ne(r,o){if(o.length===0)return!1;const c=r.filter(_=>o.includes(_)).length===o.length&&e(t)===2;return c&&setTimeout(()=>{j()},2e3),c}function R(r="C"){const o=x[r+"4"]+2,s=x[r+"4"]+7,d=x[r+"4"];return[`${H[o].slice(0,-1)}m7`,`${H[s].slice(0,-1)}7`,`${H[d].slice(0,-1)}maj7`]}function U(){return e(t)<2?`Great! Now play ${R()[e(t)+1]}`:"Perfect! Complete ii-V-I progression! ðŸŽµâœ¨"}function ie(r){const o=L(r);return{...Re(o,e(b)),selectedNote:r}}var y=Ne(),le=p(y);be(le,{exerciseTitle:"ii-V-I Progression",exerciseDescription:"Play each chord in sequence: ii7 - V7 - Imaj7",get randomMode(){return f()},generateExpectedNotes:se,generateScoreProps:ie,validateNoteEvent:ae,isCompleted:ne,children:(o,s=he)=>{var d=we(),c=ee(d);{var _=a=>{var u=me();T(()=>D(u,w(N,s().completed,!0))),z(a,u)};G(c,a=>{s().completed!==e(N)&&a(_)})}var g=n(c,2),F=p(g);{var ce=a=>{var u=Pe(),C=ee(u),i=n(p(C),2);i.__change=[Ie,h,j];var q=p(i);q.value=q.__value=0;var I=n(q);I.value=I.__value=1;var V=n(I);V.value=V.__value=2;var K=n(V);K.value=K.__value=3,v(i);var O;te(i),v(C);var Q=n(C,2),m=n(p(Q),2);m.__change=[Ve,b,j];var $=p(m);$.value=$.__value="full";var k=n($);k.value=k.__value="left-hand";var B=n(k);B.value=B.__value="right-hand";var X=n(B);X.value=X.__value="split",v(m);var Y;te(m),v(Q),T(()=>{O!==(O=e(h))&&(i.value=(i.__value=e(h))??"",re(i,e(h))),Y!==(Y=e(b))&&(m.value=(m.__value=e(b))??"",re(m,e(b)))}),z(a,u)};G(F,a=>{f()||a(ce)})}var W=n(F,2);qe(W,21,()=>R(s().selectedNote),ze,(a,u,C)=>{var i=Ee();let q;var I=p(i,!0);v(i),T(V=>{q=xe(i,1,"chord-indicator svelte-1qz769a",null,q,V),D(I,e(u))},[()=>({active:C===e(t),completed:C<e(t)})]),z(a,i)}),v(W),v(g);var J=n(g,2),S=p(J),ve=p(S);v(S);var de=n(S,2);{var ue=a=>{var u=Te();z(a,u)};G(de,a=>{s().completed&&a(ue)})}v(J),T(a=>D(ve,`Current: ${a??""} (${e(t)+1}/3)`),[()=>R(s().selectedNote)[e(t)]]),z(o,d)},$$slots:{default:!0}}),v(y),z(M,y),_e()}Ce(["change"]);export{Ge as component};
