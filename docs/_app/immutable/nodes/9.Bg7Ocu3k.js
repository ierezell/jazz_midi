import{f as z,a as j}from"../chunks/CX1yysGK.js";import{a as fe}from"../chunks/FttQe9ir.js";import{p as ue,L as me,M as c,a as ve,j as e,J as x,s as v,c as r,t as q,P as pe,r as l}from"../chunks/Dpgs3mFS.js";import{d as he,s as _}from"../chunks/dcQTQ1xv.js";import{i as be}from"../chunks/FFlPY-wq.js";import{r as xe}from"../chunks/gBQeIBP2.js";import{s as B}from"../chunks/D0omyc6-.js";import{a as _e}from"../chunks/SMVfkwnP.js";import{B as ge}from"../chunks/CedzibQm.js";var ye=z('<div><span class="feedback-text svelte-14dx2m1"> </span> <span class="diff-text svelte-14dx2m1"> </span></div>'),Me=z('<div class="rhythm-container svelte-14dx2m1"><h2>Rhythm Training</h2> <div class="controls svelte-14dx2m1"><button> </button> <div class="bpm-control svelte-14dx2m1"><label for="bpm"> </label> <input id="bpm" type="range" min="40" max="200"/></div></div> <div class="visualizer svelte-14dx2m1"><div>ðŸŽµ</div> <!></div> <div class="stats"><p> </p></div></div>');function Ie(G,J){ue(J,!0);let g=x(60),d=x(!1),w=x(0),n=x(null),y=x(""),t=null,M=0,C=null,Q=25,F=.1,h=0,b=[];const K=.15;function U(){const o=60/e(g);M+=o,h++,h===4&&(h=0)}function V(o,u){if(b.push({note:o,time:u}),!t)return;const p=t.createOscillator(),i=t.createGain();p.connect(i),i.connect(t.destination),p.frequency.value=o===0?880:440,i.gain.value=.5,p.start(u),p.stop(u+.05)}function I(){if(t){for(;M<t.currentTime+F;)V(h,M),U();C=window.setTimeout(I,Q)}}function X(){e(d)||(t||(t=new AudioContext),c(d,!0),h=0,M=t.currentTime+.1,I())}function $(){c(d,!1),C&&(window.clearTimeout(C),C=null),b=[],c(n,null),c(y,"")}function Y(){e(d)?$():X()}function Z(o){return[60]}function ee(o){return{selectedNote:o,leftHand:[],rightHand:[]}}function te(o,u,p){if(!e(d)||!t)return{isCorrect:!1,message:"Start the metronome first!",collected:!1,resetCollected:!1};const i=t.currentTime;let s=1/0;b=b.filter(a=>a.time>i-1);for(const a of b){const N=a.time-i;Math.abs(N)<Math.abs(s)&&(s=N,a.time)}const f=Math.abs(s);if(c(n,s*1e3),f<=K){let a="Perfect!";return f>.05&&(a=s>0?"Early":"Late"),c(y,a,!0),pe(w),{isCorrect:!0,message:`${a} (${Math.round(s*1e3)}ms)`,collected:!0,resetCollected:!0}}else return c(y,"Miss"),{isCorrect:!1,message:`Missed! (${Math.round(s*1e3)}ms)`,collected:!1,resetCollected:!1}}function se(o,u){return!1}fe(()=>{$(),t&&t.close()}),ge(G,{randomMode:!1,generateExpectedNotes:Z,generateScoreProps:ee,validateNoteEvent:te,isCompleted:se,onReset:()=>{c(w,0),$()},onComplete:()=>{},initialNote:"C",description:"Play any note on the beat. Try to be as precise as possible!",showScore:!1,exerciseType:"rhythm",children:(u,p=me)=>{var i=Me(),s=v(r(i),2),f=r(s);let a;f.__click=Y;var N=r(f,!0);l(f);var S=v(f,2),P=r(S),ae=r(P);l(P);var E=v(P,2);xe(E),l(S),l(s);var k=v(s,2),H=r(k);let A;var re=v(H,2);{var le=m=>{var T=ye();let R;var D=r(T),oe=r(D,!0);l(D);var W=v(D,2),ie=r(W);l(W),l(T),q((ce,de)=>{R=B(T,1,"feedback-display svelte-14dx2m1",null,R,ce),_(oe,e(y)),_(ie,`${e(n)>0?"+":""}${de??""}ms`)},[()=>({success:Math.abs(e(n))<50,warn:Math.abs(e(n))>=50&&Math.abs(e(n))<150,error:Math.abs(e(n))>=150}),()=>Math.round(e(n))]),j(m,T)};be(re,m=>{e(n)!==null&&m(le)})}l(k);var L=v(k,2),O=r(L),ne=r(O);l(O),l(L),l(i),q(m=>{a=B(f,1,"play-btn svelte-14dx2m1",null,a,{playing:e(d)}),_(N,e(d)?"Stop":"Start"),_(ae,`BPM: ${e(g)??""}`),A=B(H,1,"beat-indicator svelte-14dx2m1",null,A,m),_(ne,`Hits: ${e(w)??""}`)},[()=>({pulse:e(d)&&Math.abs(e(n)||1e3)<100})]),_e(E,()=>e(g),m=>c(g,m)),j(u,i)},$$slots:{default:!0}}),ve()}he(["click"]);export{Ie as component};
