import{c as be,a as z,f as re}from"../chunks/Bdvgn338.js";import{p as ye,U as b,V as x,k as e,X as ee,a as Me,Z as p,f as xe,c as d,s as n,r as i,t as te,_ as Ne}from"../chunks/ZtE6Gyvq.js";import{d as Ie,s as Re}from"../chunks/BnZ86L-c.js";import{e as Te,i as Pe}from"../chunks/BFmSp7VO.js";import{i as Ae}from"../chunks/CdTPX8-T.js";import{i as G,r as He,s as S}from"../chunks/U2hmf67d.js";import{b as Ee}from"../chunks/CVoLLLxN.js";import{B as Ve,a as De,d as ke,g as we,e as Le}from"../chunks/BJLlDXwa.js";import{A as I,e as oe,D as Be,N as ae,b as Fe}from"../chunks/CXrKfc7O.js";import{p as j}from"../chunks/Daj7DTR9.js";var Oe=re("<option> </option>"),ze=re('<div class="controls svelte-b6xay4"><div class="control-group svelte-b6xay4"><label for="chord-type" class="svelte-b6xay4">Chord Type</label> <select id="chord-type"></select></div> <div class="control-group svelte-b6xay4"><label for="inversion" class="svelte-b6xay4">Inversion</label> <select id="inversion"><option>Root</option><option>1st</option><option>2nd</option><option>3rd</option></select></div> <div class="control-group svelte-b6xay4"><label class="svelte-b6xay4"><input type="checkbox"/> Optimized Voice Leading</label></div> <div class="control-group svelte-b6xay4"><label for="voicing" class="svelte-b6xay4">Voicing</label> <select id="voicing"><option>Full Right Hand</option><option>Full Left Hand</option><option>1 & 7 Left / 3 & 5 Right</option><option>1 & 5 Left / 3 & 7 Right</option><option>Rootless A (3-5-7-9)</option><option>Rootless B (7-9-3-5)</option></select></div></div>');function Qe(ne,r){ye(r,!0);const se="Play the notes of the displayed chord on your MIDI keyboard. Try to match the voicing and inversion shown.";let N=["maj7","min7","7","dom7","half-dim7","dim7"],v=b(x(j.url.searchParams.get("root")??r.rootKey??(r.randomMode?I[Math.floor(Math.random()*I.length)]:"C"))),u=b(x(j.url.searchParams.get("quality")??r.chordType??(r.randomMode?N[Math.floor(Math.random()*N.length)]:"maj7"))),h=b(x(r.inversion??(r.randomMode?Math.floor(Math.random()*4):0))),m=b(x(r.voicing??(r.randomMode?oe[Math.floor(Math.random()*oe.length)]:"full-right"))),R=b(!1),T=b(x([]));function le(){const o=I[Math.floor(Math.random()*I.length)],t=N[Math.floor(Math.random()*N.length)];let a;if(e(R)&&e(T).length>0){const c=o+"3",s=ae[c];a=Le(s,t,e(T))}else a=Math.floor(Math.random()*4);p(v,o,!0),p(u,t,!0),p(h,a,!0)}function ie(){const o=U(e(v));p(T,o,!0),le(),r.onComplete?.()}function U(o){const c=["C","C#","Db","D","D#","Eb","E","F","F#","Gb","G","G#","Ab","A","A#","Bb","B"].indexOf(e(v))>=10?"3":Be,s=e(v)+c,f=ae[s],l=De(f,e(u),e(h));return ke(l,e(m))}function ce(o,t,a,c){const s=a.map(l=>l%12),f=t.noteNumber%12;if(s.includes(f)){const l=a.includes(t.noteNumber),y=e(m).startsWith("rootless");return l||y?{isCorrect:!0,message:l?"Correct chord tone!":"Correct chord tone (octave ignored)!",collected:!0,resetCollected:!1}:{isCorrect:!1,message:"Correct note, but check the inversion/octave!",collected:!1,resetCollected:!0}}return{isCorrect:!1,message:"Not a chord tone. Try again!",collected:!1,resetCollected:!0}}function de(o){const t=o.target;p(u,t.value,!0)}function ve(o){const t=o.target;p(h,parseInt(t.value),!0)}function ue(o){const t=o.target;p(m,t.value,!0)}function he(o){try{const t=we(e(v),e(u),e(h),e(m));return{leftHand:t.leftHand,rightHand:t.rightHand,selectedNote:e(v)}}catch{return{selectedNote:"C",leftHand:[[]],rightHand:[["C4","E4","G4"]]}}}function me(o,t){if(e(m).startsWith("rootless")){const a=new Set(o.map(s=>s%12)),c=new Set(t.map(s=>s%12));return a.size===c.size&&[...a].every(s=>c.has(s))}return o.length===t.length&&o.every(a=>t.includes(a))}function pe(){}let fe=ee(()=>`${e(v)} ${e(u)} - ${ge(e(h))}`),_e=ee(()=>r.prompt??e(fe));function ge(o){switch(o){case 0:return"Root Position";case 1:return"1st Inversion";case 2:return"2nd Inversion";case 3:return"3rd Inversion";default:return"Root Position"}}Ve(ne,{get randomMode(){return r.randomMode},generateExpectedNotes:U,generateScoreProps:he,validateNoteEvent:ce,isCompleted:me,onReset:pe,onComplete:ie,get initialNote(){return e(v)},description:se,get progressiveHints(){return r.progressiveHints},get prompt(){return e(_e)},showTempoControl:!0,timingModeLabel:"Play chord on beat",children:t=>{var a=be(),c=xe(a);{var s=f=>{var l=ze(),y=d(l),_=n(d(y),2);_.__change=de,Te(_,21,()=>Fe,Pe,(F,O)=>{var M=Oe(),Ce=d(M,!0);i(M);var $={};te(()=>{Re(Ce,e(O)),$!==($=e(O))&&(M.value=(M.__value=e(O))??"")}),z(F,M)}),i(_);var W;G(_),i(y);var P=n(y,2),g=n(d(P),2);g.__change=ve;var A=d(g);A.value=A.__value=0;var H=n(A);H.value=H.__value=1;var E=n(H);E.value=E.__value=2;var q=n(E);q.value=q.__value=3,i(g);var K;G(g),i(P);var V=n(P,2),X=d(V),Z=d(X);He(Z),Ne(),i(X),i(V);var J=n(V,2),C=n(d(J),2);C.__change=ue;var D=d(C);D.value=D.__value="full-right";var k=n(D);k.value=k.__value="full-left";var w=n(k);w.value=w.__value="1735";var L=n(w);L.value=L.__value="1537";var B=n(L);B.value=B.__value="rootless-a";var Q=n(B);Q.value=Q.__value="rootless-b",i(C);var Y;G(C),i(J),i(l),te(()=>{W!==(W=e(u))&&(_.value=(_.__value=e(u))??"",S(_,e(u))),K!==(K=e(h))&&(g.value=(g.__value=e(h))??"",S(g,e(h))),Y!==(Y=e(m))&&(C.value=(C.__value=e(m))??"",S(C,e(m)))}),Ee(Z,()=>e(R),F=>p(R,F)),z(f,l)};Ae(c,f=>{!r.randomMode&&!j.url.searchParams.get("unitId")&&f(s)})}z(t,a)},$$slots:{default:!0}}),Me()}Ie(["change"]);export{Qe as component};
