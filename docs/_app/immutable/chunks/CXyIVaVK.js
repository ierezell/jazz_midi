import{E as ve,D as w,F as oe,k as W,G as de,H as be,I as Ae,J as Z,K as $,L as V,M as g,N as he,O as De,P as U,Q as me,R as Ee,S as z,T as ee,U as Ce,V as y,W as ae,X as Ge,Y as H,Z as re,_ as Fe,a0 as O,a1 as _e,a2 as Y,a3 as ne,a4 as Be,a5 as Ne,a6 as pe,a7 as Ie,a8 as we,a9 as Se,aa as se,ab as Te,ac as ge}from"./D5zBHTIm.js";function Le(e,r){return r}function xe(e,r,a){for(var s=e.items,f=[],l=r.length,t=0;t<l;t++)Ne(r[t].e,f,!0);var A=l>0&&f.length===0&&a!==null;if(A){var d=a.parentNode;pe(d),d.append(a),s.clear(),N(e,r[0].prev,r[l-1].next)}Ie(f,()=>{for(var m=0;m<l;m++){var b=r[m];A||(s.delete(b.k),N(e,b.prev,b.next)),ne(b.e,!A)}})}function qe(e,r,a,s,f,l=null){var t=e,A={flags:r,items:new Map,first:null},d=(r&se)!==0;if(d){var m=e;t=w?$(Se(m)):m.appendChild(ee())}w&&oe();var b=null,C=!1,F=new Map,v=de(()=>{var h=a();return Ge(h)?h:h==null?[]:ae(h)}),i,o;function c(){Re(o,i,A,F,t,f,r,s,a),l!==null&&(i.length===0?b?re(b):b=U(()=>l(t)):b!==null&&Fe(b,()=>{b=null}))}ve(()=>{o??(o=we),i=W(v);var h=i.length;if(C&&h===0)return;C=h===0;let G=!1;if(w){var _=be(t)===Ae;_!==(h===0)&&(t=Z(),$(t),V(!1),G=!0)}if(w){for(var p=null,D,n=0;n<h;n++){if(g.nodeType===he&&g.data===De){t=g,G=!0,V(!1);break}var u=i[n],E=s(u,n);D=X(g,A,p,null,u,E,n,f,r,a),A.items.set(E,D),p=D}h>0&&$(Z())}if(w)h===0&&l&&(b=U(()=>l(t)));else if(me()){var S=new Set,x=Ee;for(n=0;n<h;n+=1){u=i[n],E=s(u,n);var I=A.items.get(E)??F.get(E);I?(r&(O|H))!==0&&te(I,u,n,r):(D=X(null,A,null,null,u,E,n,f,r,a,!0),F.set(E,D)),S.add(E)}for(const[B,R]of A.items)S.has(B)||x.skipped_effects.add(R.e);x.add_callback(c)}else c();G&&V(!0),W(v)}),w&&(t=g)}function Re(e,r,a,s,f,l,t,A,d){var j,J,K,M;var m=(t&ge)!==0,b=(t&(O|H))!==0,C=r.length,F=a.items,v=a.first,i=v,o,c=null,h,G=[],_=[],p,D,n,u;if(m)for(u=0;u<C;u+=1)p=r[u],D=A(p,u),n=F.get(D),n!==void 0&&((j=n.a)==null||j.measure(),(h??(h=new Set)).add(n));for(u=0;u<C;u+=1){if(p=r[u],D=A(p,u),n=F.get(D),n===void 0){var E=s.get(D);if(E!==void 0){s.delete(D),F.set(D,E);var S=c?c.next:i;N(a,c,E),N(a,E,S),P(E,S,f),c=E}else{var x=i?i.e.nodes_start:f;c=X(x,a,c,c===null?a.first:c.next,p,D,u,l,t,d)}F.set(D,c),G=[],_=[],i=c.next;continue}if(b&&te(n,p,u,t),(n.e.f&Y)!==0&&(re(n.e),m&&((J=n.a)==null||J.unfix(),(h??(h=new Set)).delete(n))),n!==i){if(o!==void 0&&o.has(n)){if(G.length<_.length){var I=_[0],B;c=I.prev;var R=G[0],L=G[G.length-1];for(B=0;B<G.length;B+=1)P(G[B],I,f);for(B=0;B<_.length;B+=1)o.delete(_[B]);N(a,R.prev,L.next),N(a,c,R),N(a,L,I),i=I,c=L,u-=1,G=[],_=[]}else o.delete(n),P(n,i,f),N(a,n.prev,n.next),N(a,n,c===null?a.first:c.next),N(a,c,n),c=n;continue}for(G=[],_=[];i!==null&&i.k!==D;)(i.e.f&Y)===0&&(o??(o=new Set)).add(i),_.push(i),i=i.next;if(i===null)continue;n=i}G.push(n),c=n,i=n.next}if(i!==null||o!==void 0){for(var T=o===void 0?[]:ae(o);i!==null;)(i.e.f&Y)===0&&T.push(i),i=i.next;var q=T.length;if(q>0){var ue=(t&se)!==0&&C===0?f:null;if(m){for(u=0;u<q;u+=1)(K=T[u].a)==null||K.measure();for(u=0;u<q;u+=1)(M=T[u].a)==null||M.fix()}xe(a,T,ue)}}m&&Te(()=>{var Q;if(h!==void 0)for(n of h)(Q=n.a)==null||Q.apply()}),e.first=a.first&&a.first.e,e.last=c&&c.e;for(var ce of s.values())ne(ce.e);s.clear()}function te(e,r,a,s){(s&O)!==0&&z(e.v,r),(s&H)!==0?z(e.i,a):e.i=a}function X(e,r,a,s,f,l,t,A,d,m,b){var C=(d&O)!==0,F=(d&_e)===0,v=C?F?Ce(f,!1,!1):y(f):f,i=(d&H)===0?t:y(t),o={i,v,k:l,a:null,e:null,prev:a,next:s};try{if(e===null){var c=document.createDocumentFragment();c.append(e=ee())}return o.e=U(()=>A(e,v,i,m),w),o.e.prev=a&&a.e,o.e.next=s&&s.e,a===null?b||(r.first=o):(a.next=o,a.e.next=o.e),s!==null&&(s.prev=o,s.e.prev=o.e),o}finally{}}function P(e,r,a){for(var s=e.next?e.next.e.nodes_start:a,f=r?r.e.nodes_start:a,l=e.e.nodes_start;l!==null&&l!==s;){var t=Be(l);f.before(l),l=t}}function N(e,r,a){r===null?e.first=a:(r.next=a,r.e.next=a&&a.e),a!==null&&(a.prev=r,a.e.prev=r&&r.e)}const k={24:"C0",25:"C#0",26:"D0",27:"D#0",28:"E0",29:"F0",30:"F#0",31:"G0",32:"G#0",33:"A0",34:"A#0",35:"B0",36:"C1",37:"C#1",38:"D1",39:"D#1",40:"E1",41:"F1",42:"F#1",43:"G1",44:"G#1",45:"A1",46:"A#1",47:"B1",48:"C2",49:"C#2",50:"D2",51:"D#2",52:"E2",53:"F2",54:"F#2",55:"G2",56:"G#2",57:"A2",58:"A#2",59:"B2",60:"C3",61:"C#3",62:"D3",63:"D#3",64:"E3",65:"F3",66:"F#3",67:"G3",68:"G#3",69:"A3",70:"A#3",71:"B3",72:"C4",73:"C#4",74:"D4",75:"D#4",76:"E4",77:"F4",78:"F#4",79:"G4",80:"G#4",81:"A4",82:"A#4",83:"B4",84:"C5",85:"C#5",86:"D5",87:"D#5",88:"E5",89:"F5",90:"F#5",91:"G5",92:"G#5",93:"A5",94:"A#5",95:"B5",96:"C6",97:"C#6",98:"D6",99:"D#6",100:"E6",101:"F6",102:"F#6",103:"G6",104:"G#6",105:"A6",106:"A#6",107:"B6",108:"C7",109:"C#7",110:"D7",111:"D#7",112:"E7",113:"F7",114:"F#7",115:"G7",116:"G#7",117:"A7",118:"A#7",119:"B7",120:"C8",121:"C#8",122:"D8",123:"D#8",124:"E8",125:"F8",126:"F#8",127:"G8",128:"G#8"},ie={C0:24,"C#0":25,Db0:25,D0:26,"D#0":27,Eb0:27,E0:28,F0:29,"F#0":30,Gb0:30,G0:31,"G#0":32,Ab0:32,A0:33,"A#0":34,Bb0:34,B0:35,C1:36,"C#1":37,Db1:37,D1:38,"D#1":39,Eb1:39,E1:40,F1:41,"F#1":42,Gb1:42,G1:43,"G#1":44,Ab1:44,A1:45,"A#1":46,Bb1:46,B1:47,C2:48,"C#2":49,Db2:49,D2:50,"D#2":51,Eb2:51,E2:52,F2:53,"F#2":54,Gb2:54,G2:55,"G#2":56,Ab2:56,A2:57,"A#2":58,Bb2:58,B2:59,C3:60,"C#3":61,Db3:61,D3:62,"D#3":63,Eb3:63,E3:64,F3:65,"F#3":66,Gb3:66,G3:67,"G#3":68,Ab3:68,A3:69,"A#3":70,Bb3:70,B3:71,C4:72,"C#4":73,Db4:73,D4:74,"D#4":75,Eb4:75,E4:76,F4:77,"F#4":78,Gb4:78,G4:79,"G#4":80,Ab4:80,A4:81,"A#4":82,Bb4:82,B4:83,C5:84,"C#5":85,Db5:85,D5:86,"D#5":87,Eb5:87,E5:88,F5:89,"F#5":90,Gb5:90,G5:91,"G#5":92,Ab5:92,A5:93,"A#5":94,Bb5:94,B5:95,C6:96,"C#6":97,Db6:97,D6:98,"D#6":99,Eb6:99,E6:100,F6:101,"F#6":102,Gb6:102,G6:103,"G#6":104,Ab6:104,A6:105,"A#6":106,Bb6:106,B6:107,C7:108,"C#7":109,Db7:109,D7:110,"D#7":111,Eb7:111,E7:112,F7:113,"F#7":114,Gb7:114,G7:115,"G#7":116,Ab7:116,A7:117,"A#7":118,Bb7:118,B7:119,C8:120,"C#8":121,Db8:121,D8:122,"D#8":123,Eb8:123,E8:124,F8:125,"F#8":126,Gb8:126,G8:127,"G#8":128},fe=["C","C#","Db","D","D#","Eb","E","F","F#","Gb","G","G#","Ab","A","A#","Bb","B"],$e=["major","minor","maj7","min7","7","diminished","augmented","sus2","sus4"];function le(e,r){if(e<24||e>127)throw new Error("Midi note out of range (24-127)");let a=[e],s=e,f=Array(10).fill(r).flat();for(const t of f){if(s=s+t,s>127)break;a.push(s)}return a.map(t=>k[t])}const ke=(e,r,a)=>{switch(r){case 0:return{root:e[0],third:e[1],fifth:e[2],inversion:0,chordType:a};case 1:return{root:e[1],third:e[2],fifth:e[0]+12,inversion:1,chordType:a};case 2:return{root:e[2]-12,third:e[0],fifth:e[1],inversion:2,chordType:a}}},He=(e,r,a)=>{switch(r){case 0:return{root:e[0],third:e[1],fifth:e[2],seventh:e[3],inversion:0,chordType:a};case 1:return{root:e[1],third:e[2],fifth:e[3],seventh:e[0]+12,inversion:1,chordType:a};case 2:return{root:e[2]-12,third:e[3]-12,fifth:e[0],seventh:e[1],inversion:2,chordType:a};case 3:return{root:e[3]-12,third:e[0],fifth:e[1],seventh:e[2],inversion:3,chordType:a}}},Ve=(e,r,a=0)=>{const s=e+2,f=e+3,l=e+4,t=e+5,A=e+6,d=e+7,m=e+8,b=e+9,C=e+10,F=e+11;let v=[];switch(r){case"major":v=[e,l,d];break;case"minor":v=[e,f,d];break;case"maj7":v=[e,l,d,F];break;case"min7":v=[e,f,d,C];break;case"7":v=[e,l,d,C];break;case"diminished":v=[e,f,A,b];break;case"augmented":v=[e,l,m,C];break;case"sus2":v=[e,s,d,C];break;case"sus4":v=[e,t,d,C];break;default:v=[e]}return v.length===3?ke(v,a,r):He(v,a,r)},Ye=fe.reduce((e,r)=>(e[r]=le(ie[r+"0"],[2,2,1,2,2,2,1]),e),{});fe.reduce((e,r)=>(e[r]=le(ie[r+"0"],[2,1,2,2,1,2,1]),e),{});function Pe(e){const r=e.data,a=r[0]>>4;r[0]&15;const s=r[1],f=r[2];let l;if(a===9&&f>0)l="on";else if(a===8||a===9&&f===0)l="off";else return console.log(`Non-note MIDI message: [${Array.from(r).join(", ")}] (command: ${a})`),null;if(s<24||s>128)return console.warn(`MIDI note ${s} is outside supported range (24-128)`),null;const t=s;return k[t]?{noteNumber:t,noteFullName:k[t],noteName:k[t].slice(0,-1),velocity:f,time:e.timeStamp,type:l}:(console.warn(`No note mapping found for MIDI note ${s}`),null)}async function Ue(){let e=await navigator.requestMIDIAccess({sysex:!1});return console.log("MIDI Access obtained."),e}export{fe as A,k as M,ie as N,Ue as R,$e as a,Ve as c,qe as e,Pe as g,Le as i,Ye as m};
